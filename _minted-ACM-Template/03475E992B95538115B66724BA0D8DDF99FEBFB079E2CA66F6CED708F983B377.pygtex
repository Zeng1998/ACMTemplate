\begin{Verbatim}[commandchars=\\\{\}]
\PYG{c+cp}{\PYGZsh{}include} \PYG{c+cpf}{\PYGZlt{}bits/stdc++.h\PYGZgt{}}
\PYG{k}{using} \PYG{k}{namespace} \PYG{n}{std}\PYG{p}{;}
\PYG{k}{typedef} \PYG{k+kt}{long} \PYG{k+kt}{long} \PYG{k+kt}{int} \PYG{n}{LL} \PYG{p}{;}
\PYG{k}{const} \PYG{k+kt}{int} \PYG{n}{N} \PYG{o}{=} \PYG{l+m+mi}{100000}\PYG{o}{+}\PYG{l+m+mi}{7}\PYG{p}{;}
\PYG{c+cp}{\PYGZsh{}define abs(x)  (((x)\PYGZgt{}0)?(x):\PYGZhy{}(x))}
\PYG{c+cm}{/***************************************/}
\PYG{k}{const} \PYG{k+kt}{double} \PYG{n}{PI}  \PYG{o}{=} \PYG{n}{acos}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.0}\PYG{p}{);}
\PYG{k}{const} \PYG{k+kt}{double} \PYG{n}{eps} \PYG{o}{=} \PYG{l+m+mf}{1e\PYGZhy{}8}\PYG{p}{;}
\PYG{k}{const} \PYG{k+kt}{double} \PYG{n}{INF} \PYG{o}{=} \PYG{l+m+mf}{1e18}\PYG{p}{;}
\PYG{c+cp}{\PYGZsh{}define pb push\PYGZus{}back}
\PYG{c+cp}{\PYGZsh{}define mp make\PYGZus{}pair}
\PYG{c+c1}{///*************基础***********/}
\PYG{k+kt}{double} \PYG{n+nf}{torad}\PYG{p}{(}\PYG{k+kt}{double} \PYG{n}{deg}\PYG{p}{)} \PYG{p}{\PYGZob{}} \PYG{k}{return} \PYG{n}{deg} \PYG{o}{/} \PYG{l+m+mi}{180} \PYG{o}{*} \PYG{n}{PI}\PYG{p}{;} \PYG{p}{\PYGZcb{}}
\PYG{k+kr}{inline} \PYG{k+kt}{int} \PYG{n+nf}{dcmp}\PYG{p}{(}\PYG{k+kt}{double} \PYG{n}{x}\PYG{p}{)\PYGZob{}}
    \PYG{k}{if}\PYG{p}{(}\PYG{n}{fabs}\PYG{p}{(}\PYG{n}{x}\PYG{p}{)} \PYG{o}{\PYGZlt{}} \PYG{n}{eps}\PYG{p}{)} \PYG{k}{return} \PYG{l+m+mi}{0}\PYG{p}{;}
    \PYG{k}{else} \PYG{k}{return} \PYG{n}{x} \PYG{o}{\PYGZlt{}} \PYG{l+m+mi}{0} \PYG{o}{?} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1} \PYG{o}{:} \PYG{l+m+mi}{1}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{k}{struct} \PYG{n}{Point}\PYG{p}{\PYGZob{}}
    \PYG{k+kt}{double} \PYG{n}{x}\PYG{p}{,} \PYG{n}{y}\PYG{p}{;}
    \PYG{n}{Point}\PYG{p}{(}\PYG{k+kt}{double} \PYG{n}{x}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{k+kt}{double} \PYG{n}{y}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{)}\PYG{o}{:}\PYG{n}{x}\PYG{p}{(}\PYG{n}{x}\PYG{p}{),}\PYG{n}{y}\PYG{p}{(}\PYG{n}{y}\PYG{p}{)} \PYG{p}{\PYGZob{}} \PYG{p}{\PYGZcb{}}
    \PYG{k+kr}{inline} \PYG{k+kt}{void} \PYG{n}{read}\PYG{p}{()\PYGZob{}}
        \PYG{n}{scanf}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}\PYGZpc{}lf\PYGZpc{}lf\PYGZdq{}}\PYG{p}{,} \PYG{o}{\PYGZam{}}\PYG{n}{x}\PYG{p}{,} \PYG{o}{\PYGZam{}}\PYG{n}{y}\PYG{p}{);}
    \PYG{p}{\PYGZcb{}}
\PYG{p}{\PYGZcb{};}
\PYG{k}{typedef} \PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{Point}\PYG{o}{\PYGZgt{}} \PYG{n}{Polygon}\PYG{p}{;}
\PYG{k}{typedef} \PYG{n}{Point} \PYG{n}{Vector}\PYG{p}{;}
\PYG{k+kr}{inline} \PYG{n}{Vector} \PYG{k}{operator}\PYG{o}{+} \PYG{p}{(}\PYG{n}{Vector} \PYG{n}{A}\PYG{p}{,} \PYG{n}{Vector} \PYG{n}{B}\PYG{p}{)} \PYG{p}{\PYGZob{}} \PYG{k}{return} \PYG{n}{Vector}\PYG{p}{(}\PYG{n}{A}\PYG{p}{.}\PYG{n}{x} \PYG{o}{+} \PYG{n}{B}\PYG{p}{.}\PYG{n}{x}\PYG{p}{,} \PYG{n}{A}\PYG{p}{.}\PYG{n}{y} \PYG{o}{+} \PYG{n}{B}\PYG{p}{.}\PYG{n}{y}\PYG{p}{);} \PYG{p}{\PYGZcb{}}
\PYG{k+kr}{inline} \PYG{n}{Vector} \PYG{k}{operator}\PYG{o}{\PYGZhy{}} \PYG{p}{(}\PYG{n}{Point} \PYG{n}{A}\PYG{p}{,} \PYG{n}{Point} \PYG{n}{B}\PYG{p}{)} \PYG{p}{\PYGZob{}} \PYG{k}{return} \PYG{n}{Vector}\PYG{p}{(}\PYG{n}{A}\PYG{p}{.}\PYG{n}{x} \PYG{o}{\PYGZhy{}} \PYG{n}{B}\PYG{p}{.}\PYG{n}{x}\PYG{p}{,} \PYG{n}{A}\PYG{p}{.}\PYG{n}{y} \PYG{o}{\PYGZhy{}} \PYG{n}{B}\PYG{p}{.}\PYG{n}{y}\PYG{p}{);} \PYG{p}{\PYGZcb{}}
\PYG{k+kr}{inline} \PYG{n}{Vector} \PYG{k}{operator}\PYG{o}{*} \PYG{p}{(}\PYG{n}{Vector} \PYG{n}{A}\PYG{p}{,} \PYG{k+kt}{double} \PYG{n}{p}\PYG{p}{)} \PYG{p}{\PYGZob{}} \PYG{k}{return} \PYG{n}{Vector}\PYG{p}{(}\PYG{n}{A}\PYG{p}{.}\PYG{n}{x} \PYG{o}{*} \PYG{n}{p}\PYG{p}{,} \PYG{n}{A}\PYG{p}{.}\PYG{n}{y} \PYG{o}{*} \PYG{n}{p}\PYG{p}{);} \PYG{p}{\PYGZcb{}}
\PYG{k+kr}{inline} \PYG{n}{Vector} \PYG{k}{operator}\PYG{o}{/} \PYG{p}{(}\PYG{n}{Vector} \PYG{n}{A}\PYG{p}{,} \PYG{k+kt}{double} \PYG{n}{p}\PYG{p}{)} \PYG{p}{\PYGZob{}} \PYG{k}{return} \PYG{n}{Vector}\PYG{p}{(}\PYG{n}{A}\PYG{p}{.}\PYG{n}{x} \PYG{o}{/} \PYG{n}{p}\PYG{p}{,} \PYG{n}{A}\PYG{p}{.}\PYG{n}{y} \PYG{o}{/} \PYG{n}{p}\PYG{p}{);} \PYG{p}{\PYGZcb{}}
\PYG{k+kr}{inline} \PYG{k+kt}{bool} \PYG{k}{operator} \PYG{o}{\PYGZlt{}} \PYG{p}{(}\PYG{n}{Point} \PYG{n}{a}\PYG{p}{,} \PYG{n}{Point} \PYG{n}{b}\PYG{p}{)} \PYG{p}{\PYGZob{}} \PYG{k}{return} \PYG{n}{a}\PYG{p}{.}\PYG{n}{x} \PYG{o}{\PYGZlt{}} \PYG{n}{b}\PYG{p}{.}\PYG{n}{x} \PYG{o}{||} \PYG{p}{(}\PYG{n}{a}\PYG{p}{.}\PYG{n}{x} \PYG{o}{==} \PYG{n}{b}\PYG{p}{.}\PYG{n}{x} \PYG{o}{\PYGZam{}\PYGZam{}} \PYG{n}{a}\PYG{p}{.}\PYG{n}{y} \PYG{o}{\PYGZlt{}} \PYG{n}{b}\PYG{p}{.}\PYG{n}{y}\PYG{p}{);} \PYG{p}{\PYGZcb{}}
\PYG{k+kr}{inline} \PYG{k+kt}{bool} \PYG{k}{operator} \PYG{o}{==} \PYG{p}{(}\PYG{n}{Point} \PYG{n}{a}\PYG{p}{,} \PYG{n}{Point} \PYG{n}{b}\PYG{p}{)} \PYG{p}{\PYGZob{}} \PYG{k}{return} \PYG{n}{dcmp}\PYG{p}{(}\PYG{n}{a}\PYG{p}{.}\PYG{n}{x} \PYG{o}{\PYGZhy{}} \PYG{n}{b}\PYG{p}{.}\PYG{n}{x}\PYG{p}{)} \PYG{o}{==} \PYG{l+m+mi}{0} \PYG{o}{\PYGZam{}\PYGZam{}} \PYG{n}{dcmp}\PYG{p}{(}\PYG{n}{a}\PYG{p}{.}\PYG{n}{y} \PYG{o}{\PYGZhy{}} \PYG{n}{b}\PYG{p}{.}\PYG{n}{y}\PYG{p}{)} \PYG{o}{==} \PYG{l+m+mi}{0}\PYG{p}{;} \PYG{p}{\PYGZcb{}}
\PYG{k+kr}{inline} \PYG{k+kt}{double} \PYG{n}{Dot}\PYG{p}{(}\PYG{n}{Vector} \PYG{n}{A}\PYG{p}{,} \PYG{n}{Vector} \PYG{n}{B}\PYG{p}{)\PYGZob{}} \PYG{k}{return} \PYG{n}{A}\PYG{p}{.}\PYG{n}{x} \PYG{o}{*} \PYG{n}{B}\PYG{p}{.}\PYG{n}{x} \PYG{o}{+} \PYG{n}{A}\PYG{p}{.}\PYG{n}{y} \PYG{o}{*} \PYG{n}{B}\PYG{p}{.}\PYG{n}{y}\PYG{p}{;\PYGZcb{}}
\PYG{k+kr}{inline} \PYG{k+kt}{double} \PYG{n}{Length}\PYG{p}{(}\PYG{n}{Vector} \PYG{n}{A}\PYG{p}{)} \PYG{p}{\PYGZob{}} \PYG{k}{return} \PYG{n}{sqrt}\PYG{p}{(}\PYG{n}{Dot}\PYG{p}{(}\PYG{n}{A}\PYG{p}{,} \PYG{n}{A}\PYG{p}{));} \PYG{p}{\PYGZcb{}}
\PYG{k+kr}{inline} \PYG{k+kt}{double} \PYG{n}{Angle}\PYG{p}{(}\PYG{n}{Vector} \PYG{n}{A}\PYG{p}{,} \PYG{n}{Vector} \PYG{n}{B}\PYG{p}{)} \PYG{p}{\PYGZob{}} \PYG{k}{return} \PYG{n}{acos}\PYG{p}{(}\PYG{n}{Dot}\PYG{p}{(}\PYG{n}{A}\PYG{p}{,} \PYG{n}{B}\PYG{p}{)} \PYG{o}{/} \PYG{n}{Length}\PYG{p}{(}\PYG{n}{A}\PYG{p}{)} \PYG{o}{/} \PYG{n}{Length}\PYG{p}{(}\PYG{n}{B}\PYG{p}{));} \PYG{p}{\PYGZcb{}}
\PYG{k+kr}{inline} \PYG{k+kt}{double} \PYG{n}{angle}\PYG{p}{(}\PYG{n}{Vector} \PYG{n}{v}\PYG{p}{)} \PYG{p}{\PYGZob{}} \PYG{k}{return} \PYG{n}{atan2}\PYG{p}{(}\PYG{n}{v}\PYG{p}{.}\PYG{n}{y}\PYG{p}{,} \PYG{n}{v}\PYG{p}{.}\PYG{n}{x}\PYG{p}{);} \PYG{p}{\PYGZcb{}}
\PYG{k+kr}{inline} \PYG{k+kt}{double} \PYG{n}{Cross}\PYG{p}{(}\PYG{n}{Vector} \PYG{n}{A}\PYG{p}{,} \PYG{n}{Vector} \PYG{n}{B}\PYG{p}{)} \PYG{p}{\PYGZob{}} \PYG{k}{return} \PYG{n}{A}\PYG{p}{.}\PYG{n}{x} \PYG{o}{*} \PYG{n}{B}\PYG{p}{.}\PYG{n}{y} \PYG{o}{\PYGZhy{}} \PYG{n}{A}\PYG{p}{.}\PYG{n}{y} \PYG{o}{*} \PYG{n}{B}\PYG{p}{.}\PYG{n}{x}\PYG{p}{;} \PYG{p}{\PYGZcb{}}
\PYG{k+kr}{inline} \PYG{n}{Vector} \PYG{n}{Unit}\PYG{p}{(}\PYG{n}{Vector} \PYG{n}{x}\PYG{p}{)} \PYG{p}{\PYGZob{}} \PYG{k}{return} \PYG{n}{x} \PYG{o}{/} \PYG{n}{Length}\PYG{p}{(}\PYG{n}{x}\PYG{p}{);} \PYG{p}{\PYGZcb{}}  \PYG{c+c1}{//单位向量}
\PYG{k+kr}{inline} \PYG{n}{Vector} \PYG{n}{Normal}\PYG{p}{(}\PYG{n}{Vector} \PYG{n}{x}\PYG{p}{)} \PYG{p}{\PYGZob{}} \PYG{k}{return} \PYG{n}{Point}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n}{x}\PYG{p}{.}\PYG{n}{y}\PYG{p}{,} \PYG{n}{x}\PYG{p}{.}\PYG{n}{x}\PYG{p}{)} \PYG{o}{/} \PYG{n}{Length}\PYG{p}{(}\PYG{n}{x}\PYG{p}{);} \PYG{p}{\PYGZcb{}} \PYG{c+c1}{//垂直法向量}
\PYG{k+kr}{inline} \PYG{k+kt}{double} \PYG{n}{Area2}\PYG{p}{(}\PYG{n}{Point} \PYG{n}{A}\PYG{p}{,} \PYG{n}{Point} \PYG{n}{B}\PYG{p}{,} \PYG{n}{Point} \PYG{n}{C}\PYG{p}{)} \PYG{p}{\PYGZob{}} \PYG{k}{return} \PYG{n}{Cross}\PYG{p}{(}\PYG{n}{B} \PYG{o}{\PYGZhy{}} \PYG{n}{A}\PYG{p}{,} \PYG{n}{C} \PYG{o}{\PYGZhy{}} \PYG{n}{A}\PYG{p}{);} \PYG{p}{\PYGZcb{}}
\PYG{k+kr}{inline} \PYG{n}{Vector} \PYG{n}{Rotate}\PYG{p}{(}\PYG{n}{Vector} \PYG{n}{A}\PYG{p}{,} \PYG{k+kt}{double} \PYG{n}{rad}\PYG{p}{)\PYGZob{}}
    \PYG{k}{return} \PYG{n}{Vector}\PYG{p}{(}\PYG{n}{A}\PYG{p}{.}\PYG{n}{x} \PYG{o}{*} \PYG{n}{cos}\PYG{p}{(}\PYG{n}{rad}\PYG{p}{)} \PYG{o}{\PYGZhy{}} \PYG{n}{A}\PYG{p}{.}\PYG{n}{y}\PYG{o}{*}\PYG{n}{sin}\PYG{p}{(}\PYG{n}{rad}\PYG{p}{),} \PYG{n}{A}\PYG{p}{.}\PYG{n}{x}\PYG{o}{*}\PYG{n}{sin}\PYG{p}{(}\PYG{n}{rad}\PYG{p}{)} \PYG{o}{+} \PYG{n}{A}\PYG{p}{.}\PYG{n}{y} \PYG{o}{*} \PYG{n}{cos}\PYG{p}{(}\PYG{n}{rad}\PYG{p}{));}
\PYG{p}{\PYGZcb{}}
\PYG{c+cm}{/****************直线与线段**************/}
\PYG{c+c1}{//求直线p+tv和q+tw的交点 Cross(v, w) == 0无交点}
\PYG{n}{Point} \PYG{n}{GetLineIntersection}\PYG{p}{(}\PYG{n}{Point} \PYG{n}{p}\PYG{p}{,} \PYG{n}{Vector} \PYG{n}{v}\PYG{p}{,} \PYG{n}{Point} \PYG{n}{q}\PYG{p}{,} \PYG{n}{Vector} \PYG{n}{w}\PYG{p}{)\PYGZob{}}
    \PYG{n}{Vector} \PYG{n}{u} \PYG{o}{=} \PYG{n}{p} \PYG{o}{\PYGZhy{}} \PYG{n}{q}\PYG{p}{;}
    \PYG{k+kt}{double} \PYG{n}{t} \PYG{o}{=} \PYG{n}{Cross}\PYG{p}{(}\PYG{n}{w}\PYG{p}{,} \PYG{n}{u}\PYG{p}{)} \PYG{o}{/} \PYG{n}{Cross}\PYG{p}{(}\PYG{n}{v}\PYG{p}{,} \PYG{n}{w}\PYG{p}{);}
    \PYG{k}{return} \PYG{n}{p} \PYG{o}{+} \PYG{n}{v} \PYG{o}{*} \PYG{n}{t}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{c+c1}{//点p在直线ab的投影}
\PYG{k+kr}{inline} \PYG{n}{Point} \PYG{n}{GetLineProjection}\PYG{p}{(}\PYG{n}{Point} \PYG{n}{P}\PYG{p}{,} \PYG{n}{Point} \PYG{n}{A}\PYG{p}{,} \PYG{n}{Point} \PYG{n}{B}\PYG{p}{)\PYGZob{}}
    \PYG{n}{Vector} \PYG{n}{v} \PYG{o}{=} \PYG{n}{B} \PYG{o}{\PYGZhy{}} \PYG{n}{A}\PYG{p}{;}
    \PYG{k}{return} \PYG{n}{A} \PYG{o}{+} \PYG{n}{v} \PYG{o}{*} \PYG{p}{(}\PYG{n}{Dot}\PYG{p}{(}\PYG{n}{v}\PYG{p}{,} \PYG{n}{P} \PYG{o}{\PYGZhy{}} \PYG{n}{A}\PYG{p}{)} \PYG{o}{/} \PYG{n}{Dot}\PYG{p}{(}\PYG{n}{v}\PYG{p}{,} \PYG{n}{v}\PYG{p}{));}
\PYG{p}{\PYGZcb{}}
\PYG{c+c1}{//点到直线距离}
\PYG{k+kr}{inline} \PYG{k+kt}{double} \PYG{n}{DistanceToLine}\PYG{p}{(}\PYG{n}{Point} \PYG{n}{P}\PYG{p}{,} \PYG{n}{Point} \PYG{n}{A}\PYG{p}{,} \PYG{n}{Point} \PYG{n}{B}\PYG{p}{)\PYGZob{}}
    \PYG{n}{Vector} \PYG{n}{v1} \PYG{o}{=} \PYG{n}{B} \PYG{o}{\PYGZhy{}} \PYG{n}{A}\PYG{p}{,} \PYG{n}{v2} \PYG{o}{=} \PYG{n}{P} \PYG{o}{\PYGZhy{}} \PYG{n}{A}\PYG{p}{;}
    \PYG{k}{return} \PYG{n+nf}{fabs}\PYG{p}{(}\PYG{n}{Cross}\PYG{p}{(}\PYG{n}{v1}\PYG{p}{,} \PYG{n}{v2}\PYG{p}{))} \PYG{o}{/} \PYG{n}{Length}\PYG{p}{(}\PYG{n}{v1}\PYG{p}{);} \PYG{c+c1}{// 如果不取绝对值，得到的是有向距离}
\PYG{p}{\PYGZcb{}}
\PYG{c+c1}{//点在p线段上(包括端点)}
\PYG{k+kr}{inline} \PYG{k+kt}{bool} \PYG{n}{OnSegment}\PYG{p}{(}\PYG{n}{Point} \PYG{n}{p}\PYG{p}{,} \PYG{n}{Point} \PYG{n}{a1}\PYG{p}{,} \PYG{n}{Point} \PYG{n}{a2}\PYG{p}{)\PYGZob{}}
    \PYG{k}{return} \PYG{n}{dcmp}\PYG{p}{(}\PYG{n}{Cross}\PYG{p}{(}\PYG{n}{a1}\PYG{o}{\PYGZhy{}}\PYG{n}{p}\PYG{p}{,} \PYG{n}{a2}\PYG{o}{\PYGZhy{}}\PYG{n}{p}\PYG{p}{))} \PYG{o}{==} \PYG{l+m+mi}{0} \PYG{o}{\PYGZam{}\PYGZam{}} \PYG{n}{dcmp}\PYG{p}{(}\PYG{n}{Dot}\PYG{p}{(}\PYG{n}{a1}\PYG{o}{\PYGZhy{}}\PYG{n}{p}\PYG{p}{,} \PYG{n}{a2}\PYG{o}{\PYGZhy{}}\PYG{n}{p}\PYG{p}{))} \PYG{o}{\PYGZlt{}=} \PYG{l+m+mi}{0}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{c+c1}{// 过两点p1, p2的直线一般方程ax+by+c=0}
\PYG{c+c1}{// (x2\PYGZhy{}x1)(y\PYGZhy{}y1) = (y2\PYGZhy{}y1)(x\PYGZhy{}x1)}
\PYG{k+kr}{inline} \PYG{k+kt}{void} \PYG{n}{getLineGeneralEquation}\PYG{p}{(}\PYG{n}{Point} \PYG{n}{p1}\PYG{p}{,} \PYG{n}{Point} \PYG{n}{p2}\PYG{p}{,} \PYG{k+kt}{double}\PYG{o}{\PYGZam{}} \PYG{n}{a}\PYG{p}{,} \PYG{k+kt}{double}\PYG{o}{\PYGZam{}} \PYG{n}{b}\PYG{p}{,} \PYG{k+kt}{double} \PYG{o}{\PYGZam{}}\PYG{n}{c}\PYG{p}{)\PYGZob{}}
    \PYG{n}{a} \PYG{o}{=} \PYG{n}{p2}\PYG{p}{.}\PYG{n}{y} \PYG{o}{\PYGZhy{}} \PYG{n}{p1}\PYG{p}{.}\PYG{n}{y}\PYG{p}{;}
    \PYG{n}{b} \PYG{o}{=} \PYG{n}{p1}\PYG{p}{.}\PYG{n}{x} \PYG{o}{\PYGZhy{}} \PYG{n}{p2}\PYG{p}{.}\PYG{n}{x}\PYG{p}{;}
    \PYG{n}{c} \PYG{o}{=} \PYG{o}{\PYGZhy{}}\PYG{n}{a} \PYG{o}{*} \PYG{n}{p1}\PYG{p}{.}\PYG{n}{x} \PYG{o}{\PYGZhy{}} \PYG{n}{b} \PYG{o}{*} \PYG{n}{p1}\PYG{p}{.}\PYG{n}{y}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{c+c1}{//点到线段距离}
\PYG{k+kt}{double} \PYG{n}{DistanceToSegment}\PYG{p}{(}\PYG{n}{Point} \PYG{n}{p}\PYG{p}{,} \PYG{n}{Point} \PYG{n}{a}\PYG{p}{,} \PYG{n}{Point} \PYG{n}{b}\PYG{p}{)\PYGZob{}}
    \PYG{k}{if}\PYG{p}{(}\PYG{n}{a} \PYG{o}{==} \PYG{n}{b}\PYG{p}{)} \PYG{k}{return} \PYG{n}{Length}\PYG{p}{(}\PYG{n}{p} \PYG{o}{\PYGZhy{}} \PYG{n}{a}\PYG{p}{);}
    \PYG{n}{Vector} \PYG{n}{v1} \PYG{o}{=} \PYG{n}{b} \PYG{o}{\PYGZhy{}} \PYG{n}{a}\PYG{p}{,} \PYG{n}{v2} \PYG{o}{=} \PYG{n}{p} \PYG{o}{\PYGZhy{}} \PYG{n}{a}\PYG{p}{,} \PYG{n}{v3} \PYG{o}{=} \PYG{n}{p} \PYG{o}{\PYGZhy{}} \PYG{n}{b}\PYG{p}{;}
    \PYG{k}{if}\PYG{p}{(}\PYG{n}{dcmp}\PYG{p}{(}\PYG{n}{Dot}\PYG{p}{(}\PYG{n}{v1}\PYG{p}{,} \PYG{n}{v2}\PYG{p}{))} \PYG{o}{\PYGZlt{}} \PYG{l+m+mi}{0}\PYG{p}{)} \PYG{k}{return} \PYG{n}{Length}\PYG{p}{(}\PYG{n}{v2}\PYG{p}{);}
    \PYG{k}{else} \PYG{n+nf}{if}\PYG{p}{(}\PYG{n}{dcmp}\PYG{p}{(}\PYG{n}{Dot}\PYG{p}{(}\PYG{n}{v1}\PYG{p}{,} \PYG{n}{v3}\PYG{p}{))} \PYG{o}{\PYGZgt{}} \PYG{l+m+mi}{0}\PYG{p}{)} \PYG{k}{return} \PYG{n}{Length}\PYG{p}{(}\PYG{n}{v3}\PYG{p}{);}
    \PYG{k}{else} \PYG{k}{return} \PYG{n+nf}{fabs}\PYG{p}{(}\PYG{n}{Cross}\PYG{p}{(}\PYG{n}{v1}\PYG{p}{,} \PYG{n}{v2}\PYG{p}{))} \PYG{o}{/} \PYG{n}{Length}\PYG{p}{(}\PYG{n}{v1}\PYG{p}{);}
\PYG{p}{\PYGZcb{}}
\PYG{c+c1}{//两线段最近距离}
\PYG{k+kr}{inline} \PYG{k+kt}{double} \PYG{n}{dis\PYGZus{}pair\PYGZus{}seg}\PYG{p}{(}\PYG{n}{Point} \PYG{n}{p1}\PYG{p}{,} \PYG{n}{Point} \PYG{n}{p2}\PYG{p}{,} \PYG{n}{Point} \PYG{n}{p3}\PYG{p}{,} \PYG{n}{Point} \PYG{n}{p4}\PYG{p}{)\PYGZob{}}
    \PYG{k}{return} \PYG{n}{min}\PYG{p}{(}\PYG{n}{min}\PYG{p}{(}\PYG{n}{DistanceToSegment}\PYG{p}{(}\PYG{n}{p1}\PYG{p}{,} \PYG{n}{p3}\PYG{p}{,} \PYG{n}{p4}\PYG{p}{),} \PYG{n}{DistanceToSegment}\PYG{p}{(}\PYG{n}{p2}\PYG{p}{,} \PYG{n}{p3}\PYG{p}{,} \PYG{n}{p4}\PYG{p}{)),}
               \PYG{n}{min}\PYG{p}{(}\PYG{n}{DistanceToSegment}\PYG{p}{(}\PYG{n}{p3}\PYG{p}{,} \PYG{n}{p1}\PYG{p}{,} \PYG{n}{p2}\PYG{p}{),} \PYG{n}{DistanceToSegment}\PYG{p}{(}\PYG{n}{p4}\PYG{p}{,} \PYG{n}{p1}\PYG{p}{,} \PYG{n}{p2}\PYG{p}{)));}
\PYG{p}{\PYGZcb{}}
\PYG{c+c1}{//线段相交判定}
\PYG{k+kr}{inline} \PYG{k+kt}{bool} \PYG{n}{SegmentProperIntersection}\PYG{p}{(}\PYG{n}{Point} \PYG{n}{a1}\PYG{p}{,} \PYG{n}{Point} \PYG{n}{a2}\PYG{p}{,} \PYG{n}{Point} \PYG{n}{b1}\PYG{p}{,} \PYG{n}{Point} \PYG{n}{b2}\PYG{p}{)\PYGZob{}}
    \PYG{k+kt}{double} \PYG{n}{c1} \PYG{o}{=} \PYG{n}{Cross}\PYG{p}{(}\PYG{n}{a2} \PYG{o}{\PYGZhy{}} \PYG{n}{a1}\PYG{p}{,} \PYG{n}{b1} \PYG{o}{\PYGZhy{}} \PYG{n}{a1}\PYG{p}{),} \PYG{n}{c2} \PYG{o}{=} \PYG{n}{Cross}\PYG{p}{(}\PYG{n}{a2} \PYG{o}{\PYGZhy{}} \PYG{n}{a1}\PYG{p}{,} \PYG{n}{b2} \PYG{o}{\PYGZhy{}} \PYG{n}{a1}\PYG{p}{),}
           \PYG{n}{c3} \PYG{o}{=} \PYG{n}{Cross}\PYG{p}{(}\PYG{n}{b2} \PYG{o}{\PYGZhy{}} \PYG{n}{b1}\PYG{p}{,} \PYG{n}{a1} \PYG{o}{\PYGZhy{}} \PYG{n}{b1}\PYG{p}{),} \PYG{n}{c4} \PYG{o}{=} \PYG{n}{Cross}\PYG{p}{(}\PYG{n}{b2} \PYG{o}{\PYGZhy{}} \PYG{n}{b1}\PYG{p}{,} \PYG{n}{a2} \PYG{o}{\PYGZhy{}} \PYG{n}{b1}\PYG{p}{);}
    \PYG{k}{return} \PYG{n+nf}{dcmp}\PYG{p}{(}\PYG{n}{c1}\PYG{p}{)} \PYG{o}{*} \PYG{n}{dcmp}\PYG{p}{(}\PYG{n}{c2}\PYG{p}{)} \PYG{o}{\PYGZlt{}} \PYG{l+m+mi}{0} \PYG{o}{\PYGZam{}\PYGZam{}} \PYG{n}{dcmp}\PYG{p}{(}\PYG{n}{c3}\PYG{p}{)} \PYG{o}{*} \PYG{n}{dcmp}\PYG{p}{(}\PYG{n}{c4}\PYG{p}{)} \PYG{o}{\PYGZlt{}} \PYG{l+m+mi}{0}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{c+c1}{// 有向直线。它的左边就是对应的半平面}
\PYG{k}{struct} \PYG{n}{Line}\PYG{p}{\PYGZob{}}
    \PYG{n}{Point} \PYG{n}{p}\PYG{p}{,} \PYG{n}{q}\PYG{p}{;}    \PYG{c+c1}{// 直线上任意一点,p作为起点}
    \PYG{n}{Vector} \PYG{n}{v}\PYG{p}{;}   \PYG{c+c1}{// 方向向量}
    \PYG{k+kt}{double} \PYG{n}{ang}\PYG{p}{;} \PYG{c+c1}{// 极角，即从x正半轴旋转到向量v所需要的角（弧度）}
    \PYG{n}{Line}\PYG{p}{()} \PYG{p}{\PYGZob{}\PYGZcb{}}
\PYG{c+c1}{//    Line(Point P, Vector v):p(P),v(v)}
\PYG{c+c1}{//    \PYGZob{}}
\PYG{c+c1}{//        ang = atan2(v.y, v.x);}
\PYG{c+c1}{//    \PYGZcb{}}
    \PYG{n}{Line}\PYG{p}{(}\PYG{n}{Point} \PYG{n}{P}\PYG{p}{,} \PYG{n}{Point} \PYG{n}{Q}\PYG{p}{)}\PYG{o}{:}\PYG{n}{p}\PYG{p}{(}\PYG{n}{P}\PYG{p}{),} \PYG{n}{q}\PYG{p}{(}\PYG{n}{Q}\PYG{p}{)\PYGZob{}}
        \PYG{n}{v} \PYG{o}{=} \PYG{n}{q} \PYG{o}{\PYGZhy{}} \PYG{n}{p}\PYG{p}{;}
        \PYG{n}{ang} \PYG{o}{=} \PYG{n}{atan2}\PYG{p}{(}\PYG{n}{v}\PYG{p}{.}\PYG{n}{y}\PYG{p}{,} \PYG{n}{v}\PYG{p}{.}\PYG{n}{x}\PYG{p}{);}
    \PYG{p}{\PYGZcb{}}
    \PYG{k+kr}{inline} \PYG{k+kt}{bool} \PYG{k}{operator} \PYG{o}{\PYGZlt{}} \PYG{p}{(}\PYG{k}{const} \PYG{n}{Line}\PYG{o}{\PYGZam{}} \PYG{n}{L}\PYG{p}{)} \PYG{k}{const}\PYG{p}{\PYGZob{}}
        \PYG{k}{return} \PYG{n}{ang} \PYG{o}{\PYGZlt{}} \PYG{n}{L}\PYG{p}{.}\PYG{n}{ang}\PYG{p}{;}
    \PYG{p}{\PYGZcb{}}
    \PYG{k+kr}{inline} \PYG{n}{Point} \PYG{n}{point}\PYG{p}{(}\PYG{k+kt}{double} \PYG{n}{t}\PYG{p}{)\PYGZob{}}
        \PYG{k}{return} \PYG{n}{p} \PYG{o}{+} \PYG{n}{v} \PYG{o}{*} \PYG{n}{t}\PYG{p}{;}
    \PYG{p}{\PYGZcb{}}
    \PYG{k+kr}{inline} \PYG{n}{Line} \PYG{n}{move}\PYG{p}{(}\PYG{k+kt}{double} \PYG{n}{d}\PYG{p}{)\PYGZob{}}
        \PYG{k}{return} \PYG{n}{Line}\PYG{p}{(}\PYG{n}{p} \PYG{o}{+} \PYG{n}{Normal}\PYG{p}{(}\PYG{n}{v}\PYG{p}{)} \PYG{o}{*} \PYG{n}{d}\PYG{p}{,} \PYG{n}{v}\PYG{p}{);}
    \PYG{p}{\PYGZcb{}}
    \PYG{k+kr}{inline} \PYG{k+kt}{void} \PYG{n}{read}\PYG{p}{()\PYGZob{}}
        \PYG{n}{Point} \PYG{n}{q}\PYG{p}{;}
        \PYG{n}{p}\PYG{p}{.}\PYG{n}{read}\PYG{p}{(),} \PYG{n}{q}\PYG{p}{.}\PYG{n}{read}\PYG{p}{();}
        \PYG{n}{v} \PYG{o}{=} \PYG{n}{q} \PYG{o}{\PYGZhy{}} \PYG{n}{p}\PYG{p}{;}
        \PYG{n}{ang} \PYG{o}{=} \PYG{n}{atan2}\PYG{p}{(}\PYG{n}{v}\PYG{p}{.}\PYG{n}{y}\PYG{p}{,} \PYG{n}{v}\PYG{p}{.}\PYG{n}{x}\PYG{p}{);}
    \PYG{p}{\PYGZcb{}}
\PYG{p}{\PYGZcb{};}
\PYG{c+c1}{//两直线交点}
\PYG{k+kr}{inline} \PYG{n}{Point} \PYG{n+nf}{GetLineIntersection}\PYG{p}{(}\PYG{n}{Line} \PYG{n}{a}\PYG{p}{,} \PYG{n}{Line} \PYG{n}{b}\PYG{p}{)\PYGZob{}}
    \PYG{k}{return} \PYG{n}{GetLineIntersection}\PYG{p}{(}\PYG{n}{a}\PYG{p}{.}\PYG{n}{p}\PYG{p}{,} \PYG{n}{a}\PYG{p}{.}\PYG{n}{v}\PYG{p}{,} \PYG{n}{b}\PYG{p}{.}\PYG{n}{p}\PYG{p}{,} \PYG{n}{b}\PYG{p}{.}\PYG{n}{v}\PYG{p}{);}
\PYG{p}{\PYGZcb{}}
\PYG{c+c1}{// 点p在有向直线L的左边（线上不算）}
\PYG{k+kr}{inline} \PYG{k+kt}{bool} \PYG{n+nf}{OnLeft}\PYG{p}{(}\PYG{k}{const} \PYG{n}{Line}\PYG{o}{\PYGZam{}} \PYG{n}{L}\PYG{p}{,} \PYG{k}{const} \PYG{n}{Point}\PYG{o}{\PYGZam{}} \PYG{n}{p}\PYG{p}{)\PYGZob{}}
    \PYG{k}{return} \PYG{n}{Cross}\PYG{p}{(}\PYG{n}{L}\PYG{p}{.}\PYG{n}{v}\PYG{p}{,} \PYG{n}{p} \PYG{o}{\PYGZhy{}} \PYG{n}{L}\PYG{p}{.}\PYG{n}{p}\PYG{p}{)} \PYG{o}{\PYGZgt{}} \PYG{l+m+mi}{0}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{c+c1}{//// 二直线交点，假定交点惟一存在}
\PYG{c+c1}{//Point GetLineIntersection(const Line\PYGZam{} a, const Line\PYGZam{} b) \PYGZob{}}
\PYG{c+c1}{//  Vector u = a.P\PYGZhy{}b.P;}
\PYG{c+c1}{//  double t = Cross(b.v, u) / Cross(a.v, b.v);}
\PYG{c+c1}{//  return a.P+a.v*t;}
\PYG{c+c1}{//\PYGZcb{}}
\PYG{c+c1}{// 半平面交主过程}
\PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{Point}\PYG{o}{\PYGZgt{}} \PYG{n}{HalfplaneIntersection}\PYG{p}{(}\PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{Line}\PYG{o}{\PYGZgt{}} \PYG{n}{L}\PYG{p}{)\PYGZob{}}
    \PYG{k+kt}{int} \PYG{n}{n} \PYG{o}{=} \PYG{n}{L}\PYG{p}{.}\PYG{n}{size}\PYG{p}{();}
    \PYG{n}{sort}\PYG{p}{(}\PYG{n}{L}\PYG{p}{.}\PYG{n}{begin}\PYG{p}{(),} \PYG{n}{L}\PYG{p}{.}\PYG{n}{end}\PYG{p}{());} \PYG{c+c1}{// 按极角排序}
    \PYG{k+kt}{int} \PYG{n}{first}\PYG{p}{,} \PYG{n}{last}\PYG{p}{;}         \PYG{c+c1}{// 双端队列的第一个元素和最后一个元素的下标}
    \PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{Point}\PYG{o}{\PYGZgt{}} \PYG{n}{p}\PYG{p}{(}\PYG{n}{n}\PYG{p}{);}      \PYG{c+c1}{// p[i]为q[i]和q[i+1]的交点}
    \PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{Line}\PYG{o}{\PYGZgt{}} \PYG{n}{q}\PYG{p}{(}\PYG{n}{n}\PYG{p}{);}       \PYG{c+c1}{// 双端队列}
    \PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{Point}\PYG{o}{\PYGZgt{}} \PYG{n}{ans}\PYG{p}{;}       \PYG{c+c1}{// 结果}
    \PYG{n}{q}\PYG{p}{[}\PYG{n}{first}\PYG{o}{=}\PYG{n}{last}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{]} \PYG{o}{=} \PYG{n}{L}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{];}  \PYG{c+c1}{// 双端队列初始化为只有一个半平面L[0]}
    \PYG{k}{for}\PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{i} \PYG{o}{=} \PYG{l+m+mi}{1}\PYG{p}{;} \PYG{n}{i} \PYG{o}{\PYGZlt{}} \PYG{n}{n}\PYG{p}{;} \PYG{n}{i}\PYG{o}{++}\PYG{p}{)\PYGZob{}}
        \PYG{k}{while}\PYG{p}{(}\PYG{n}{first} \PYG{o}{\PYGZlt{}} \PYG{n}{last} \PYG{o}{\PYGZam{}\PYGZam{}} \PYG{o}{!}\PYG{n}{OnLeft}\PYG{p}{(}\PYG{n}{L}\PYG{p}{[}\PYG{n}{i}\PYG{p}{],} \PYG{n}{p}\PYG{p}{[}\PYG{n}{last}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{]))} \PYG{n}{last}\PYG{o}{\PYGZhy{}\PYGZhy{}}\PYG{p}{;}
        \PYG{k}{while}\PYG{p}{(}\PYG{n}{first} \PYG{o}{\PYGZlt{}} \PYG{n}{last} \PYG{o}{\PYGZam{}\PYGZam{}} \PYG{o}{!}\PYG{n}{OnLeft}\PYG{p}{(}\PYG{n}{L}\PYG{p}{[}\PYG{n}{i}\PYG{p}{],} \PYG{n}{p}\PYG{p}{[}\PYG{n}{first}\PYG{p}{]))} \PYG{n}{first}\PYG{o}{++}\PYG{p}{;}
        \PYG{n}{q}\PYG{p}{[}\PYG{o}{++}\PYG{n}{last}\PYG{p}{]} \PYG{o}{=} \PYG{n}{L}\PYG{p}{[}\PYG{n}{i}\PYG{p}{];}
        \PYG{k}{if}\PYG{p}{(}\PYG{n}{fabs}\PYG{p}{(}\PYG{n}{Cross}\PYG{p}{(}\PYG{n}{q}\PYG{p}{[}\PYG{n}{last}\PYG{p}{].}\PYG{n}{v}\PYG{p}{,} \PYG{n}{q}\PYG{p}{[}\PYG{n}{last}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{].}\PYG{n}{v}\PYG{p}{))} \PYG{o}{\PYGZlt{}} \PYG{n}{eps}\PYG{p}{)} \PYG{p}{\PYGZob{}}\PYG{c+c1}{// 两向量平行且同向，取内侧的一个}
            \PYG{n}{last}\PYG{o}{\PYGZhy{}\PYGZhy{}}\PYG{p}{;}
            \PYG{k}{if}\PYG{p}{(}\PYG{n}{OnLeft}\PYG{p}{(}\PYG{n}{q}\PYG{p}{[}\PYG{n}{last}\PYG{p}{],} \PYG{n}{L}\PYG{p}{[}\PYG{n}{i}\PYG{p}{].}\PYG{n}{p}\PYG{p}{))} \PYG{n}{q}\PYG{p}{[}\PYG{n}{last}\PYG{p}{]} \PYG{o}{=} \PYG{n}{L}\PYG{p}{[}\PYG{n}{i}\PYG{p}{];}
        \PYG{p}{\PYGZcb{}}
        \PYG{k}{if}\PYG{p}{(}\PYG{n}{first} \PYG{o}{\PYGZlt{}} \PYG{n}{last}\PYG{p}{)} \PYG{n}{p}\PYG{p}{[}\PYG{n}{last}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{]} \PYG{o}{=} \PYG{n}{GetLineIntersection}\PYG{p}{(}\PYG{n}{q}\PYG{p}{[}\PYG{n}{last}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{],} \PYG{n}{q}\PYG{p}{[}\PYG{n}{last}\PYG{p}{]);}
    \PYG{p}{\PYGZcb{}}
    \PYG{k}{while}\PYG{p}{(}\PYG{n}{first} \PYG{o}{\PYGZlt{}} \PYG{n}{last} \PYG{o}{\PYGZam{}\PYGZam{}} \PYG{o}{!}\PYG{n}{OnLeft}\PYG{p}{(}\PYG{n}{q}\PYG{p}{[}\PYG{n}{first}\PYG{p}{],} \PYG{n}{p}\PYG{p}{[}\PYG{n}{last}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{]))} \PYG{n}{last}\PYG{o}{\PYGZhy{}\PYGZhy{}}\PYG{p}{;} \PYG{c+c1}{// 删除无用平面}
    \PYG{k}{if}\PYG{p}{(}\PYG{n}{last} \PYG{o}{\PYGZhy{}} \PYG{n}{first} \PYG{o}{\PYGZlt{}=} \PYG{l+m+mi}{1}\PYG{p}{)} \PYG{k}{return} \PYG{n}{ans}\PYG{p}{;} \PYG{c+c1}{// 空集}
    \PYG{n}{p}\PYG{p}{[}\PYG{n}{last}\PYG{p}{]} \PYG{o}{=} \PYG{n}{GetLineIntersection}\PYG{p}{(}\PYG{n}{q}\PYG{p}{[}\PYG{n}{last}\PYG{p}{],} \PYG{n}{q}\PYG{p}{[}\PYG{n}{first}\PYG{p}{]);} \PYG{c+c1}{// 计算首尾两个半平面的交点}
    \PYG{c+c1}{// 从deque复制到输出中}
    \PYG{k}{for}\PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{i} \PYG{o}{=} \PYG{n}{first}\PYG{p}{;} \PYG{n}{i} \PYG{o}{\PYGZlt{}=} \PYG{n}{last}\PYG{p}{;} \PYG{n}{i}\PYG{o}{++}\PYG{p}{)} \PYG{n}{ans}\PYG{p}{.}\PYG{n}{push\PYGZus{}back}\PYG{p}{(}\PYG{n}{p}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]);}
    \PYG{k}{return} \PYG{n}{ans}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{c+cm}{/***********多边形**************/}
\PYG{k+kt}{double} \PYG{n}{PolygonArea}\PYG{p}{(}\PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{Point}\PYG{o}{\PYGZgt{}} \PYG{n}{p}\PYG{p}{)} \PYG{p}{\PYGZob{}}
  \PYG{k+kt}{int} \PYG{n}{n} \PYG{o}{=} \PYG{n}{p}\PYG{p}{.}\PYG{n}{size}\PYG{p}{();}
  \PYG{k+kt}{double} \PYG{n}{area} \PYG{o}{=} \PYG{l+m+mi}{0}\PYG{p}{;}
  \PYG{k}{for}\PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{i} \PYG{o}{=} \PYG{l+m+mi}{1}\PYG{p}{;} \PYG{n}{i} \PYG{o}{\PYGZlt{}} \PYG{n}{n} \PYG{o}{\PYGZhy{}} \PYG{l+m+mi}{1}\PYG{p}{;} \PYG{n}{i}\PYG{o}{++}\PYG{p}{)}
    \PYG{n}{area} \PYG{o}{+=} \PYG{n}{Cross}\PYG{p}{(}\PYG{n}{p}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{n}{p}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{],} \PYG{n}{p}\PYG{p}{[}\PYG{n}{i}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{n}{p}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]);}
  \PYG{k}{return} \PYG{n}{area} \PYG{o}{/} \PYG{l+m+mi}{2}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{c+c1}{//判断点是否在多边形内}
\PYG{k+kt}{int} \PYG{n}{isPointInPolygon}\PYG{p}{(}\PYG{n}{Point} \PYG{n}{p}\PYG{p}{,} \PYG{n}{Polygon} \PYG{n}{poly}\PYG{p}{)\PYGZob{}}
    \PYG{k+kt}{int} \PYG{n}{wn} \PYG{o}{=} \PYG{l+m+mi}{0}\PYG{p}{;}
    \PYG{k+kt}{int} \PYG{n}{n} \PYG{o}{=} \PYG{n}{poly}\PYG{p}{.}\PYG{n}{size}\PYG{p}{();}
    \PYG{k}{for} \PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{i} \PYG{o}{=} \PYG{l+m+mi}{0}\PYG{p}{;} \PYG{n}{i} \PYG{o}{\PYGZlt{}} \PYG{n}{n}\PYG{p}{;} \PYG{n}{i}\PYG{o}{++}\PYG{p}{)\PYGZob{}}
        \PYG{k}{if} \PYG{p}{(}\PYG{n}{OnSegment}\PYG{p}{(}\PYG{n}{p}\PYG{p}{,} \PYG{n}{poly}\PYG{p}{[}\PYG{n}{i}\PYG{p}{],} \PYG{n}{poly}\PYG{p}{[(}\PYG{n}{i} \PYG{o}{+} \PYG{l+m+mi}{1}\PYG{p}{)} \PYG{o}{\PYGZpc{}} \PYG{n}{n}\PYG{p}{]))} \PYG{k}{return} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{;}    \PYG{c+c1}{//边界}
        \PYG{k+kt}{int} \PYG{n}{k} \PYG{o}{=} \PYG{n}{dcmp}\PYG{p}{(}\PYG{n}{Cross}\PYG{p}{(}\PYG{n}{poly}\PYG{p}{[(}\PYG{n}{i} \PYG{o}{+} \PYG{l+m+mi}{1}\PYG{p}{)} \PYG{o}{\PYGZpc{}} \PYG{n}{n}\PYG{p}{]} \PYG{o}{\PYGZhy{}} \PYG{n}{poly}\PYG{p}{[}\PYG{n}{i}\PYG{p}{],} \PYG{n}{p} \PYG{o}{\PYGZhy{}} \PYG{n}{poly}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]));}
        \PYG{k+kt}{int} \PYG{n}{d1} \PYG{o}{=} \PYG{n}{dcmp}\PYG{p}{(}\PYG{n}{poly}\PYG{p}{[}\PYG{n}{i}\PYG{p}{].}\PYG{n}{y} \PYG{o}{\PYGZhy{}} \PYG{n}{p}\PYG{p}{.}\PYG{n}{y}\PYG{p}{);}
        \PYG{k+kt}{int} \PYG{n}{d2} \PYG{o}{=} \PYG{n}{dcmp}\PYG{p}{(}\PYG{n}{poly}\PYG{p}{[(}\PYG{n}{i} \PYG{o}{+} \PYG{l+m+mi}{1}\PYG{p}{)} \PYG{o}{\PYGZpc{}} \PYG{n}{n}\PYG{p}{].}\PYG{n}{y} \PYG{o}{\PYGZhy{}} \PYG{n}{p}\PYG{p}{.}\PYG{n}{y}\PYG{p}{);}
        \PYG{k}{if} \PYG{p}{(}\PYG{n}{k} \PYG{o}{\PYGZgt{}} \PYG{l+m+mi}{0} \PYG{o}{\PYGZam{}\PYGZam{}} \PYG{n}{d1} \PYG{o}{\PYGZlt{}=} \PYG{l+m+mi}{0} \PYG{o}{\PYGZam{}\PYGZam{}} \PYG{n}{d2} \PYG{o}{\PYGZgt{}} \PYG{l+m+mi}{0}\PYG{p}{)} \PYG{n}{wn}\PYG{o}{++}\PYG{p}{;}
        \PYG{k}{if} \PYG{p}{(}\PYG{n}{k} \PYG{o}{\PYGZlt{}} \PYG{l+m+mi}{0} \PYG{o}{\PYGZam{}\PYGZam{}} \PYG{n}{d2} \PYG{o}{\PYGZlt{}=} \PYG{l+m+mi}{0} \PYG{o}{\PYGZam{}\PYGZam{}} \PYG{n}{d1} \PYG{o}{\PYGZgt{}} \PYG{l+m+mi}{0}\PYG{p}{)} \PYG{n}{wn}\PYG{o}{\PYGZhy{}\PYGZhy{}}\PYG{p}{;}
    \PYG{p}{\PYGZcb{}}
    \PYG{k}{if} \PYG{p}{(}\PYG{n}{wn} \PYG{o}{!=} \PYG{l+m+mi}{0}\PYG{p}{)} \PYG{k}{return} \PYG{l+m+mi}{1}\PYG{p}{;}  \PYG{c+c1}{//内部}
    \PYG{k}{return} \PYG{l+m+mi}{0}\PYG{p}{;}   \PYG{c+c1}{//外部}
\PYG{p}{\PYGZcb{}}
\PYG{c+c1}{//多边形重心 点集逆时针给出}
\PYG{n}{Point} \PYG{n}{PolyGravity}\PYG{p}{(}\PYG{n}{Point} \PYG{o}{*}\PYG{n}{p}\PYG{p}{,} \PYG{k+kt}{int} \PYG{n}{n}\PYG{p}{)} \PYG{p}{\PYGZob{}}
    \PYG{n}{Point} \PYG{n}{tmp}\PYG{p}{,} \PYG{n}{g} \PYG{o}{=} \PYG{n}{Point}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{);}
    \PYG{k+kt}{double} \PYG{n}{sumArea} \PYG{o}{=} \PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{area}\PYG{p}{;}
    \PYG{k}{for} \PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{i}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{;} \PYG{n}{i}\PYG{o}{\PYGZlt{}}\PYG{n}{n}\PYG{p}{;} \PYG{o}{++}\PYG{n}{i}\PYG{p}{)} \PYG{p}{\PYGZob{}}
        \PYG{n}{area} \PYG{o}{=} \PYG{n}{Cross}\PYG{p}{(}\PYG{n}{p}\PYG{p}{[}\PYG{n}{i}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{n}{p}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{],} \PYG{n}{p}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{n}{p}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]);}
        \PYG{n}{sumArea} \PYG{o}{+=} \PYG{n}{area}\PYG{p}{;}
        \PYG{n}{tmp}\PYG{p}{.}\PYG{n}{x} \PYG{o}{=} \PYG{n}{p}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{].}\PYG{n}{x} \PYG{o}{+} \PYG{n}{p}\PYG{p}{[}\PYG{n}{i}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{].}\PYG{n}{x} \PYG{o}{+} \PYG{n}{p}\PYG{p}{[}\PYG{n}{i}\PYG{p}{].}\PYG{n}{x}\PYG{p}{;}
        \PYG{n}{tmp}\PYG{p}{.}\PYG{n}{y} \PYG{o}{=} \PYG{n}{p}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{].}\PYG{n}{y} \PYG{o}{+} \PYG{n}{p}\PYG{p}{[}\PYG{n}{i}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{].}\PYG{n}{y} \PYG{o}{+} \PYG{n}{p}\PYG{p}{[}\PYG{n}{i}\PYG{p}{].}\PYG{n}{y}\PYG{p}{;}
        \PYG{n}{g}\PYG{p}{.}\PYG{n}{x} \PYG{o}{+=} \PYG{n}{tmp}\PYG{p}{.}\PYG{n}{x} \PYG{o}{*} \PYG{n}{area}\PYG{p}{;}
        \PYG{n}{g}\PYG{p}{.}\PYG{n}{y} \PYG{o}{+=} \PYG{n}{tmp}\PYG{p}{.}\PYG{n}{y} \PYG{o}{*} \PYG{n}{area}\PYG{p}{;}
    \PYG{p}{\PYGZcb{}}
    \PYG{n}{g}\PYG{p}{.}\PYG{n}{x} \PYG{o}{/=} \PYG{p}{(}\PYG{n}{sumArea} \PYG{o}{*} \PYG{l+m+mf}{3.0}\PYG{p}{);} \PYG{n}{g}\PYG{p}{.}\PYG{n}{y} \PYG{o}{/=} \PYG{p}{(}\PYG{n}{sumArea} \PYG{o}{*} \PYG{l+m+mf}{3.0}\PYG{p}{);}
    \PYG{k}{return} \PYG{n}{g}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{c+c1}{//多边形重心计算模板}
\PYG{n}{Point} \PYG{n}{bcenter}\PYG{p}{(}\PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{Point}\PYG{o}{\PYGZgt{}} \PYG{n}{pnt}\PYG{p}{)\PYGZob{}}
    \PYG{k+kt}{int} \PYG{n}{n} \PYG{o}{=} \PYG{n}{pnt}\PYG{p}{.}\PYG{n}{size}\PYG{p}{();}
    \PYG{n}{Point} \PYG{n}{p}\PYG{p}{,} \PYG{n}{s}\PYG{p}{;}
    \PYG{k+kt}{double} \PYG{n}{tp}\PYG{p}{,} \PYG{n}{area} \PYG{o}{=} \PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{tpx} \PYG{o}{=} \PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{tpy} \PYG{o}{=} \PYG{l+m+mi}{0}\PYG{p}{;}
    \PYG{n}{p}\PYG{p}{.}\PYG{n}{x} \PYG{o}{=} \PYG{n}{pnt}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{].}\PYG{n}{x}\PYG{p}{;}
    \PYG{n}{p}\PYG{p}{.}\PYG{n}{y} \PYG{o}{=} \PYG{n}{pnt}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{].}\PYG{n}{y}\PYG{p}{;}
    \PYG{c+c1}{//FE(i, 1, n)}
    \PYG{k}{for}\PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{i}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{;}\PYG{n}{i}\PYG{o}{\PYGZlt{}=}\PYG{n}{n}\PYG{p}{;}\PYG{n}{i}\PYG{o}{++}\PYG{p}{)\PYGZob{}}
        \PYG{n}{s}\PYG{p}{.}\PYG{n}{x} \PYG{o}{=} \PYG{n}{pnt}\PYG{p}{[(}\PYG{n}{i} \PYG{o}{==} \PYG{n}{n}\PYG{p}{)} \PYG{o}{?} \PYG{l+m+mi}{0} \PYG{o}{:} \PYG{n}{i}\PYG{p}{].}\PYG{n}{x}\PYG{p}{;}
        \PYG{n}{s}\PYG{p}{.}\PYG{n}{y} \PYG{o}{=} \PYG{n}{pnt}\PYG{p}{[(}\PYG{n}{i} \PYG{o}{==} \PYG{n}{n}\PYG{p}{)} \PYG{o}{?} \PYG{l+m+mi}{0} \PYG{o}{:} \PYG{n}{i}\PYG{p}{].}\PYG{n}{y}\PYG{p}{;}
        \PYG{n}{tp} \PYG{o}{=} \PYG{p}{(}\PYG{n}{p}\PYG{p}{.}\PYG{n}{x} \PYG{o}{*} \PYG{n}{s}\PYG{p}{.}\PYG{n}{y} \PYG{o}{\PYGZhy{}} \PYG{n}{s}\PYG{p}{.}\PYG{n}{x} \PYG{o}{*} \PYG{n}{p}\PYG{p}{.}\PYG{n}{y}\PYG{p}{);}
        \PYG{n}{area} \PYG{o}{+=} \PYG{n}{tp} \PYG{o}{/} \PYG{l+m+mi}{2}\PYG{p}{;}
        \PYG{n}{tpx} \PYG{o}{+=} \PYG{p}{(}\PYG{n}{p}\PYG{p}{.}\PYG{n}{x} \PYG{o}{+} \PYG{n}{s}\PYG{p}{.}\PYG{n}{x}\PYG{p}{)} \PYG{o}{*} \PYG{n}{tp}\PYG{p}{;}
        \PYG{n}{tpy} \PYG{o}{+=} \PYG{p}{(}\PYG{n}{p}\PYG{p}{.}\PYG{n}{y} \PYG{o}{+} \PYG{n}{s}\PYG{p}{.}\PYG{n}{y}\PYG{p}{)} \PYG{o}{*} \PYG{n}{tp}\PYG{p}{;}
        \PYG{n}{p}\PYG{p}{.}\PYG{n}{x} \PYG{o}{=} \PYG{n}{s}\PYG{p}{.}\PYG{n}{x}\PYG{p}{;}
        \PYG{n}{p}\PYG{p}{.}\PYG{n}{y} \PYG{o}{=} \PYG{n}{s}\PYG{p}{.}\PYG{n}{y}\PYG{p}{;}
    \PYG{p}{\PYGZcb{}}
    \PYG{n}{s}\PYG{p}{.}\PYG{n}{x} \PYG{o}{=} \PYG{n}{tpx} \PYG{o}{/} \PYG{p}{(}\PYG{l+m+mi}{6} \PYG{o}{*} \PYG{n}{area}\PYG{p}{);}
    \PYG{n}{s}\PYG{p}{.}\PYG{n}{y} \PYG{o}{=} \PYG{n}{tpy} \PYG{o}{/} \PYG{p}{(}\PYG{l+m+mi}{6} \PYG{o}{*} \PYG{n}{area}\PYG{p}{);}
    \PYG{k}{return} \PYG{n}{s}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{c+c1}{// 点集凸包}
\PYG{c+c1}{// 如果希望在凸包的边上有输入点，把两个 \PYGZlt{}= 改成 \PYGZlt{}}
\PYG{c+c1}{// 注意：输入点集会被修改}
\PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{Point}\PYG{o}{\PYGZgt{}} \PYG{n}{ConvexHull}\PYG{p}{(}\PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{Point}\PYG{o}{\PYGZgt{}\PYGZam{}} \PYG{n}{p}\PYG{p}{)\PYGZob{}}
    \PYG{c+c1}{// 预处理，删除重复点}
    \PYG{n}{sort}\PYG{p}{(}\PYG{n}{p}\PYG{p}{.}\PYG{n}{begin}\PYG{p}{(),} \PYG{n}{p}\PYG{p}{.}\PYG{n}{end}\PYG{p}{());}
    \PYG{n}{p}\PYG{p}{.}\PYG{n}{erase}\PYG{p}{(}\PYG{n}{unique}\PYG{p}{(}\PYG{n}{p}\PYG{p}{.}\PYG{n}{begin}\PYG{p}{(),} \PYG{n}{p}\PYG{p}{.}\PYG{n}{end}\PYG{p}{()),} \PYG{n}{p}\PYG{p}{.}\PYG{n}{end}\PYG{p}{());}
    \PYG{k+kt}{int} \PYG{n}{n} \PYG{o}{=} \PYG{n}{p}\PYG{p}{.}\PYG{n}{size}\PYG{p}{();}
    \PYG{k+kt}{int} \PYG{n}{m} \PYG{o}{=} \PYG{l+m+mi}{0}\PYG{p}{;}
    \PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{Point}\PYG{o}{\PYGZgt{}} \PYG{n}{ch}\PYG{p}{(}\PYG{n}{n}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{);}
    \PYG{k}{for}\PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{i} \PYG{o}{=} \PYG{l+m+mi}{0}\PYG{p}{;} \PYG{n}{i} \PYG{o}{\PYGZlt{}} \PYG{n}{n}\PYG{p}{;} \PYG{n}{i}\PYG{o}{++}\PYG{p}{)\PYGZob{}}
        \PYG{k}{while}\PYG{p}{(}\PYG{n}{m} \PYG{o}{\PYGZgt{}} \PYG{l+m+mi}{1} \PYG{o}{\PYGZam{}\PYGZam{}} \PYG{n}{Cross}\PYG{p}{(}\PYG{n}{ch}\PYG{p}{[}\PYG{n}{m}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{n}{ch}\PYG{p}{[}\PYG{n}{m}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{],} \PYG{n}{p}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{n}{ch}\PYG{p}{[}\PYG{n}{m}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{])} \PYG{o}{\PYGZlt{}=} \PYG{l+m+mi}{0}\PYG{p}{)} \PYG{n}{m}\PYG{o}{\PYGZhy{}\PYGZhy{}}\PYG{p}{;}
        \PYG{n}{ch}\PYG{p}{[}\PYG{n}{m}\PYG{o}{++}\PYG{p}{]} \PYG{o}{=} \PYG{n}{p}\PYG{p}{[}\PYG{n}{i}\PYG{p}{];}
    \PYG{p}{\PYGZcb{}}
    \PYG{k+kt}{int} \PYG{n}{k} \PYG{o}{=} \PYG{n}{m}\PYG{p}{;}
    \PYG{k}{for}\PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{i} \PYG{o}{=} \PYG{n}{n}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{;} \PYG{n}{i} \PYG{o}{\PYGZgt{}=} \PYG{l+m+mi}{0}\PYG{p}{;} \PYG{n}{i}\PYG{o}{\PYGZhy{}\PYGZhy{}}\PYG{p}{)\PYGZob{}}
        \PYG{k}{while}\PYG{p}{(}\PYG{n}{m} \PYG{o}{\PYGZgt{}} \PYG{n}{k} \PYG{o}{\PYGZam{}\PYGZam{}} \PYG{n}{Cross}\PYG{p}{(}\PYG{n}{ch}\PYG{p}{[}\PYG{n}{m}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{n}{ch}\PYG{p}{[}\PYG{n}{m}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{],} \PYG{n}{p}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{n}{ch}\PYG{p}{[}\PYG{n}{m}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{])} \PYG{o}{\PYGZlt{}=} \PYG{l+m+mi}{0}\PYG{p}{)} \PYG{n}{m}\PYG{o}{\PYGZhy{}\PYGZhy{}}\PYG{p}{;}
        \PYG{n}{ch}\PYG{p}{[}\PYG{n}{m}\PYG{o}{++}\PYG{p}{]} \PYG{o}{=} \PYG{n}{p}\PYG{p}{[}\PYG{n}{i}\PYG{p}{];}
    \PYG{p}{\PYGZcb{}}
    \PYG{k}{if}\PYG{p}{(}\PYG{n}{n} \PYG{o}{\PYGZgt{}} \PYG{l+m+mi}{1}\PYG{p}{)} \PYG{n}{m}\PYG{o}{\PYGZhy{}\PYGZhy{}}\PYG{p}{;}
    \PYG{n}{ch}\PYG{p}{.}\PYG{n}{resize}\PYG{p}{(}\PYG{n}{m}\PYG{p}{);}
    \PYG{k}{return} \PYG{n}{ch}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{k+kr}{inline} \PYG{k+kt}{double} \PYG{n}{Dist2}\PYG{p}{(}\PYG{n}{Point} \PYG{n}{a}\PYG{p}{,} \PYG{n}{Point} \PYG{n}{b}\PYG{p}{)\PYGZob{}}
    \PYG{k}{return} \PYG{n}{sqrt}\PYG{p}{(}\PYG{n}{a}\PYG{p}{.}\PYG{n}{x} \PYG{o}{\PYGZhy{}} \PYG{n}{b}\PYG{p}{.}\PYG{n}{x}\PYG{p}{)} \PYG{o}{+} \PYG{n}{sqrt}\PYG{p}{(}\PYG{n}{a}\PYG{p}{.}\PYG{n}{y} \PYG{o}{\PYGZhy{}} \PYG{n}{b}\PYG{p}{.}\PYG{n}{y}\PYG{p}{);}
\PYG{p}{\PYGZcb{}}
\PYG{c+c1}{// 返回点集直径的平方}
\PYG{k+kt}{double} \PYG{n}{diameter2}\PYG{p}{(}\PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{Point}\PYG{o}{\PYGZgt{}\PYGZam{}} \PYG{n}{points}\PYG{p}{)\PYGZob{}}
    \PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{Point}\PYG{o}{\PYGZgt{}} \PYG{n}{p} \PYG{o}{=} \PYG{n}{ConvexHull}\PYG{p}{(}\PYG{n}{points}\PYG{p}{);}
    \PYG{k+kt}{int} \PYG{n}{n} \PYG{o}{=} \PYG{n}{p}\PYG{p}{.}\PYG{n}{size}\PYG{p}{();}
    \PYG{k}{if}\PYG{p}{(}\PYG{n}{n} \PYG{o}{==} \PYG{l+m+mi}{1}\PYG{p}{)} \PYG{k}{return} \PYG{l+m+mi}{0}\PYG{p}{;}
    \PYG{k}{if}\PYG{p}{(}\PYG{n}{n} \PYG{o}{==} \PYG{l+m+mi}{2}\PYG{p}{)} \PYG{k}{return} \PYG{n}{Dist2}\PYG{p}{(}\PYG{n}{p}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{],} \PYG{n}{p}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]);}
    \PYG{n}{p}\PYG{p}{.}\PYG{n}{push\PYGZus{}back}\PYG{p}{(}\PYG{n}{p}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]);} \PYG{c+c1}{// 免得取模}
    \PYG{k+kt}{double} \PYG{n}{ans} \PYG{o}{=} \PYG{l+m+mi}{0}\PYG{p}{;}
    \PYG{k}{for}\PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{u} \PYG{o}{=} \PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{v} \PYG{o}{=} \PYG{l+m+mi}{1}\PYG{p}{;} \PYG{n}{u} \PYG{o}{\PYGZlt{}} \PYG{n}{n}\PYG{p}{;} \PYG{n}{u}\PYG{o}{++}\PYG{p}{)\PYGZob{}}
        \PYG{c+c1}{// 一条直线贴住边p[u]\PYGZhy{}p[u+1]}
        \PYG{k}{for}\PYG{p}{(;;)\PYGZob{}}
            \PYG{c+c1}{// 当Area(p[u], p[u+1], p[v+1]) \PYGZlt{}= Area(p[u], p[u+1], p[v])时停止旋转}
            \PYG{c+c1}{// 即Cross(p[u+1]\PYGZhy{}p[u], p[v+1]\PYGZhy{}p[u]) \PYGZhy{} Cross(p[u+1]\PYGZhy{}p[u], p[v]\PYGZhy{}p[u]) \PYGZlt{}= 0}
            \PYG{c+c1}{// 根据Cross(A,B) \PYGZhy{} Cross(A,C) = Cross(A,B\PYGZhy{}C)}
            \PYG{c+c1}{// 化简得Cross(p[u+1]\PYGZhy{}p[u], p[v+1]\PYGZhy{}p[v]) \PYGZlt{}= 0}
            \PYG{k+kt}{int} \PYG{n}{diff} \PYG{o}{=} \PYG{n}{Cross}\PYG{p}{(}\PYG{n}{p}\PYG{p}{[}\PYG{n}{u}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{n}{p}\PYG{p}{[}\PYG{n}{u}\PYG{p}{],} \PYG{n}{p}\PYG{p}{[}\PYG{n}{v}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{n}{p}\PYG{p}{[}\PYG{n}{v}\PYG{p}{]);}
            \PYG{k}{if}\PYG{p}{(}\PYG{n}{diff} \PYG{o}{\PYGZlt{}=} \PYG{l+m+mi}{0}\PYG{p}{)\PYGZob{}}
                \PYG{n}{ans} \PYG{o}{=} \PYG{n}{max}\PYG{p}{(}\PYG{n}{ans}\PYG{p}{,} \PYG{n}{Dist2}\PYG{p}{(}\PYG{n}{p}\PYG{p}{[}\PYG{n}{u}\PYG{p}{],} \PYG{n}{p}\PYG{p}{[}\PYG{n}{v}\PYG{p}{]));} \PYG{c+c1}{// u和v是对踵点}
                \PYG{k}{if}\PYG{p}{(}\PYG{n}{diff} \PYG{o}{==} \PYG{l+m+mi}{0}\PYG{p}{)}
                    \PYG{n}{ans} \PYG{o}{=} \PYG{n}{max}\PYG{p}{(}\PYG{n}{ans}\PYG{p}{,} \PYG{n}{Dist2}\PYG{p}{(}\PYG{n}{p}\PYG{p}{[}\PYG{n}{u}\PYG{p}{],} \PYG{n}{p}\PYG{p}{[}\PYG{n}{v}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{]));} \PYG{c+c1}{// diff == 0时u和v+1也是对踵点}
                \PYG{k}{break}\PYG{p}{;}
            \PYG{p}{\PYGZcb{}}
            \PYG{n}{v} \PYG{o}{=} \PYG{p}{(}\PYG{n}{v} \PYG{o}{+} \PYG{l+m+mi}{1}\PYG{p}{)} \PYG{o}{\PYGZpc{}} \PYG{n}{n}\PYG{p}{;}
        \PYG{p}{\PYGZcb{}}
    \PYG{p}{\PYGZcb{}}
    \PYG{k}{return} \PYG{n}{ans}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{c+c1}{//两凸包最近距离}
\PYG{k+kt}{double} \PYG{n}{RC\PYGZus{}Distance}\PYG{p}{(}\PYG{n}{Point} \PYG{o}{*}\PYG{n}{ch1}\PYG{p}{,} \PYG{n}{Point} \PYG{o}{*}\PYG{n}{ch2}\PYG{p}{,} \PYG{k+kt}{int} \PYG{n}{n}\PYG{p}{,} \PYG{k+kt}{int} \PYG{n}{m}\PYG{p}{)\PYGZob{}}
    \PYG{k+kt}{int} \PYG{n}{q}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{p}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{;}
    \PYG{k}{for}\PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{i}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{;}\PYG{n}{i}\PYG{o}{\PYGZlt{}=}\PYG{n}{n}\PYG{p}{;}\PYG{n}{i}\PYG{o}{++}\PYG{p}{)}
    \PYG{k}{if}\PYG{p}{(}\PYG{n}{ch1}\PYG{p}{[}\PYG{n}{i}\PYG{p}{].}\PYG{n}{y}\PYG{o}{\PYGZhy{}}\PYG{n}{ch1}\PYG{p}{[}\PYG{n}{p}\PYG{p}{].}\PYG{n}{y} \PYG{o}{\PYGZlt{}} \PYG{o}{\PYGZhy{}}\PYG{n}{eps}\PYG{p}{)} \PYG{n}{p}\PYG{o}{=}\PYG{n}{i}\PYG{p}{;}
    \PYG{k}{for}\PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{i}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{;}\PYG{n}{i}\PYG{o}{\PYGZlt{}=}\PYG{n}{m}\PYG{p}{;}\PYG{n}{i}\PYG{o}{++}\PYG{p}{)}
    \PYG{k}{if}\PYG{p}{(}\PYG{n}{ch2}\PYG{p}{[}\PYG{n}{i}\PYG{p}{].}\PYG{n}{y}\PYG{o}{\PYGZhy{}}\PYG{n}{ch2}\PYG{p}{[}\PYG{n}{q}\PYG{p}{].}\PYG{n}{y} \PYG{o}{\PYGZgt{}} \PYG{n}{eps}\PYG{p}{)} \PYG{n}{q}\PYG{o}{=}\PYG{n}{i}\PYG{p}{;}
    \PYG{n}{ch1}\PYG{p}{[}\PYG{n}{n}\PYG{p}{]}\PYG{o}{=}\PYG{n}{ch1}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{];}
    \PYG{n}{ch2}\PYG{p}{[}\PYG{n}{m}\PYG{p}{]}\PYG{o}{=}\PYG{n}{ch2}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{];}
    \PYG{k+kt}{double} \PYG{n}{tmp}\PYG{p}{,} \PYG{n}{ans}\PYG{o}{=}\PYG{l+m+mf}{1e100}\PYG{p}{;}
    \PYG{k}{for}\PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{i}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{;}\PYG{n}{i}\PYG{o}{\PYGZlt{}=}\PYG{n}{n}\PYG{p}{;}\PYG{n}{i}\PYG{o}{++}\PYG{p}{)\PYGZob{}}
        \PYG{k}{while}\PYG{p}{((}\PYG{n}{tmp}\PYG{o}{=}\PYG{n}{Cross}\PYG{p}{(}\PYG{n}{ch1}\PYG{p}{[}\PYG{n}{p}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{n}{ch1}\PYG{p}{[}\PYG{n}{p}\PYG{p}{],}\PYG{n}{ch2}\PYG{p}{[}\PYG{n}{q}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{n}{ch1}\PYG{p}{[}\PYG{n}{p}\PYG{p}{])}\PYG{o}{\PYGZhy{}}\PYG{n}{Cross}\PYG{p}{(}\PYG{n}{ch1}\PYG{p}{[}\PYG{n}{p}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{n}{ch1}\PYG{p}{[}\PYG{n}{p}\PYG{p}{],}\PYG{n}{ch2}\PYG{p}{[}\PYG{n}{q}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{n}{ch1}\PYG{p}{[}\PYG{n}{p}\PYG{p}{]))}\PYG{o}{\PYGZgt{}}\PYG{n}{eps}\PYG{p}{)}
            \PYG{n}{q}\PYG{o}{=}\PYG{p}{(}\PYG{n}{q}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{\PYGZpc{}}\PYG{n}{m}\PYG{p}{;}
        \PYG{k}{if}\PYG{p}{(}\PYG{n}{tmp} \PYG{o}{\PYGZlt{}} \PYG{o}{\PYGZhy{}}\PYG{n}{eps}\PYG{p}{)} \PYG{n}{ans} \PYG{o}{=} \PYG{n}{min}\PYG{p}{(}\PYG{n}{ans}\PYG{p}{,}\PYG{n}{DistanceToSegment}\PYG{p}{(}\PYG{n}{ch2}\PYG{p}{[}\PYG{n}{q}\PYG{p}{],}\PYG{n}{ch1}\PYG{p}{[}\PYG{n}{p}\PYG{p}{],}\PYG{n}{ch1}\PYG{p}{[}\PYG{n}{p}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{]));}
        \PYG{k}{else} \PYG{n}{ans} \PYG{o}{=} \PYG{n}{min}\PYG{p}{(}\PYG{n}{ans}\PYG{p}{,}\PYG{n}{dis\PYGZus{}pair\PYGZus{}seg}\PYG{p}{(}\PYG{n}{ch1}\PYG{p}{[}\PYG{n}{p}\PYG{p}{],}\PYG{n}{ch1}\PYG{p}{[}\PYG{n}{p}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{],}\PYG{n}{ch2}\PYG{p}{[}\PYG{n}{q}\PYG{p}{],}\PYG{n}{ch2}\PYG{p}{[}\PYG{n}{q}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{]));}
        \PYG{n}{p}\PYG{o}{=}\PYG{p}{(}\PYG{n}{p}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{\PYGZpc{}}\PYG{n}{n}\PYG{p}{;}
    \PYG{p}{\PYGZcb{}}
    \PYG{k}{return} \PYG{n}{ans}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{c+c1}{//两凸包最近距离}
\PYG{c+c1}{//使用vector}
\PYG{k+kt}{double} \PYG{n}{RC\PYGZus{}Distance}\PYG{p}{(}\PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{Point}\PYG{o}{\PYGZgt{}} \PYG{n}{ch1}\PYG{p}{,} \PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{Point}\PYG{o}{\PYGZgt{}} \PYG{n}{ch2}\PYG{p}{)\PYGZob{}}
    \PYG{k+kt}{int} \PYG{n}{q} \PYG{o}{=} \PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{p} \PYG{o}{=} \PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{n} \PYG{o}{=} \PYG{n}{ch1}\PYG{p}{.}\PYG{n}{size}\PYG{p}{(),} \PYG{n}{m} \PYG{o}{=} \PYG{n}{ch2}\PYG{p}{.}\PYG{n}{size}\PYG{p}{();}
    \PYG{k}{for}\PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{i}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{;}\PYG{n}{i}\PYG{o}{\PYGZlt{}=}\PYG{n}{n}\PYG{p}{;}\PYG{n}{i}\PYG{o}{++}\PYG{p}{)}
    \PYG{k}{if}\PYG{p}{(}\PYG{n}{ch1}\PYG{p}{[}\PYG{n}{i}\PYG{p}{].}\PYG{n}{y}\PYG{o}{\PYGZhy{}}\PYG{n}{ch1}\PYG{p}{[}\PYG{n}{p}\PYG{p}{].}\PYG{n}{y} \PYG{o}{\PYGZlt{}} \PYG{o}{\PYGZhy{}}\PYG{n}{eps}\PYG{p}{)} \PYG{n}{p}\PYG{o}{=}\PYG{n}{i}\PYG{p}{;}
    \PYG{k}{for}\PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{i}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{;}\PYG{n}{i}\PYG{o}{\PYGZlt{}=}\PYG{n}{m}\PYG{p}{;}\PYG{n}{i}\PYG{o}{++}\PYG{p}{)}
    \PYG{k}{if}\PYG{p}{(}\PYG{n}{ch2}\PYG{p}{[}\PYG{n}{i}\PYG{p}{].}\PYG{n}{y}\PYG{o}{\PYGZhy{}}\PYG{n}{ch2}\PYG{p}{[}\PYG{n}{q}\PYG{p}{].}\PYG{n}{y} \PYG{o}{\PYGZgt{}} \PYG{n}{eps}\PYG{p}{)} \PYG{n}{q}\PYG{o}{=}\PYG{n}{i}\PYG{p}{;}
    \PYG{n}{ch1}\PYG{p}{.}\PYG{n}{push\PYGZus{}back}\PYG{p}{(}\PYG{n}{ch1}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]),} \PYG{n}{ch2}\PYG{p}{.}\PYG{n}{push\PYGZus{}back}\PYG{p}{(}\PYG{n}{ch2}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]);}
    \PYG{k+kt}{double} \PYG{n}{tmp}\PYG{p}{,} \PYG{n}{ans}\PYG{o}{=}\PYG{l+m+mf}{1e100}\PYG{p}{;}
    \PYG{k}{for}\PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{i}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{;}\PYG{n}{i}\PYG{o}{\PYGZlt{}=}\PYG{n}{n}\PYG{p}{;}\PYG{n}{i}\PYG{o}{++}\PYG{p}{)\PYGZob{}}
        \PYG{k}{while}\PYG{p}{((}\PYG{n}{tmp}\PYG{o}{=}\PYG{n}{Cross}\PYG{p}{(}\PYG{n}{ch1}\PYG{p}{[}\PYG{n}{p}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{n}{ch1}\PYG{p}{[}\PYG{n}{p}\PYG{p}{],}\PYG{n}{ch2}\PYG{p}{[}\PYG{n}{q}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{n}{ch1}\PYG{p}{[}\PYG{n}{p}\PYG{p}{])}\PYG{o}{\PYGZhy{}}\PYG{n}{Cross}\PYG{p}{(}\PYG{n}{ch1}\PYG{p}{[}\PYG{n}{p}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{n}{ch1}\PYG{p}{[}\PYG{n}{p}\PYG{p}{],}\PYG{n}{ch2}\PYG{p}{[}\PYG{n}{q}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{n}{ch1}\PYG{p}{[}\PYG{n}{p}\PYG{p}{]))}\PYG{o}{\PYGZgt{}}\PYG{n}{eps}\PYG{p}{)}
            \PYG{n}{q}\PYG{o}{=}\PYG{p}{(}\PYG{n}{q}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{\PYGZpc{}}\PYG{n}{m}\PYG{p}{;}
        \PYG{k}{if}\PYG{p}{(}\PYG{n}{tmp} \PYG{o}{\PYGZlt{}} \PYG{o}{\PYGZhy{}}\PYG{n}{eps}\PYG{p}{)} \PYG{n}{ans} \PYG{o}{=} \PYG{n}{min}\PYG{p}{(}\PYG{n}{ans}\PYG{p}{,}\PYG{n}{DistanceToSegment}\PYG{p}{(}\PYG{n}{ch2}\PYG{p}{[}\PYG{n}{q}\PYG{p}{],}\PYG{n}{ch1}\PYG{p}{[}\PYG{n}{p}\PYG{p}{],}\PYG{n}{ch1}\PYG{p}{[}\PYG{n}{p}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{]));}
        \PYG{k}{else} \PYG{n}{ans} \PYG{o}{=} \PYG{n}{min}\PYG{p}{(}\PYG{n}{ans}\PYG{p}{,}\PYG{n}{dis\PYGZus{}pair\PYGZus{}seg}\PYG{p}{(}\PYG{n}{ch1}\PYG{p}{[}\PYG{n}{p}\PYG{p}{],}\PYG{n}{ch1}\PYG{p}{[}\PYG{n}{p}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{],}\PYG{n}{ch2}\PYG{p}{[}\PYG{n}{q}\PYG{p}{],}\PYG{n}{ch2}\PYG{p}{[}\PYG{n}{q}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{]));}
        \PYG{n}{p}\PYG{o}{=}\PYG{p}{(}\PYG{n}{p}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{\PYGZpc{}}\PYG{n}{n}\PYG{p}{;}
    \PYG{p}{\PYGZcb{}}
    \PYG{k}{return} \PYG{n}{ans}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{c+c1}{//凸包最大内接三角形}
\PYG{k+kt}{double} \PYG{n}{RC\PYGZus{}Triangle}\PYG{p}{(}\PYG{n}{Point}\PYG{o}{*} \PYG{n}{res}\PYG{p}{,}\PYG{k+kt}{int} \PYG{n}{n}\PYG{p}{)\PYGZob{}}
    \PYG{k}{if}\PYG{p}{(}\PYG{n}{n} \PYG{o}{\PYGZlt{}} \PYG{l+m+mi}{3}\PYG{p}{)}    \PYG{k}{return} \PYG{l+m+mi}{0}\PYG{p}{;}
    \PYG{k+kt}{double} \PYG{n}{ans} \PYG{o}{=} \PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{tmp}\PYG{p}{;}
    \PYG{n}{res}\PYG{p}{[}\PYG{n}{n}\PYG{p}{]} \PYG{o}{=} \PYG{n}{res}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{];}
    \PYG{k+kt}{int} \PYG{n}{j}\PYG{p}{,} \PYG{n}{k}\PYG{p}{;}
    \PYG{c+c1}{//REP(i, n)}
    \PYG{k}{for}\PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{i}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{;}\PYG{n}{i}\PYG{o}{\PYGZlt{}=}\PYG{n}{n}\PYG{p}{;}\PYG{n}{i}\PYG{o}{++}\PYG{p}{)\PYGZob{}}
        \PYG{n}{j} \PYG{o}{=} \PYG{p}{(}\PYG{n}{i}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{\PYGZpc{}}\PYG{n}{n}\PYG{p}{;}
        \PYG{n}{k} \PYG{o}{=} \PYG{p}{(}\PYG{n}{j}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{\PYGZpc{}}\PYG{n}{n}\PYG{p}{;}
        \PYG{k}{while}\PYG{p}{((}\PYG{n}{j} \PYG{o}{!=} \PYG{n}{k}\PYG{p}{)} \PYG{o}{\PYGZam{}\PYGZam{}} \PYG{p}{(}\PYG{n}{k} \PYG{o}{!=} \PYG{n}{i}\PYG{p}{))\PYGZob{}}
            \PYG{k}{while}\PYG{p}{(}\PYG{n}{Cross}\PYG{p}{(}\PYG{n}{res}\PYG{p}{[}\PYG{n}{j}\PYG{p}{]} \PYG{o}{\PYGZhy{}} \PYG{n}{res}\PYG{p}{[}\PYG{n}{i}\PYG{p}{],} \PYG{n}{res}\PYG{p}{[}\PYG{n}{k}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{]} \PYG{o}{\PYGZhy{}} \PYG{n}{res}\PYG{p}{[}\PYG{n}{i}\PYG{p}{])} \PYG{o}{\PYGZgt{}} \PYG{n}{Cross}\PYG{p}{(}\PYG{n}{res}\PYG{p}{[}\PYG{n}{j}\PYG{p}{]} \PYG{o}{\PYGZhy{}} \PYG{n}{res}\PYG{p}{[}\PYG{n}{i}\PYG{p}{],} \PYG{n}{res}\PYG{p}{[}\PYG{n}{k}\PYG{p}{]} \PYG{o}{\PYGZhy{}} \PYG{n}{res}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]))\PYGZob{}}
                \PYG{n}{k}\PYG{o}{=} \PYG{p}{(}\PYG{n}{k}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{\PYGZpc{}}\PYG{n}{n}\PYG{p}{;}
            \PYG{p}{\PYGZcb{}}
            \PYG{n}{tmp} \PYG{o}{=} \PYG{n}{Cross}\PYG{p}{(}\PYG{n}{res}\PYG{p}{[}\PYG{n}{j}\PYG{p}{]} \PYG{o}{\PYGZhy{}} \PYG{n}{res}\PYG{p}{[}\PYG{n}{i}\PYG{p}{],} \PYG{n}{res}\PYG{p}{[}\PYG{n}{k}\PYG{p}{]} \PYG{o}{\PYGZhy{}} \PYG{n}{res}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]);}
            \PYG{k}{if}\PYG{p}{(}\PYG{n}{tmp} \PYG{o}{\PYGZgt{}} \PYG{n}{ans}\PYG{p}{)} \PYG{n}{ans} \PYG{o}{=} \PYG{n}{tmp}\PYG{p}{;}
            \PYG{n}{j} \PYG{o}{=} \PYG{p}{(}\PYG{n}{j}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{\PYGZpc{}}\PYG{n}{n}\PYG{p}{;}
        \PYG{p}{\PYGZcb{}}
    \PYG{p}{\PYGZcb{}}
    \PYG{k}{return} \PYG{n}{ans}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{c+c1}{//凸包最大内接三角形}
\PYG{k+kt}{double} \PYG{n}{RC\PYGZus{}Triangle}\PYG{p}{(}\PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{Point}\PYG{o}{\PYGZgt{}} \PYG{n}{res}\PYG{p}{,} \PYG{n}{Point}\PYG{o}{\PYGZam{}} \PYG{n}{a}\PYG{p}{,} \PYG{n}{Point}\PYG{o}{\PYGZam{}} \PYG{n}{b}\PYG{p}{,} \PYG{n}{Point}\PYG{o}{\PYGZam{}} \PYG{n}{c}\PYG{p}{)}
\PYG{p}{\PYGZob{}}
    \PYG{k+kt}{int} \PYG{n}{n} \PYG{o}{=} \PYG{n}{res}\PYG{p}{.}\PYG{n}{size}\PYG{p}{();}
    \PYG{k}{if}\PYG{p}{(}\PYG{n}{n} \PYG{o}{\PYGZlt{}} \PYG{l+m+mi}{3}\PYG{p}{)}    \PYG{k}{return} \PYG{l+m+mi}{0}\PYG{p}{;}
    \PYG{k+kt}{double} \PYG{n}{ans}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{tmp}\PYG{p}{;}
    \PYG{n}{res}\PYG{p}{.}\PYG{n}{push\PYGZus{}back}\PYG{p}{(}\PYG{n}{res}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]);}
    \PYG{k+kt}{int} \PYG{n}{j}\PYG{p}{,} \PYG{n}{k}\PYG{p}{;}
    \PYG{c+c1}{//REP(i, n)}
    \PYG{k}{for}\PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{i}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{;}\PYG{n}{i}\PYG{o}{\PYGZlt{}=}\PYG{n}{n}\PYG{p}{;}\PYG{n}{i}\PYG{o}{++}\PYG{p}{)\PYGZob{}}
        \PYG{n}{j} \PYG{o}{=} \PYG{p}{(}\PYG{n}{i}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{\PYGZpc{}}\PYG{n}{n}\PYG{p}{;}
        \PYG{n}{k} \PYG{o}{=} \PYG{p}{(}\PYG{n}{j}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{\PYGZpc{}}\PYG{n}{n}\PYG{p}{;}
        \PYG{k}{while}\PYG{p}{((}\PYG{n}{j} \PYG{o}{!=} \PYG{n}{k}\PYG{p}{)} \PYG{o}{\PYGZam{}\PYGZam{}} \PYG{p}{(}\PYG{n}{k} \PYG{o}{!=} \PYG{n}{i}\PYG{p}{))\PYGZob{}}
            \PYG{k}{while}\PYG{p}{(}\PYG{n}{Cross}\PYG{p}{(}\PYG{n}{res}\PYG{p}{[}\PYG{n}{j}\PYG{p}{]} \PYG{o}{\PYGZhy{}} \PYG{n}{res}\PYG{p}{[}\PYG{n}{i}\PYG{p}{],} \PYG{n}{res}\PYG{p}{[}\PYG{n}{k}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{]} \PYG{o}{\PYGZhy{}} \PYG{n}{res}\PYG{p}{[}\PYG{n}{i}\PYG{p}{])} \PYG{o}{\PYGZgt{}} \PYG{n}{Cross}\PYG{p}{(}\PYG{n}{res}\PYG{p}{[}\PYG{n}{j}\PYG{p}{]} \PYG{o}{\PYGZhy{}} \PYG{n}{res}\PYG{p}{[}\PYG{n}{i}\PYG{p}{],} \PYG{n}{res}\PYG{p}{[}\PYG{n}{k}\PYG{p}{]} \PYG{o}{\PYGZhy{}} \PYG{n}{res}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]))\PYGZob{}}
                \PYG{n}{k}\PYG{o}{=} \PYG{p}{(}\PYG{n}{k}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{\PYGZpc{}}\PYG{n}{n}\PYG{p}{;}
            \PYG{p}{\PYGZcb{}}
            \PYG{n}{tmp} \PYG{o}{=} \PYG{n}{Cross}\PYG{p}{(}\PYG{n}{res}\PYG{p}{[}\PYG{n}{j}\PYG{p}{]} \PYG{o}{\PYGZhy{}} \PYG{n}{res}\PYG{p}{[}\PYG{n}{i}\PYG{p}{],} \PYG{n}{res}\PYG{p}{[}\PYG{n}{k}\PYG{p}{]} \PYG{o}{\PYGZhy{}} \PYG{n}{res}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]);}
            \PYG{k}{if}\PYG{p}{(}\PYG{n}{tmp} \PYG{o}{\PYGZgt{}} \PYG{n}{ans}\PYG{p}{)\PYGZob{}}
                \PYG{n}{a} \PYG{o}{=} \PYG{n}{res}\PYG{p}{[}\PYG{n}{i}\PYG{p}{],} \PYG{n}{b} \PYG{o}{=} \PYG{n}{res}\PYG{p}{[}\PYG{n}{j}\PYG{p}{],} \PYG{n}{c} \PYG{o}{=} \PYG{n}{res}\PYG{p}{[}\PYG{n}{k}\PYG{p}{];}
                \PYG{n}{ans} \PYG{o}{=} \PYG{n}{tmp}\PYG{p}{;}
            \PYG{p}{\PYGZcb{}}
            \PYG{n}{j} \PYG{o}{=} \PYG{p}{(}\PYG{n}{j}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{\PYGZpc{}}\PYG{n}{n}\PYG{p}{;}
        \PYG{p}{\PYGZcb{}}
    \PYG{p}{\PYGZcb{}}
    \PYG{k}{return} \PYG{n}{ans}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{c+c1}{//判断两凸包是否有交点}
\PYG{k+kt}{bool} \PYG{n}{ConvexPolygonDisjoint}\PYG{p}{(}\PYG{k}{const} \PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{Point}\PYG{o}{\PYGZgt{}} \PYG{n}{ch1}\PYG{p}{,} \PYG{k}{const} \PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{Point}\PYG{o}{\PYGZgt{}} \PYG{n}{ch2}\PYG{p}{)\PYGZob{}}
    \PYG{k+kt}{int} \PYG{n}{c1} \PYG{o}{=} \PYG{n}{ch1}\PYG{p}{.}\PYG{n}{size}\PYG{p}{();}
    \PYG{k+kt}{int} \PYG{n}{c2} \PYG{o}{=} \PYG{n}{ch2}\PYG{p}{.}\PYG{n}{size}\PYG{p}{();}
    \PYG{k}{for}\PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{i} \PYG{o}{=} \PYG{l+m+mi}{0}\PYG{p}{;} \PYG{n}{i} \PYG{o}{\PYGZlt{}} \PYG{n}{c1}\PYG{p}{;} \PYG{n}{i}\PYG{o}{++}\PYG{p}{)}
        \PYG{k}{if}\PYG{p}{(}\PYG{n}{isPointInPolygon}\PYG{p}{(}\PYG{n}{ch1}\PYG{p}{[}\PYG{n}{i}\PYG{p}{],} \PYG{n}{ch2}\PYG{p}{)} \PYG{o}{!=} \PYG{l+m+mi}{0}\PYG{p}{)}
            \PYG{k}{return} \PYG{n+nb}{false}\PYG{p}{;} \PYG{c+c1}{// 内部或边界上}
    \PYG{k}{for}\PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{i} \PYG{o}{=} \PYG{l+m+mi}{0}\PYG{p}{;} \PYG{n}{i} \PYG{o}{\PYGZlt{}} \PYG{n}{c2}\PYG{p}{;} \PYG{n}{i}\PYG{o}{++}\PYG{p}{)}
        \PYG{k}{if}\PYG{p}{(}\PYG{n}{isPointInPolygon}\PYG{p}{(}\PYG{n}{ch2}\PYG{p}{[}\PYG{n}{i}\PYG{p}{],} \PYG{n}{ch1}\PYG{p}{)} \PYG{o}{!=} \PYG{l+m+mi}{0}\PYG{p}{)}
            \PYG{k}{return} \PYG{n+nb}{false}\PYG{p}{;} \PYG{c+c1}{// 内部或边界上}
    \PYG{k}{for}\PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{i} \PYG{o}{=} \PYG{l+m+mi}{0}\PYG{p}{;} \PYG{n}{i} \PYG{o}{\PYGZlt{}} \PYG{n}{c1}\PYG{p}{;} \PYG{n}{i}\PYG{o}{++}\PYG{p}{)}
        \PYG{k}{for}\PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{j} \PYG{o}{=} \PYG{l+m+mi}{0}\PYG{p}{;} \PYG{n}{j} \PYG{o}{\PYGZlt{}} \PYG{n}{c2}\PYG{p}{;} \PYG{n}{j}\PYG{o}{++}\PYG{p}{)}
            \PYG{k}{if}\PYG{p}{(}\PYG{n}{SegmentProperIntersection}\PYG{p}{(}\PYG{n}{ch1}\PYG{p}{[}\PYG{n}{i}\PYG{p}{],} \PYG{n}{ch1}\PYG{p}{[(}\PYG{n}{i}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{\PYGZpc{}}\PYG{n}{c1}\PYG{p}{],} \PYG{n}{ch2}\PYG{p}{[}\PYG{n}{j}\PYG{p}{],} \PYG{n}{ch2}\PYG{p}{[(}\PYG{n}{j}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{\PYGZpc{}}\PYG{n}{c2}\PYG{p}{]))}
                \PYG{k}{return} \PYG{n+nb}{false}\PYG{p}{;}
    \PYG{k}{return} \PYG{n+nb}{true}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{k+kr}{inline} \PYG{k+kt}{double} \PYG{n}{dist}\PYG{p}{(}\PYG{n}{Point} \PYG{n}{a}\PYG{p}{,} \PYG{n}{Point} \PYG{n}{b}\PYG{p}{)\PYGZob{}}
    \PYG{k}{return} \PYG{n}{Length}\PYG{p}{(}\PYG{n}{a} \PYG{o}{\PYGZhy{}} \PYG{n}{b}\PYG{p}{);}
\PYG{p}{\PYGZcb{}}
\PYG{c+c1}{////模拟退火求费马点 保存在ptres中}
\PYG{c+c1}{//double fermat\PYGZus{}point(Point *pt, int n, Point\PYGZam{} ptres)}
\PYG{c+c1}{//\PYGZob{}}
\PYG{c+c1}{//    Point u, v;}
\PYG{c+c1}{//    double step = 0.0, curlen, explen, minlen;}
\PYG{c+c1}{//    int i, j, k;}
\PYG{c+c1}{//    bool flag;}
\PYG{c+c1}{//    u.x = u.y = v.x = v.y = 0.0;}
\PYG{c+c1}{//    //REP(i, n)}
\PYG{c+c1}{//    for(int i=1;i\PYGZlt{}=n;i++)}
\PYG{c+c1}{//    \PYGZob{}}
\PYG{c+c1}{//        step += fabs(pt[i].x) + fabs(pt[i].y);}
\PYG{c+c1}{//        u.x += pt[i].x;}
\PYG{c+c1}{//        u.y += pt[i].y;}
\PYG{c+c1}{//    \PYGZcb{}}
\PYG{c+c1}{//    u.x /= n;}
\PYG{c+c1}{//    u.y /= n;}
\PYG{c+c1}{//    flag = 0;}
\PYG{c+c1}{//    while(step \PYGZgt{} eps)}
\PYG{c+c1}{//    \PYGZob{}}
\PYG{c+c1}{//        for(k = 0; k \PYGZlt{} 10; step /= 2, ++k)}
\PYG{c+c1}{//            for(i = \PYGZhy{}1; i \PYGZlt{}= 1; ++i)}
\PYG{c+c1}{//                for(j = \PYGZhy{}1; j \PYGZlt{}= 1; ++j)}
\PYG{c+c1}{//                \PYGZob{}}
\PYG{c+c1}{//                    v.x = u.x + step*i;}
\PYG{c+c1}{//                    v.y = u.y + step*j;}
\PYG{c+c1}{//                    curlen = explen = 0.0;}
\PYG{c+c1}{//                    //REP(i, n)}
\PYG{c+c1}{//                    for(int i=1;i\PYGZlt{}=n;i++)}
\PYG{c+c1}{//                    \PYGZob{}}
\PYG{c+c1}{//                        curlen += dist(u, pt[idx]);}
\PYG{c+c1}{//                        explen += dist(v, pt[idx]);}
\PYG{c+c1}{//                    \PYGZcb{}}
\PYG{c+c1}{//                    if(curlen \PYGZgt{} explen)}
\PYG{c+c1}{//                    \PYGZob{}}
\PYG{c+c1}{//                        u = v;}
\PYG{c+c1}{//                        minlen = explen;}
\PYG{c+c1}{//                        flag = 1;}
\PYG{c+c1}{//                    \PYGZcb{}}
\PYG{c+c1}{//                \PYGZcb{}}
\PYG{c+c1}{//    \PYGZcb{}}
\PYG{c+c1}{//    ptres = u;}
\PYG{c+c1}{//    return flag ? minlen : curlen;}
\PYG{c+c1}{//\PYGZcb{}}
\PYG{c+c1}{//多边形费马点}
\PYG{c+c1}{//到所有顶点的距离和最小}
\PYG{n}{Point} \PYG{n}{Fermat}\PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{np}\PYG{p}{,} \PYG{n}{Point}\PYG{o}{*} \PYG{n}{p}\PYG{p}{)\PYGZob{}}
    \PYG{k+kt}{double} \PYG{n}{nowx} \PYG{o}{=} \PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{nowy} \PYG{o}{=} \PYG{l+m+mi}{0}\PYG{p}{;}
    \PYG{k+kt}{double} \PYG{n}{nextx} \PYG{o}{=} \PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{nexty} \PYG{o}{=} \PYG{l+m+mi}{0}\PYG{p}{;}
    \PYG{c+c1}{//REP(i, np)}
    \PYG{k}{for}\PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{i}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{;}\PYG{n}{i}\PYG{o}{\PYGZlt{}=}\PYG{n}{np}\PYG{p}{;}\PYG{n}{i}\PYG{o}{++}\PYG{p}{)}
    \PYG{p}{\PYGZob{}}
        \PYG{n}{nowx} \PYG{o}{+=} \PYG{n}{p}\PYG{p}{[}\PYG{n}{i}\PYG{p}{].}\PYG{n}{x}\PYG{p}{;}
        \PYG{n}{nowy} \PYG{o}{+=} \PYG{n}{p}\PYG{p}{[}\PYG{n}{i}\PYG{p}{].}\PYG{n}{y}\PYG{p}{;}
    \PYG{p}{\PYGZcb{}}
    \PYG{k}{for} \PYG{p}{(}\PYG{n}{nowx} \PYG{o}{/=} \PYG{n}{np}\PYG{p}{,} \PYG{n}{nowy} \PYG{o}{/=} \PYG{n}{np}\PYG{p}{;;} \PYG{n}{nowx} \PYG{o}{=} \PYG{n}{nextx}\PYG{p}{,} \PYG{n}{nowy} \PYG{o}{=} \PYG{n}{nexty}\PYG{p}{)}
    \PYG{p}{\PYGZob{}}
        \PYG{k+kt}{double} \PYG{n}{topx} \PYG{o}{=} \PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{topy} \PYG{o}{=} \PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{bot} \PYG{o}{=} \PYG{l+m+mi}{0}\PYG{p}{;}
        \PYG{c+c1}{//REP(i, np)}
        \PYG{k}{for}\PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{i}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{;}\PYG{n}{i}\PYG{o}{\PYGZlt{}=}\PYG{n}{np}\PYG{p}{;}\PYG{n}{i}\PYG{o}{++}\PYG{p}{)}
        \PYG{p}{\PYGZob{}}
            \PYG{k+kt}{double} \PYG{n}{d} \PYG{o}{=} \PYG{n}{sqrt}\PYG{p}{(}\PYG{n}{sqrt}\PYG{p}{(}\PYG{n}{nowx} \PYG{o}{\PYGZhy{}} \PYG{n}{p}\PYG{p}{[}\PYG{n}{i}\PYG{p}{].}\PYG{n}{x}\PYG{p}{)} \PYG{o}{+} \PYG{n}{sqrt}\PYG{p}{(}\PYG{n}{nowy} \PYG{o}{\PYGZhy{}} \PYG{n}{p}\PYG{p}{[}\PYG{n}{i}\PYG{p}{].}\PYG{n}{y}\PYG{p}{));}
            \PYG{n}{topx} \PYG{o}{+=} \PYG{n}{p}\PYG{p}{[}\PYG{n}{i}\PYG{p}{].}\PYG{n}{x} \PYG{o}{/} \PYG{n}{d}\PYG{p}{;}
            \PYG{n}{topy} \PYG{o}{+=} \PYG{n}{p}\PYG{p}{[}\PYG{n}{i}\PYG{p}{].}\PYG{n}{y} \PYG{o}{/} \PYG{n}{d}\PYG{p}{;}
            \PYG{n}{bot} \PYG{o}{+=} \PYG{l+m+mi}{1} \PYG{o}{/} \PYG{n}{d}\PYG{p}{;}
        \PYG{p}{\PYGZcb{}}
        \PYG{n}{nextx} \PYG{o}{=} \PYG{n}{topx} \PYG{o}{/} \PYG{n}{bot}\PYG{p}{;}
        \PYG{n}{nexty} \PYG{o}{=} \PYG{n}{topy} \PYG{o}{/} \PYG{n}{bot}\PYG{p}{;}
        \PYG{k}{if} \PYG{p}{(}\PYG{n}{dcmp}\PYG{p}{(}\PYG{n}{nextx} \PYG{o}{\PYGZhy{}} \PYG{n}{nowx}\PYG{p}{)} \PYG{o}{==} \PYG{l+m+mi}{0} \PYG{o}{\PYGZam{}\PYGZam{}} \PYG{n}{dcmp}\PYG{p}{(}\PYG{n}{nexty} \PYG{o}{\PYGZhy{}} \PYG{n}{nowy}\PYG{p}{)} \PYG{o}{==} \PYG{l+m+mi}{0}\PYG{p}{)}
            \PYG{k}{break}\PYG{p}{;}
    \PYG{p}{\PYGZcb{}}
    \PYG{n}{Point} \PYG{n}{fp}\PYG{p}{;}
    \PYG{n}{fp}\PYG{p}{.}\PYG{n}{x} \PYG{o}{=} \PYG{n}{nowx}\PYG{p}{;}
    \PYG{n}{fp}\PYG{p}{.}\PYG{n}{y} \PYG{o}{=} \PYG{n}{nowy}\PYG{p}{;}
    \PYG{k}{return} \PYG{n}{fp}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{c+c1}{//最近点对}
\PYG{c+c1}{//使用前先对输入的point进行排序,使用cmpxy函数}
\PYG{n}{Point} \PYG{n}{point}\PYG{p}{[}\PYG{n}{N}\PYG{p}{];}
\PYG{k+kt}{int} \PYG{n}{tmpt}\PYG{p}{[}\PYG{n}{N}\PYG{p}{];}
\PYG{k+kr}{inline} \PYG{k+kt}{double} \PYG{n+nf}{dist}\PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{x}\PYG{p}{,} \PYG{k+kt}{int} \PYG{n}{y}\PYG{p}{)\PYGZob{}}
    \PYG{n}{Point}\PYG{o}{\PYGZam{}} \PYG{n}{a} \PYG{o}{=} \PYG{n}{point}\PYG{p}{[}\PYG{n}{x}\PYG{p}{];}
    \PYG{n}{Point}\PYG{o}{\PYGZam{}} \PYG{n}{b} \PYG{o}{=} \PYG{n}{point}\PYG{p}{[}\PYG{n}{y}\PYG{p}{];}
    \PYG{k}{return} \PYG{n}{sqrt}\PYG{p}{(}\PYG{n}{sqrt}\PYG{p}{(}\PYG{n}{a}\PYG{p}{.}\PYG{n}{x} \PYG{o}{\PYGZhy{}} \PYG{n}{b}\PYG{p}{.}\PYG{n}{x}\PYG{p}{)} \PYG{o}{+} \PYG{n}{sqrt}\PYG{p}{(}\PYG{n}{a}\PYG{p}{.}\PYG{n}{y} \PYG{o}{\PYGZhy{}} \PYG{n}{b}\PYG{p}{.}\PYG{n}{y}\PYG{p}{));}
\PYG{p}{\PYGZcb{}}
\PYG{k+kr}{inline} \PYG{k+kt}{bool} \PYG{n+nf}{cmpxy}\PYG{p}{(}\PYG{n}{Point} \PYG{n}{a}\PYG{p}{,} \PYG{n}{Point} \PYG{n}{b}\PYG{p}{)\PYGZob{}}
    \PYG{k}{if}\PYG{p}{(}\PYG{n}{a}\PYG{p}{.}\PYG{n}{x} \PYG{o}{!=} \PYG{n}{b}\PYG{p}{.}\PYG{n}{x}\PYG{p}{)}
        \PYG{k}{return} \PYG{n}{a}\PYG{p}{.}\PYG{n}{x} \PYG{o}{\PYGZlt{}} \PYG{n}{b}\PYG{p}{.}\PYG{n}{x}\PYG{p}{;}
    \PYG{k}{return} \PYG{n}{a}\PYG{p}{.}\PYG{n}{y} \PYG{o}{\PYGZlt{}} \PYG{n}{b}\PYG{p}{.}\PYG{n}{y}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{k+kr}{inline} \PYG{k+kt}{bool} \PYG{n+nf}{cmpy}\PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{a}\PYG{p}{,} \PYG{k+kt}{int} \PYG{n}{b}\PYG{p}{)\PYGZob{}}
    \PYG{k}{return} \PYG{n}{point}\PYG{p}{[}\PYG{n}{a}\PYG{p}{].}\PYG{n}{y} \PYG{o}{\PYGZlt{}} \PYG{n}{point}\PYG{p}{[}\PYG{n}{b}\PYG{p}{].}\PYG{n}{y}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{k+kt}{double} \PYG{n+nf}{Closest\PYGZus{}Pair}\PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{left}\PYG{p}{,} \PYG{k+kt}{int} \PYG{n}{right}\PYG{p}{)\PYGZob{}}
    \PYG{k+kt}{double} \PYG{n}{d} \PYG{o}{=} \PYG{n}{INF}\PYG{p}{;}
    \PYG{k}{if}\PYG{p}{(}\PYG{n}{left}\PYG{o}{==}\PYG{n}{right}\PYG{p}{)}
        \PYG{k}{return} \PYG{n}{d}\PYG{p}{;}
    \PYG{k}{if}\PYG{p}{(}\PYG{n}{left} \PYG{o}{+} \PYG{l+m+mi}{1} \PYG{o}{==} \PYG{n}{right}\PYG{p}{)}
        \PYG{k}{return} \PYG{n}{dist}\PYG{p}{(}\PYG{n}{left}\PYG{p}{,} \PYG{n}{right}\PYG{p}{);}
    \PYG{k+kt}{int} \PYG{n}{mid} \PYG{o}{=} \PYG{p}{(}\PYG{n}{left}\PYG{o}{+}\PYG{n}{right}\PYG{p}{)}\PYG{o}{\PYGZgt{}\PYGZgt{}}\PYG{l+m+mi}{1}\PYG{p}{;}
    \PYG{k+kt}{double} \PYG{n}{d1} \PYG{o}{=} \PYG{n}{Closest\PYGZus{}Pair}\PYG{p}{(}\PYG{n}{left}\PYG{p}{,}\PYG{n}{mid}\PYG{p}{);}
    \PYG{k+kt}{double} \PYG{n}{d2} \PYG{o}{=} \PYG{n}{Closest\PYGZus{}Pair}\PYG{p}{(}\PYG{n}{mid}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{right}\PYG{p}{);}
    \PYG{n}{d} \PYG{o}{=} \PYG{n}{min}\PYG{p}{(}\PYG{n}{d1}\PYG{p}{,}\PYG{n}{d2}\PYG{p}{);}
    \PYG{k+kt}{int} \PYG{n}{k}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{;}
    \PYG{c+c1}{//分离出宽度为d的区间}
    \PYG{c+c1}{//FE(i, left, right)}
    \PYG{k}{for}\PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{i}\PYG{o}{=}\PYG{n}{left}\PYG{p}{;}\PYG{n}{i}\PYG{o}{\PYGZlt{}=}\PYG{n}{right}\PYG{p}{;}\PYG{n}{i}\PYG{o}{++}\PYG{p}{)\PYGZob{}}
        \PYG{k}{if}\PYG{p}{(}\PYG{n}{fabs}\PYG{p}{(}\PYG{n}{point}\PYG{p}{[}\PYG{n}{mid}\PYG{p}{].}\PYG{n}{x}\PYG{o}{\PYGZhy{}}\PYG{n}{point}\PYG{p}{[}\PYG{n}{i}\PYG{p}{].}\PYG{n}{x}\PYG{p}{)} \PYG{o}{\PYGZlt{}=} \PYG{n}{d}\PYG{p}{)}
            \PYG{n}{tmpt}\PYG{p}{[}\PYG{n}{k}\PYG{o}{++}\PYG{p}{]} \PYG{o}{=} \PYG{n}{i}\PYG{p}{;}
    \PYG{p}{\PYGZcb{}}
    \PYG{n}{sort}\PYG{p}{(}\PYG{n}{tmpt}\PYG{p}{,}\PYG{n}{tmpt}\PYG{o}{+}\PYG{n}{k}\PYG{p}{,}\PYG{n}{cmpy}\PYG{p}{);}
    \PYG{c+c1}{//线性扫描}
    \PYG{c+c1}{//REP(i, k)}
    \PYG{k}{for}\PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{i}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{n}{i}\PYG{o}{\PYGZlt{}}\PYG{n}{k}\PYG{p}{;}\PYG{n}{i}\PYG{o}{++}\PYG{p}{)\PYGZob{}}
        \PYG{k}{for}\PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{j} \PYG{o}{=} \PYG{n}{i}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{;} \PYG{n}{j} \PYG{o}{\PYGZlt{}} \PYG{n}{k} \PYG{o}{\PYGZam{}\PYGZam{}} \PYG{n}{point}\PYG{p}{[}\PYG{n}{tmpt}\PYG{p}{[}\PYG{n}{j}\PYG{p}{]].}\PYG{n}{y}\PYG{o}{\PYGZhy{}}\PYG{n}{point}\PYG{p}{[}\PYG{n}{tmpt}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]].}\PYG{n}{y}\PYG{o}{\PYGZlt{}}\PYG{n}{d}\PYG{p}{;} \PYG{n}{j}\PYG{o}{++}\PYG{p}{)\PYGZob{}}
            \PYG{k+kt}{double} \PYG{n}{d3} \PYG{o}{=} \PYG{n}{dist}\PYG{p}{(}\PYG{n}{tmpt}\PYG{p}{[}\PYG{n}{i}\PYG{p}{],}\PYG{n}{tmpt}\PYG{p}{[}\PYG{n}{j}\PYG{p}{]);}
            \PYG{k}{if}\PYG{p}{(}\PYG{n}{d} \PYG{o}{\PYGZgt{}} \PYG{n}{d3}\PYG{p}{)}
                \PYG{n}{d} \PYG{o}{=} \PYG{n}{d3}\PYG{p}{;}
        \PYG{p}{\PYGZcb{}}
    \PYG{p}{\PYGZcb{}}
    \PYG{k}{return} \PYG{n}{d}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{c+cm}{/************圆************/}
\PYG{k}{struct} \PYG{n}{Circle}\PYG{p}{\PYGZob{}}
    \PYG{n}{Point} \PYG{n}{c}\PYG{p}{;}
    \PYG{k+kt}{double} \PYG{n}{r}\PYG{p}{;}
    \PYG{n}{Circle}\PYG{p}{()} \PYG{p}{\PYGZob{}\PYGZcb{}}
    \PYG{n}{Circle}\PYG{p}{(}\PYG{n}{Point} \PYG{n}{c}\PYG{p}{,} \PYG{k+kt}{double} \PYG{n}{r}\PYG{p}{)}\PYG{o}{:}\PYG{n}{c}\PYG{p}{(}\PYG{n}{c}\PYG{p}{),} \PYG{n}{r}\PYG{p}{(}\PYG{n}{r}\PYG{p}{)} \PYG{p}{\PYGZob{}\PYGZcb{}}
    \PYG{k+kr}{inline} \PYG{n}{Point} \PYG{n}{point}\PYG{p}{(}\PYG{k+kt}{double} \PYG{n}{a}\PYG{p}{)} \PYG{p}{\PYGZob{}}\PYG{c+c1}{//根据圆心角求点坐标}
        \PYG{k}{return} \PYG{n}{Point}\PYG{p}{(}\PYG{n}{c}\PYG{p}{.}\PYG{n}{x}\PYG{o}{+}\PYG{n}{cos}\PYG{p}{(}\PYG{n}{a}\PYG{p}{)}\PYG{o}{*}\PYG{n}{r}\PYG{p}{,} \PYG{n}{c}\PYG{p}{.}\PYG{n}{y}\PYG{o}{+}\PYG{n}{sin}\PYG{p}{(}\PYG{n}{a}\PYG{p}{)}\PYG{o}{*}\PYG{n}{r}\PYG{p}{);}
    \PYG{p}{\PYGZcb{}}
    \PYG{k+kr}{inline} \PYG{k+kt}{void} \PYG{n}{read}\PYG{p}{()\PYGZob{}}
        \PYG{n}{scanf}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}\PYGZpc{}lf\PYGZpc{}lf\PYGZpc{}lf\PYGZdq{}}\PYG{p}{,} \PYG{o}{\PYGZam{}}\PYG{n}{c}\PYG{p}{.}\PYG{n}{x}\PYG{p}{,} \PYG{o}{\PYGZam{}}\PYG{n}{c}\PYG{p}{.}\PYG{n}{y}\PYG{p}{,} \PYG{o}{\PYGZam{}}\PYG{n}{r}\PYG{p}{);}
    \PYG{p}{\PYGZcb{}}
\PYG{p}{\PYGZcb{};}

\PYG{c+c1}{//求a点到b点(逆时针)在的圆上的圆弧长度}
\PYG{k+kt}{double} \PYG{n+nf}{DisOnCircle}\PYG{p}{(}\PYG{n}{Point} \PYG{n}{a}\PYG{p}{,} \PYG{n}{Point} \PYG{n}{b}\PYG{p}{,} \PYG{n}{Circle} \PYG{n}{C}\PYG{p}{)\PYGZob{}}
    \PYG{k+kt}{double} \PYG{n}{ang1} \PYG{o}{=} \PYG{n}{angle}\PYG{p}{(}\PYG{n}{a} \PYG{o}{\PYGZhy{}} \PYG{n}{C}\PYG{p}{.}\PYG{n}{c}\PYG{p}{);}
    \PYG{k+kt}{double} \PYG{n}{ang2} \PYG{o}{=} \PYG{n}{angle}\PYG{p}{(}\PYG{n}{b} \PYG{o}{\PYGZhy{}} \PYG{n}{C}\PYG{p}{.}\PYG{n}{c}\PYG{p}{);}
    \PYG{k}{if} \PYG{p}{(}\PYG{n}{ang2} \PYG{o}{\PYGZlt{}} \PYG{n}{ang1}\PYG{p}{)} \PYG{n}{ang2} \PYG{o}{+=} \PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{PI}\PYG{p}{;}
    \PYG{k}{return} \PYG{n}{C}\PYG{p}{.}\PYG{n}{r} \PYG{o}{*} \PYG{p}{(}\PYG{n}{ang2} \PYG{o}{\PYGZhy{}} \PYG{n}{ang1}\PYG{p}{);}
\PYG{p}{\PYGZcb{}}

\PYG{c+c1}{//直线与圆交点 返回个数}
\PYG{k+kt}{int} \PYG{n+nf}{getLineCircleIntersection}\PYG{p}{(}\PYG{n}{Line} \PYG{n}{L}\PYG{p}{,} \PYG{n}{Circle} \PYG{n}{C}\PYG{p}{,} \PYG{k+kt}{double}\PYG{o}{\PYGZam{}} \PYG{n}{t1}\PYG{p}{,} \PYG{k+kt}{double}\PYG{o}{\PYGZam{}} \PYG{n}{t2}\PYG{p}{,} \PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{Point}\PYG{o}{\PYGZgt{}\PYGZam{}} \PYG{n}{sol}\PYG{p}{)\PYGZob{}}
    \PYG{k+kt}{double} \PYG{n}{a} \PYG{o}{=} \PYG{n}{L}\PYG{p}{.}\PYG{n}{v}\PYG{p}{.}\PYG{n}{x}\PYG{p}{,} \PYG{n}{b} \PYG{o}{=} \PYG{n}{L}\PYG{p}{.}\PYG{n}{p}\PYG{p}{.}\PYG{n}{x} \PYG{o}{\PYGZhy{}} \PYG{n}{C}\PYG{p}{.}\PYG{n}{c}\PYG{p}{.}\PYG{n}{x}\PYG{p}{,} \PYG{n}{c} \PYG{o}{=} \PYG{n}{L}\PYG{p}{.}\PYG{n}{v}\PYG{p}{.}\PYG{n}{y}\PYG{p}{,} \PYG{n}{d} \PYG{o}{=} \PYG{n}{L}\PYG{p}{.}\PYG{n}{p}\PYG{p}{.}\PYG{n}{y} \PYG{o}{\PYGZhy{}} \PYG{n}{C}\PYG{p}{.}\PYG{n}{c}\PYG{p}{.}\PYG{n}{y}\PYG{p}{;}
    \PYG{k+kt}{double} \PYG{n}{e} \PYG{o}{=} \PYG{n}{a}\PYG{o}{*}\PYG{n}{a} \PYG{o}{+} \PYG{n}{c}\PYG{o}{*}\PYG{n}{c}\PYG{p}{,} \PYG{n}{f} \PYG{o}{=} \PYG{l+m+mi}{2}\PYG{o}{*}\PYG{p}{(}\PYG{n}{a}\PYG{o}{*}\PYG{n}{b} \PYG{o}{+} \PYG{n}{c}\PYG{o}{*}\PYG{n}{d}\PYG{p}{),} \PYG{n}{g} \PYG{o}{=} \PYG{n}{b}\PYG{o}{*}\PYG{n}{b} \PYG{o}{+} \PYG{n}{d}\PYG{o}{*}\PYG{n}{d} \PYG{o}{\PYGZhy{}} \PYG{n}{C}\PYG{p}{.}\PYG{n}{r}\PYG{o}{*}\PYG{n}{C}\PYG{p}{.}\PYG{n}{r}\PYG{p}{;}
    \PYG{k+kt}{double} \PYG{n}{delta} \PYG{o}{=} \PYG{n}{f}\PYG{o}{*}\PYG{n}{f} \PYG{o}{\PYGZhy{}} \PYG{l+m+mi}{4}\PYG{o}{*}\PYG{n}{e}\PYG{o}{*}\PYG{n}{g}\PYG{p}{;} \PYG{c+c1}{// 判别式}
    \PYG{k}{if}\PYG{p}{(}\PYG{n}{dcmp}\PYG{p}{(}\PYG{n}{delta}\PYG{p}{)} \PYG{o}{\PYGZlt{}} \PYG{l+m+mi}{0}\PYG{p}{)} \PYG{k}{return} \PYG{l+m+mi}{0}\PYG{p}{;} \PYG{c+c1}{// 相离}
    \PYG{k}{if}\PYG{p}{(}\PYG{n}{dcmp}\PYG{p}{(}\PYG{n}{delta}\PYG{p}{)} \PYG{o}{==} \PYG{l+m+mi}{0}\PYG{p}{)\PYGZob{}}
        \PYG{c+c1}{// 相切}
        \PYG{n}{t1} \PYG{o}{=} \PYG{n}{t2} \PYG{o}{=} \PYG{o}{\PYGZhy{}}\PYG{n}{f} \PYG{o}{/} \PYG{p}{(}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{e}\PYG{p}{);}
        \PYG{n}{sol}\PYG{p}{.}\PYG{n}{push\PYGZus{}back}\PYG{p}{(}\PYG{n}{L}\PYG{p}{.}\PYG{n}{point}\PYG{p}{(}\PYG{n}{t1}\PYG{p}{));}
        \PYG{k}{return} \PYG{l+m+mi}{1}\PYG{p}{;}
    \PYG{p}{\PYGZcb{}}
    \PYG{c+c1}{// 相交}
    \PYG{n}{t1} \PYG{o}{=} \PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n}{f} \PYG{o}{\PYGZhy{}} \PYG{n}{sqrt}\PYG{p}{(}\PYG{n}{delta}\PYG{p}{))} \PYG{o}{/} \PYG{p}{(}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{e}\PYG{p}{);}
    \PYG{n}{sol}\PYG{p}{.}\PYG{n}{push\PYGZus{}back}\PYG{p}{(}\PYG{n}{L}\PYG{p}{.}\PYG{n}{point}\PYG{p}{(}\PYG{n}{t1}\PYG{p}{));}
    \PYG{n}{t2} \PYG{o}{=} \PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n}{f} \PYG{o}{+} \PYG{n}{sqrt}\PYG{p}{(}\PYG{n}{delta}\PYG{p}{))} \PYG{o}{/} \PYG{p}{(}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{e}\PYG{p}{);}
    \PYG{n}{sol}\PYG{p}{.}\PYG{n}{push\PYGZus{}back}\PYG{p}{(}\PYG{n}{L}\PYG{p}{.}\PYG{n}{point}\PYG{p}{(}\PYG{n}{t2}\PYG{p}{));}
    \PYG{k}{return} \PYG{l+m+mi}{2}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{c+c1}{//两圆交点 返回个数}
\PYG{k+kt}{int} \PYG{n+nf}{getCircleCircleIntersection}\PYG{p}{(}\PYG{n}{Circle} \PYG{n}{C1}\PYG{p}{,} \PYG{n}{Circle} \PYG{n}{C2}\PYG{p}{,} \PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{Point}\PYG{o}{\PYGZgt{}\PYGZam{}} \PYG{n}{sol}\PYG{p}{)\PYGZob{}}
    \PYG{k+kt}{double} \PYG{n}{d} \PYG{o}{=} \PYG{n}{Length}\PYG{p}{(}\PYG{n}{C1}\PYG{p}{.}\PYG{n}{c} \PYG{o}{\PYGZhy{}} \PYG{n}{C2}\PYG{p}{.}\PYG{n}{c}\PYG{p}{);}
    \PYG{k}{if}\PYG{p}{(}\PYG{n}{dcmp}\PYG{p}{(}\PYG{n}{d}\PYG{p}{)} \PYG{o}{==} \PYG{l+m+mi}{0}\PYG{p}{)\PYGZob{}}
        \PYG{k}{if}\PYG{p}{(}\PYG{n}{dcmp}\PYG{p}{(}\PYG{n}{C1}\PYG{p}{.}\PYG{n}{r} \PYG{o}{\PYGZhy{}} \PYG{n}{C2}\PYG{p}{.}\PYG{n}{r}\PYG{p}{)} \PYG{o}{==} \PYG{l+m+mi}{0}\PYG{p}{)} \PYG{k}{return} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{;} \PYG{c+c1}{// 重合，无穷多交点}
        \PYG{k}{return} \PYG{l+m+mi}{0}\PYG{p}{;}
    \PYG{p}{\PYGZcb{}}
    \PYG{k}{if}\PYG{p}{(}\PYG{n}{dcmp}\PYG{p}{(}\PYG{n}{C1}\PYG{p}{.}\PYG{n}{r} \PYG{o}{+} \PYG{n}{C2}\PYG{p}{.}\PYG{n}{r} \PYG{o}{\PYGZhy{}} \PYG{n}{d}\PYG{p}{)} \PYG{o}{\PYGZlt{}} \PYG{l+m+mi}{0}\PYG{p}{)} \PYG{k}{return} \PYG{l+m+mi}{0}\PYG{p}{;}
    \PYG{k}{if}\PYG{p}{(}\PYG{n}{dcmp}\PYG{p}{(}\PYG{n}{fabs}\PYG{p}{(}\PYG{n}{C1}\PYG{p}{.}\PYG{n}{r}\PYG{o}{\PYGZhy{}}\PYG{n}{C2}\PYG{p}{.}\PYG{n}{r}\PYG{p}{)} \PYG{o}{\PYGZhy{}} \PYG{n}{d}\PYG{p}{)} \PYG{o}{\PYGZgt{}} \PYG{l+m+mi}{0}\PYG{p}{)} \PYG{k}{return} \PYG{l+m+mi}{0}\PYG{p}{;}
    \PYG{k+kt}{double} \PYG{n}{a} \PYG{o}{=} \PYG{n}{angle}\PYG{p}{(}\PYG{n}{C2}\PYG{p}{.}\PYG{n}{c} \PYG{o}{\PYGZhy{}} \PYG{n}{C1}\PYG{p}{.}\PYG{n}{c}\PYG{p}{);}
    \PYG{k+kt}{double} \PYG{n}{da} \PYG{o}{=} \PYG{n}{acos}\PYG{p}{((}\PYG{n}{C1}\PYG{p}{.}\PYG{n}{r}\PYG{o}{*}\PYG{n}{C1}\PYG{p}{.}\PYG{n}{r} \PYG{o}{+} \PYG{n}{d}\PYG{o}{*}\PYG{n}{d} \PYG{o}{\PYGZhy{}} \PYG{n}{C2}\PYG{p}{.}\PYG{n}{r}\PYG{o}{*}\PYG{n}{C2}\PYG{p}{.}\PYG{n}{r}\PYG{p}{)} \PYG{o}{/} \PYG{p}{(}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{C1}\PYG{p}{.}\PYG{n}{r}\PYG{o}{*}\PYG{n}{d}\PYG{p}{));}
    \PYG{n}{Point} \PYG{n}{p1} \PYG{o}{=} \PYG{n}{C1}\PYG{p}{.}\PYG{n}{point}\PYG{p}{(}\PYG{n}{a}\PYG{o}{\PYGZhy{}}\PYG{n}{da}\PYG{p}{),} \PYG{n}{p2} \PYG{o}{=} \PYG{n}{C1}\PYG{p}{.}\PYG{n}{point}\PYG{p}{(}\PYG{n}{a}\PYG{o}{+}\PYG{n}{da}\PYG{p}{);}
    \PYG{n}{sol}\PYG{p}{.}\PYG{n}{push\PYGZus{}back}\PYG{p}{(}\PYG{n}{p1}\PYG{p}{);}
    \PYG{k}{if}\PYG{p}{(}\PYG{n}{p1} \PYG{o}{==} \PYG{n}{p2}\PYG{p}{)} \PYG{k}{return} \PYG{l+m+mi}{1}\PYG{p}{;}
    \PYG{n}{sol}\PYG{p}{.}\PYG{n}{push\PYGZus{}back}\PYG{p}{(}\PYG{n}{p2}\PYG{p}{);}
    \PYG{k}{return} \PYG{l+m+mi}{2}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{c+c1}{// 过点p到圆C的切线。v[i]是第i条切线的向量。返回切线条数}
\PYG{k+kt}{int} \PYG{n+nf}{getTangents}\PYG{p}{(}\PYG{n}{Point} \PYG{n}{p}\PYG{p}{,} \PYG{n}{Circle} \PYG{n}{C}\PYG{p}{,} \PYG{n}{Vector}\PYG{o}{*} \PYG{n}{v}\PYG{p}{)\PYGZob{}}
    \PYG{n}{Vector} \PYG{n}{u} \PYG{o}{=} \PYG{n}{C}\PYG{p}{.}\PYG{n}{c} \PYG{o}{\PYGZhy{}} \PYG{n}{p}\PYG{p}{;}
    \PYG{k+kt}{double} \PYG{n}{dist} \PYG{o}{=} \PYG{n}{Length}\PYG{p}{(}\PYG{n}{u}\PYG{p}{);}
    \PYG{k}{if}\PYG{p}{(}\PYG{n}{dist} \PYG{o}{\PYGZlt{}} \PYG{n}{C}\PYG{p}{.}\PYG{n}{r}\PYG{p}{)} \PYG{k}{return} \PYG{l+m+mi}{0}\PYG{p}{;}
    \PYG{k}{else} \PYG{k}{if}\PYG{p}{(}\PYG{n}{dcmp}\PYG{p}{(}\PYG{n}{dist} \PYG{o}{\PYGZhy{}} \PYG{n}{C}\PYG{p}{.}\PYG{n}{r}\PYG{p}{)} \PYG{o}{==} \PYG{l+m+mi}{0}\PYG{p}{)\PYGZob{}} \PYG{c+c1}{// p在圆上，只有一条切线}
        \PYG{n}{v}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]} \PYG{o}{=} \PYG{n}{Rotate}\PYG{p}{(}\PYG{n}{u}\PYG{p}{,} \PYG{n}{PI}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{);}
        \PYG{k}{return} \PYG{l+m+mi}{1}\PYG{p}{;}
    \PYG{p}{\PYGZcb{}}\PYG{k}{else}\PYG{p}{\PYGZob{}}
        \PYG{k+kt}{double} \PYG{n}{ang} \PYG{o}{=} \PYG{n}{asin}\PYG{p}{(}\PYG{n}{C}\PYG{p}{.}\PYG{n}{r} \PYG{o}{/} \PYG{n}{dist}\PYG{p}{);}
        \PYG{n}{v}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]} \PYG{o}{=} \PYG{n}{Rotate}\PYG{p}{(}\PYG{n}{u}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{n}{ang}\PYG{p}{);}
        \PYG{n}{v}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]} \PYG{o}{=} \PYG{n}{Rotate}\PYG{p}{(}\PYG{n}{u}\PYG{p}{,} \PYG{o}{+}\PYG{n}{ang}\PYG{p}{);}
        \PYG{k}{return} \PYG{l+m+mi}{2}\PYG{p}{;}
    \PYG{p}{\PYGZcb{}}
\PYG{p}{\PYGZcb{}}
\PYG{c+c1}{//两圆的公切线, \PYGZhy{}1表示无穷条切线}
\PYG{c+c1}{//返回切线的条数, \PYGZhy{}1表示无穷条切线}
\PYG{c+c1}{//a[i]和b[i]分别是第i条切线在圆A和圆B上的切点}
\PYG{k+kt}{int} \PYG{n+nf}{getTangents}\PYG{p}{(}\PYG{n}{Circle} \PYG{n}{A}\PYG{p}{,} \PYG{n}{Circle} \PYG{n}{B}\PYG{p}{,} \PYG{n}{Point}\PYG{o}{*} \PYG{n}{a}\PYG{p}{,} \PYG{n}{Point}\PYG{o}{*} \PYG{n}{b}\PYG{p}{)\PYGZob{}}
    \PYG{k+kt}{int} \PYG{n}{cnt} \PYG{o}{=} \PYG{l+m+mi}{0}\PYG{p}{;}
    \PYG{k}{if} \PYG{p}{(}\PYG{n}{A}\PYG{p}{.}\PYG{n}{r} \PYG{o}{\PYGZlt{}} \PYG{n}{B}\PYG{p}{.}\PYG{n}{r}\PYG{p}{)} \PYG{n}{swap}\PYG{p}{(}\PYG{n}{A}\PYG{p}{,} \PYG{n}{B}\PYG{p}{),} \PYG{n}{swap}\PYG{p}{(}\PYG{n}{a}\PYG{p}{,} \PYG{n}{b}\PYG{p}{);}
    \PYG{k+kt}{int} \PYG{n}{d2} \PYG{o}{=} \PYG{p}{(}\PYG{n}{A}\PYG{p}{.}\PYG{n}{c}\PYG{p}{.}\PYG{n}{x} \PYG{o}{\PYGZhy{}} \PYG{n}{B}\PYG{p}{.}\PYG{n}{c}\PYG{p}{.}\PYG{n}{x}\PYG{p}{)} \PYG{o}{*} \PYG{p}{(}\PYG{n}{A}\PYG{p}{.}\PYG{n}{c}\PYG{p}{.}\PYG{n}{x} \PYG{o}{\PYGZhy{}} \PYG{n}{B}\PYG{p}{.}\PYG{n}{c}\PYG{p}{.}\PYG{n}{x}\PYG{p}{)} \PYG{o}{+} \PYG{p}{(}\PYG{n}{A}\PYG{p}{.}\PYG{n}{c}\PYG{p}{.}\PYG{n}{y} \PYG{o}{\PYGZhy{}} \PYG{n}{B}\PYG{p}{.}\PYG{n}{c}\PYG{p}{.}\PYG{n}{y}\PYG{p}{)} \PYG{o}{*} \PYG{p}{(}\PYG{n}{A}\PYG{p}{.}\PYG{n}{c}\PYG{p}{.}\PYG{n}{y} \PYG{o}{\PYGZhy{}} \PYG{n}{B}\PYG{p}{.}\PYG{n}{c}\PYG{p}{.}\PYG{n}{y}\PYG{p}{);}
    \PYG{k+kt}{int} \PYG{n}{rdiff} \PYG{o}{=} \PYG{n}{A}\PYG{p}{.}\PYG{n}{r} \PYG{o}{\PYGZhy{}} \PYG{n}{B}\PYG{p}{.}\PYG{n}{r}\PYG{p}{;}
    \PYG{k+kt}{int} \PYG{n}{rsum} \PYG{o}{=} \PYG{n}{A}\PYG{p}{.}\PYG{n}{r} \PYG{o}{+} \PYG{n}{B}\PYG{p}{.}\PYG{n}{r}\PYG{p}{;}
    \PYG{k}{if} \PYG{p}{(}\PYG{n}{d2} \PYG{o}{\PYGZlt{}} \PYG{n}{rdiff} \PYG{o}{*} \PYG{n}{rdiff}\PYG{p}{)} \PYG{k}{return} \PYG{l+m+mi}{0}\PYG{p}{;}   \PYG{c+c1}{//内含}
    \PYG{k+kt}{double} \PYG{n}{base} \PYG{o}{=} \PYG{n}{atan2}\PYG{p}{(}\PYG{n}{B}\PYG{p}{.}\PYG{n}{c}\PYG{p}{.}\PYG{n}{y} \PYG{o}{\PYGZhy{}} \PYG{n}{A}\PYG{p}{.}\PYG{n}{c}\PYG{p}{.}\PYG{n}{y}\PYG{p}{,} \PYG{n}{B}\PYG{p}{.}\PYG{n}{c}\PYG{p}{.}\PYG{n}{x} \PYG{o}{\PYGZhy{}} \PYG{n}{A}\PYG{p}{.}\PYG{n}{c}\PYG{p}{.}\PYG{n}{x}\PYG{p}{);}
    \PYG{k}{if} \PYG{p}{(}\PYG{n}{d2} \PYG{o}{==} \PYG{l+m+mi}{0} \PYG{o}{\PYGZam{}\PYGZam{}} \PYG{n}{A}\PYG{p}{.}\PYG{n}{r} \PYG{o}{==} \PYG{n}{B}\PYG{p}{.}\PYG{n}{r}\PYG{p}{)} \PYG{k}{return} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{;}    \PYG{c+c1}{//无线多条切线}
    \PYG{k}{if} \PYG{p}{(}\PYG{n}{d2} \PYG{o}{==} \PYG{n}{rdiff} \PYG{o}{*} \PYG{n}{rdiff}\PYG{p}{)} \PYG{p}{\PYGZob{}}\PYG{c+c1}{//内切, 1条切线}
        \PYG{n}{a}\PYG{p}{[}\PYG{n}{cnt}\PYG{p}{]} \PYG{o}{=} \PYG{n}{A}\PYG{p}{.}\PYG{n}{point}\PYG{p}{(}\PYG{n}{base}\PYG{p}{);} \PYG{n}{b}\PYG{p}{[}\PYG{n}{cnt}\PYG{p}{]} \PYG{o}{=} \PYG{n}{B}\PYG{p}{.}\PYG{n}{point}\PYG{p}{(}\PYG{n}{base}\PYG{p}{);} \PYG{n}{cnt}\PYG{o}{++}\PYG{p}{;}
        \PYG{k}{return} \PYG{l+m+mi}{1}\PYG{p}{;}
    \PYG{p}{\PYGZcb{}}
    \PYG{c+c1}{//有外公切线}
    \PYG{k+kt}{double} \PYG{n}{ang} \PYG{o}{=} \PYG{n}{acos}\PYG{p}{((}\PYG{n}{A}\PYG{p}{.}\PYG{n}{r} \PYG{o}{\PYGZhy{}} \PYG{n}{B}\PYG{p}{.}\PYG{n}{r}\PYG{p}{)} \PYG{o}{/} \PYG{n}{sqrt}\PYG{p}{(}\PYG{n}{d2} \PYG{o}{*} \PYG{l+m+mf}{1.0}\PYG{p}{));}
    \PYG{n}{a}\PYG{p}{[}\PYG{n}{cnt}\PYG{p}{]} \PYG{o}{=} \PYG{n}{A}\PYG{p}{.}\PYG{n}{point}\PYG{p}{(}\PYG{n}{base} \PYG{o}{+} \PYG{n}{ang}\PYG{p}{);} \PYG{n}{b}\PYG{p}{[}\PYG{n}{cnt}\PYG{p}{]} \PYG{o}{=} \PYG{n}{B}\PYG{p}{.}\PYG{n}{point}\PYG{p}{(}\PYG{n}{base} \PYG{o}{+} \PYG{n}{ang}\PYG{p}{);} \PYG{n}{cnt}\PYG{o}{++}\PYG{p}{;}
    \PYG{n}{a}\PYG{p}{[}\PYG{n}{cnt}\PYG{p}{]} \PYG{o}{=} \PYG{n}{A}\PYG{p}{.}\PYG{n}{point}\PYG{p}{(}\PYG{n}{base} \PYG{o}{\PYGZhy{}} \PYG{n}{ang}\PYG{p}{);} \PYG{n}{b}\PYG{p}{[}\PYG{n}{cnt}\PYG{p}{]} \PYG{o}{=} \PYG{n}{B}\PYG{p}{.}\PYG{n}{point}\PYG{p}{(}\PYG{n}{base} \PYG{o}{\PYGZhy{}} \PYG{n}{ang}\PYG{p}{);} \PYG{n}{cnt}\PYG{o}{++}\PYG{p}{;}
    \PYG{k}{if} \PYG{p}{(}\PYG{n}{d2} \PYG{o}{==} \PYG{n}{rsum} \PYG{o}{*} \PYG{n}{rsum}\PYG{p}{)} \PYG{p}{\PYGZob{}}\PYG{c+c1}{//一条内公切线}
        \PYG{n}{a}\PYG{p}{[}\PYG{n}{cnt}\PYG{p}{]} \PYG{o}{=} \PYG{n}{A}\PYG{p}{.}\PYG{n}{point}\PYG{p}{(}\PYG{n}{base}\PYG{p}{);} \PYG{n}{b}\PYG{p}{[}\PYG{n}{cnt}\PYG{p}{]} \PYG{o}{=} \PYG{n}{B}\PYG{p}{.}\PYG{n}{point}\PYG{p}{(}\PYG{n}{PI} \PYG{o}{+} \PYG{n}{base}\PYG{p}{);} \PYG{n}{cnt}\PYG{o}{++}\PYG{p}{;}
    \PYG{p}{\PYGZcb{}}\PYG{k}{else} \PYG{k}{if} \PYG{p}{(}\PYG{n}{d2} \PYG{o}{\PYGZgt{}} \PYG{n}{rsum} \PYG{o}{*} \PYG{n}{rsum}\PYG{p}{)} \PYG{p}{\PYGZob{}}\PYG{c+c1}{//两条内公切线}
        \PYG{k+kt}{double} \PYG{n}{ang} \PYG{o}{=} \PYG{n}{acos}\PYG{p}{((}\PYG{n}{A}\PYG{p}{.}\PYG{n}{r} \PYG{o}{+} \PYG{n}{B}\PYG{p}{.}\PYG{n}{r}\PYG{p}{)} \PYG{o}{/} \PYG{n}{sqrt}\PYG{p}{(}\PYG{n}{d2} \PYG{o}{*} \PYG{l+m+mf}{1.0}\PYG{p}{));}
        \PYG{n}{a}\PYG{p}{[}\PYG{n}{cnt}\PYG{p}{]} \PYG{o}{=} \PYG{n}{A}\PYG{p}{.}\PYG{n}{point}\PYG{p}{(}\PYG{n}{base} \PYG{o}{+} \PYG{n}{ang}\PYG{p}{);} \PYG{n}{b}\PYG{p}{[}\PYG{n}{cnt}\PYG{p}{]} \PYG{o}{=} \PYG{n}{B}\PYG{p}{.}\PYG{n}{point}\PYG{p}{(}\PYG{n}{PI} \PYG{o}{+} \PYG{n}{base} \PYG{o}{+} \PYG{n}{ang}\PYG{p}{);} \PYG{n}{cnt}\PYG{o}{++}\PYG{p}{;}
        \PYG{n}{a}\PYG{p}{[}\PYG{n}{cnt}\PYG{p}{]} \PYG{o}{=} \PYG{n}{A}\PYG{p}{.}\PYG{n}{point}\PYG{p}{(}\PYG{n}{base} \PYG{o}{\PYGZhy{}} \PYG{n}{ang}\PYG{p}{);} \PYG{n}{b}\PYG{p}{[}\PYG{n}{cnt}\PYG{p}{]} \PYG{o}{=} \PYG{n}{B}\PYG{p}{.}\PYG{n}{point}\PYG{p}{(}\PYG{n}{PI} \PYG{o}{+} \PYG{n}{base} \PYG{o}{\PYGZhy{}} \PYG{n}{ang}\PYG{p}{);} \PYG{n}{cnt}\PYG{o}{++}\PYG{p}{;}
    \PYG{p}{\PYGZcb{}}
    \PYG{k}{return} \PYG{n}{cnt}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{c+c1}{// 过点p到圆C的切点}
\PYG{k+kt}{int} \PYG{n+nf}{getTangentPoints}\PYG{p}{(}\PYG{n}{Point} \PYG{n}{p}\PYG{p}{,} \PYG{n}{Circle} \PYG{n}{C}\PYG{p}{,} \PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{Point}\PYG{o}{\PYGZgt{}\PYGZam{}} \PYG{n}{v}\PYG{p}{)\PYGZob{}}
    \PYG{n}{Vector} \PYG{n}{u} \PYG{o}{=} \PYG{n}{C}\PYG{p}{.}\PYG{n}{c} \PYG{o}{\PYGZhy{}} \PYG{n}{p}\PYG{p}{;}
    \PYG{k+kt}{double} \PYG{n}{dist} \PYG{o}{=} \PYG{n}{Length}\PYG{p}{(}\PYG{n}{u}\PYG{p}{);}
    \PYG{k}{if}\PYG{p}{(}\PYG{n}{dist} \PYG{o}{\PYGZlt{}} \PYG{n}{C}\PYG{p}{.}\PYG{n}{r}\PYG{p}{)} \PYG{k}{return} \PYG{l+m+mi}{0}\PYG{p}{;}
    \PYG{k}{else} \PYG{k}{if}\PYG{p}{(}\PYG{n}{dcmp}\PYG{p}{(}\PYG{n}{dist} \PYG{o}{\PYGZhy{}} \PYG{n}{C}\PYG{p}{.}\PYG{n}{r}\PYG{p}{)} \PYG{o}{==} \PYG{l+m+mi}{0}\PYG{p}{)\PYGZob{}}\PYG{c+c1}{// p在圆上，只有一条切线}
        \PYG{n}{v}\PYG{p}{.}\PYG{n}{push\PYGZus{}back}\PYG{p}{(}\PYG{n}{p}\PYG{p}{);}
        \PYG{k}{return} \PYG{l+m+mi}{1}\PYG{p}{;}
    \PYG{p}{\PYGZcb{}}\PYG{k}{else}\PYG{p}{\PYGZob{}}
        \PYG{k+kt}{double} \PYG{n}{ang} \PYG{o}{=} \PYG{n}{asin}\PYG{p}{(}\PYG{n}{C}\PYG{p}{.}\PYG{n}{r} \PYG{o}{/} \PYG{n}{dist}\PYG{p}{);}
        \PYG{k+kt}{double} \PYG{n}{d} \PYG{o}{=} \PYG{n}{sqrt}\PYG{p}{(}\PYG{n}{dist} \PYG{o}{*} \PYG{n}{dist} \PYG{o}{\PYGZhy{}} \PYG{n}{C}\PYG{p}{.}\PYG{n}{r} \PYG{o}{*} \PYG{n}{C}\PYG{p}{.}\PYG{n}{r}\PYG{p}{);}
        \PYG{n}{v}\PYG{p}{.}\PYG{n}{push\PYGZus{}back}\PYG{p}{(}\PYG{n}{p} \PYG{o}{+} \PYG{n}{Unit}\PYG{p}{(}\PYG{n}{Rotate}\PYG{p}{(}\PYG{n}{u}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{n}{ang}\PYG{p}{))} \PYG{o}{*} \PYG{n}{d}\PYG{p}{);}
        \PYG{n}{v}\PYG{p}{.}\PYG{n}{push\PYGZus{}back}\PYG{p}{(}\PYG{n}{p} \PYG{o}{+} \PYG{n}{Unit}\PYG{p}{(}\PYG{n}{Rotate}\PYG{p}{(}\PYG{n}{u}\PYG{p}{,} \PYG{o}{+}\PYG{n}{ang}\PYG{p}{))} \PYG{o}{*} \PYG{n}{d}\PYG{p}{);}
        \PYG{k}{return} \PYG{l+m+mi}{2}\PYG{p}{;}
    \PYG{p}{\PYGZcb{}}
\PYG{p}{\PYGZcb{}}
\PYG{c+c1}{//圆A与圆B的切点}
\PYG{k+kt}{void} \PYG{n+nf}{getTangentPoints}\PYG{p}{(}\PYG{n}{Circle} \PYG{n}{A}\PYG{p}{,} \PYG{n}{Circle} \PYG{n}{B}\PYG{p}{,} \PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{Point}\PYG{o}{\PYGZgt{}\PYGZam{}} \PYG{n}{a}\PYG{p}{)\PYGZob{}}
    \PYG{k}{if} \PYG{p}{(}\PYG{n}{A}\PYG{p}{.}\PYG{n}{r} \PYG{o}{\PYGZlt{}} \PYG{n}{B}\PYG{p}{.}\PYG{n}{r}\PYG{p}{)} \PYG{n}{swap}\PYG{p}{(}\PYG{n}{A}\PYG{p}{,} \PYG{n}{B}\PYG{p}{);}
    \PYG{k+kt}{int} \PYG{n}{d2} \PYG{o}{=} \PYG{n}{sqrt}\PYG{p}{(}\PYG{n}{A}\PYG{p}{.}\PYG{n}{c}\PYG{p}{.}\PYG{n}{x} \PYG{o}{\PYGZhy{}} \PYG{n}{B}\PYG{p}{.}\PYG{n}{c}\PYG{p}{.}\PYG{n}{x}\PYG{p}{)} \PYG{o}{+} \PYG{n}{sqrt}\PYG{p}{(}\PYG{n}{A}\PYG{p}{.}\PYG{n}{c}\PYG{p}{.}\PYG{n}{y} \PYG{o}{\PYGZhy{}} \PYG{n}{B}\PYG{p}{.}\PYG{n}{c}\PYG{p}{.}\PYG{n}{y}\PYG{p}{);}
    \PYG{k+kt}{int} \PYG{n}{rdiff} \PYG{o}{=} \PYG{n}{A}\PYG{p}{.}\PYG{n}{r} \PYG{o}{\PYGZhy{}} \PYG{n}{B}\PYG{p}{.}\PYG{n}{r}\PYG{p}{,} \PYG{n}{rsum} \PYG{o}{=} \PYG{n}{A}\PYG{p}{.}\PYG{n}{r} \PYG{o}{+} \PYG{n}{B}\PYG{p}{.}\PYG{n}{r}\PYG{p}{;}
    \PYG{k}{if} \PYG{p}{(}\PYG{n}{d2} \PYG{o}{\PYGZlt{}} \PYG{n}{rdiff} \PYG{o}{*} \PYG{n}{rdiff}\PYG{p}{)} \PYG{k}{return}\PYG{p}{;}   \PYG{c+c1}{//内含}
    \PYG{k+kt}{double} \PYG{n}{base} \PYG{o}{=} \PYG{n}{atan2}\PYG{p}{(}\PYG{n}{B}\PYG{p}{.}\PYG{n}{c}\PYG{p}{.}\PYG{n}{y} \PYG{o}{\PYGZhy{}} \PYG{n}{A}\PYG{p}{.}\PYG{n}{c}\PYG{p}{.}\PYG{n}{y}\PYG{p}{,} \PYG{n}{B}\PYG{p}{.}\PYG{n}{c}\PYG{p}{.}\PYG{n}{x} \PYG{o}{\PYGZhy{}} \PYG{n}{A}\PYG{p}{.}\PYG{n}{c}\PYG{p}{.}\PYG{n}{x}\PYG{p}{);}
    \PYG{k}{if} \PYG{p}{(}\PYG{n}{d2} \PYG{o}{==} \PYG{l+m+mi}{0} \PYG{o}{\PYGZam{}\PYGZam{}} \PYG{n}{A}\PYG{p}{.}\PYG{n}{r} \PYG{o}{==} \PYG{n}{B}\PYG{p}{.}\PYG{n}{r}\PYG{p}{)} \PYG{k}{return}\PYG{p}{;}    \PYG{c+c1}{//无线多条切线}
    \PYG{k}{if} \PYG{p}{(}\PYG{n}{d2} \PYG{o}{==} \PYG{n}{rdiff} \PYG{o}{*} \PYG{n}{rdiff}\PYG{p}{)} \PYG{p}{\PYGZob{}}\PYG{c+c1}{//内切, 1条切线}
        \PYG{n}{a}\PYG{p}{.}\PYG{n}{push\PYGZus{}back}\PYG{p}{(}\PYG{n}{A}\PYG{p}{.}\PYG{n}{point}\PYG{p}{(}\PYG{n}{base}\PYG{p}{));}
        \PYG{n}{a}\PYG{p}{.}\PYG{n}{push\PYGZus{}back}\PYG{p}{(}\PYG{n}{B}\PYG{p}{.}\PYG{n}{point}\PYG{p}{(}\PYG{n}{base}\PYG{p}{));}
        \PYG{k}{return}\PYG{p}{;}
    \PYG{p}{\PYGZcb{}}
    \PYG{c+c1}{//有外公切线}
    \PYG{k+kt}{double} \PYG{n}{ang} \PYG{o}{=} \PYG{n}{acos}\PYG{p}{((}\PYG{n}{A}\PYG{p}{.}\PYG{n}{r} \PYG{o}{\PYGZhy{}} \PYG{n}{B}\PYG{p}{.}\PYG{n}{r}\PYG{p}{)} \PYG{o}{/} \PYG{n}{sqrt}\PYG{p}{(}\PYG{n}{d2} \PYG{o}{*} \PYG{l+m+mf}{1.0}\PYG{p}{));}
    \PYG{n}{a}\PYG{p}{.}\PYG{n}{push\PYGZus{}back}\PYG{p}{(}\PYG{n}{A}\PYG{p}{.}\PYG{n}{point}\PYG{p}{(}\PYG{n}{base} \PYG{o}{+} \PYG{n}{ang}\PYG{p}{));} \PYG{n}{a}\PYG{p}{.}\PYG{n}{push\PYGZus{}back}\PYG{p}{(}\PYG{n}{B}\PYG{p}{.}\PYG{n}{point}\PYG{p}{(}\PYG{n}{base} \PYG{o}{+} \PYG{n}{ang}\PYG{p}{));}
    \PYG{n}{a}\PYG{p}{.}\PYG{n}{push\PYGZus{}back}\PYG{p}{(}\PYG{n}{A}\PYG{p}{.}\PYG{n}{point}\PYG{p}{(}\PYG{n}{base} \PYG{o}{\PYGZhy{}} \PYG{n}{ang}\PYG{p}{));} \PYG{n}{a}\PYG{p}{.}\PYG{n}{push\PYGZus{}back}\PYG{p}{(}\PYG{n}{B}\PYG{p}{.}\PYG{n}{point}\PYG{p}{(}\PYG{n}{base} \PYG{o}{\PYGZhy{}} \PYG{n}{ang}\PYG{p}{));}
    \PYG{k}{if} \PYG{p}{(}\PYG{n}{d2} \PYG{o}{==} \PYG{n}{rsum} \PYG{o}{*} \PYG{n}{rsum}\PYG{p}{)} \PYG{p}{\PYGZob{}}\PYG{c+c1}{//一条内公切线}
        \PYG{n}{a}\PYG{p}{.}\PYG{n}{push\PYGZus{}back}\PYG{p}{(}\PYG{n}{A}\PYG{p}{.}\PYG{n}{point}\PYG{p}{(}\PYG{n}{base}\PYG{p}{));}
        \PYG{n}{a}\PYG{p}{.}\PYG{n}{push\PYGZus{}back}\PYG{p}{(}\PYG{n}{B}\PYG{p}{.}\PYG{n}{point}\PYG{p}{(}\PYG{n}{PI} \PYG{o}{+} \PYG{n}{base}\PYG{p}{));}
    \PYG{p}{\PYGZcb{}}\PYG{k}{else} \PYG{k}{if} \PYG{p}{(}\PYG{n}{d2} \PYG{o}{\PYGZgt{}} \PYG{n}{rsum} \PYG{o}{*} \PYG{n}{rsum}\PYG{p}{)} \PYG{p}{\PYGZob{}} \PYG{c+c1}{//两条内公切线}
        \PYG{k+kt}{double} \PYG{n}{ang} \PYG{o}{=} \PYG{n}{acos}\PYG{p}{((}\PYG{n}{A}\PYG{p}{.}\PYG{n}{r} \PYG{o}{+} \PYG{n}{B}\PYG{p}{.}\PYG{n}{r}\PYG{p}{)} \PYG{o}{/} \PYG{n}{sqrt}\PYG{p}{(}\PYG{n}{d2} \PYG{o}{*} \PYG{l+m+mf}{1.0}\PYG{p}{));}
        \PYG{n}{a}\PYG{p}{.}\PYG{n}{push\PYGZus{}back}\PYG{p}{(}\PYG{n}{A}\PYG{p}{.}\PYG{n}{point}\PYG{p}{(}\PYG{n}{base} \PYG{o}{+} \PYG{n}{ang}\PYG{p}{));}
        \PYG{n}{a}\PYG{p}{.}\PYG{n}{push\PYGZus{}back}\PYG{p}{(}\PYG{n}{B}\PYG{p}{.}\PYG{n}{point}\PYG{p}{(}\PYG{n}{PI} \PYG{o}{+} \PYG{n}{base} \PYG{o}{+} \PYG{n}{ang}\PYG{p}{));}
        \PYG{n}{a}\PYG{p}{.}\PYG{n}{push\PYGZus{}back}\PYG{p}{(}\PYG{n}{A}\PYG{p}{.}\PYG{n}{point}\PYG{p}{(}\PYG{n}{base} \PYG{o}{\PYGZhy{}} \PYG{n}{ang}\PYG{p}{));}
        \PYG{n}{a}\PYG{p}{.}\PYG{n}{push\PYGZus{}back}\PYG{p}{(}\PYG{n}{B}\PYG{p}{.}\PYG{n}{point}\PYG{p}{(}\PYG{n}{PI} \PYG{o}{+} \PYG{n}{base} \PYG{o}{\PYGZhy{}} \PYG{n}{ang}\PYG{p}{));}
    \PYG{p}{\PYGZcb{}}
\PYG{p}{\PYGZcb{}}
\PYG{c+c1}{//三角形外接圆}
\PYG{n}{Circle} \PYG{n+nf}{CircumscribedCircle}\PYG{p}{(}\PYG{n}{Point} \PYG{n}{p1}\PYG{p}{,} \PYG{n}{Point} \PYG{n}{p2}\PYG{p}{,} \PYG{n}{Point} \PYG{n}{p3}\PYG{p}{)\PYGZob{}}
    \PYG{k+kt}{double} \PYG{n}{Bx} \PYG{o}{=} \PYG{n}{p2}\PYG{p}{.}\PYG{n}{x}\PYG{o}{\PYGZhy{}}\PYG{n}{p1}\PYG{p}{.}\PYG{n}{x}\PYG{p}{,} \PYG{n}{By} \PYG{o}{=} \PYG{n}{p2}\PYG{p}{.}\PYG{n}{y}\PYG{o}{\PYGZhy{}}\PYG{n}{p1}\PYG{p}{.}\PYG{n}{y}\PYG{p}{;}
    \PYG{k+kt}{double} \PYG{n}{Cx} \PYG{o}{=} \PYG{n}{p3}\PYG{p}{.}\PYG{n}{x}\PYG{o}{\PYGZhy{}}\PYG{n}{p1}\PYG{p}{.}\PYG{n}{x}\PYG{p}{,} \PYG{n}{Cy} \PYG{o}{=} \PYG{n}{p3}\PYG{p}{.}\PYG{n}{y}\PYG{o}{\PYGZhy{}}\PYG{n}{p1}\PYG{p}{.}\PYG{n}{y}\PYG{p}{;}
    \PYG{k+kt}{double} \PYG{n}{D} \PYG{o}{=} \PYG{l+m+mi}{2}\PYG{o}{*}\PYG{p}{(}\PYG{n}{Bx}\PYG{o}{*}\PYG{n}{Cy}\PYG{o}{\PYGZhy{}}\PYG{n}{By}\PYG{o}{*}\PYG{n}{Cx}\PYG{p}{);}
    \PYG{k+kt}{double} \PYG{n}{cx} \PYG{o}{=} \PYG{p}{(}\PYG{n}{Cy}\PYG{o}{*}\PYG{p}{(}\PYG{n}{Bx}\PYG{o}{*}\PYG{n}{Bx}\PYG{o}{+}\PYG{n}{By}\PYG{o}{*}\PYG{n}{By}\PYG{p}{)} \PYG{o}{\PYGZhy{}} \PYG{n}{By}\PYG{o}{*}\PYG{p}{(}\PYG{n}{Cx}\PYG{o}{*}\PYG{n}{Cx}\PYG{o}{+}\PYG{n}{Cy}\PYG{o}{*}\PYG{n}{Cy}\PYG{p}{))}\PYG{o}{/}\PYG{n}{D} \PYG{o}{+} \PYG{n}{p1}\PYG{p}{.}\PYG{n}{x}\PYG{p}{;}
    \PYG{k+kt}{double} \PYG{n}{cy} \PYG{o}{=} \PYG{p}{(}\PYG{n}{Bx}\PYG{o}{*}\PYG{p}{(}\PYG{n}{Cx}\PYG{o}{*}\PYG{n}{Cx}\PYG{o}{+}\PYG{n}{Cy}\PYG{o}{*}\PYG{n}{Cy}\PYG{p}{)} \PYG{o}{\PYGZhy{}} \PYG{n}{Cx}\PYG{o}{*}\PYG{p}{(}\PYG{n}{Bx}\PYG{o}{*}\PYG{n}{Bx}\PYG{o}{+}\PYG{n}{By}\PYG{o}{*}\PYG{n}{By}\PYG{p}{))}\PYG{o}{/}\PYG{n}{D} \PYG{o}{+} \PYG{n}{p1}\PYG{p}{.}\PYG{n}{y}\PYG{p}{;}
    \PYG{n}{Point} \PYG{n}{p} \PYG{o}{=} \PYG{n}{Point}\PYG{p}{(}\PYG{n}{cx}\PYG{p}{,} \PYG{n}{cy}\PYG{p}{);}
    \PYG{k}{return} \PYG{n}{Circle}\PYG{p}{(}\PYG{n}{p}\PYG{p}{,} \PYG{n}{Length}\PYG{p}{(}\PYG{n}{p1}\PYG{o}{\PYGZhy{}}\PYG{n}{p}\PYG{p}{));}
\PYG{p}{\PYGZcb{}}
\PYG{c+c1}{//三角形内切圆}
\PYG{n}{Circle} \PYG{n+nf}{InscribedCircle}\PYG{p}{(}\PYG{n}{Point} \PYG{n}{p1}\PYG{p}{,} \PYG{n}{Point} \PYG{n}{p2}\PYG{p}{,} \PYG{n}{Point} \PYG{n}{p3}\PYG{p}{)\PYGZob{}}
    \PYG{k+kt}{double} \PYG{n}{a} \PYG{o}{=} \PYG{n}{Length}\PYG{p}{(}\PYG{n}{p2}\PYG{o}{\PYGZhy{}}\PYG{n}{p3}\PYG{p}{);}
    \PYG{k+kt}{double} \PYG{n}{b} \PYG{o}{=} \PYG{n}{Length}\PYG{p}{(}\PYG{n}{p3}\PYG{o}{\PYGZhy{}}\PYG{n}{p1}\PYG{p}{);}
    \PYG{k+kt}{double} \PYG{n}{c} \PYG{o}{=} \PYG{n}{Length}\PYG{p}{(}\PYG{n}{p1}\PYG{o}{\PYGZhy{}}\PYG{n}{p2}\PYG{p}{);}
    \PYG{n}{Point} \PYG{n}{p} \PYG{o}{=} \PYG{p}{(}\PYG{n}{p1}\PYG{o}{*}\PYG{n}{a}\PYG{o}{+}\PYG{n}{p2}\PYG{o}{*}\PYG{n}{b}\PYG{o}{+}\PYG{n}{p3}\PYG{o}{*}\PYG{n}{c}\PYG{p}{)}\PYG{o}{/}\PYG{p}{(}\PYG{n}{a}\PYG{o}{+}\PYG{n}{b}\PYG{o}{+}\PYG{n}{c}\PYG{p}{);}
    \PYG{k}{return} \PYG{n}{Circle}\PYG{p}{(}\PYG{n}{p}\PYG{p}{,} \PYG{n}{DistanceToLine}\PYG{p}{(}\PYG{n}{p}\PYG{p}{,} \PYG{n}{p1}\PYG{p}{,} \PYG{n}{p2}\PYG{p}{));}
\PYG{p}{\PYGZcb{}}
\PYG{c+c1}{//所有经过点p 半径为r 且与直线L相切的圆心}
\PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{Point}\PYG{o}{\PYGZgt{}} \PYG{n}{CircleThroughPointTangentToLineGivenRadius}\PYG{p}{(}\PYG{n}{Point} \PYG{n}{p}\PYG{p}{,} \PYG{n}{Line} \PYG{n}{L}\PYG{p}{,} \PYG{k+kt}{double} \PYG{n}{r}\PYG{p}{)\PYGZob{}}
    \PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{Point}\PYG{o}{\PYGZgt{}} \PYG{n}{ans}\PYG{p}{;}
    \PYG{k+kt}{double} \PYG{n}{t1}\PYG{p}{,} \PYG{n}{t2}\PYG{p}{;}
    \PYG{n}{getLineCircleIntersection}\PYG{p}{(}\PYG{n}{L}\PYG{p}{.}\PYG{n}{move}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n}{r}\PYG{p}{),} \PYG{n}{Circle}\PYG{p}{(}\PYG{n}{p}\PYG{p}{,} \PYG{n}{r}\PYG{p}{),} \PYG{n}{t1}\PYG{p}{,} \PYG{n}{t2}\PYG{p}{,} \PYG{n}{ans}\PYG{p}{);}
    \PYG{n}{getLineCircleIntersection}\PYG{p}{(}\PYG{n}{L}\PYG{p}{.}\PYG{n}{move}\PYG{p}{(}\PYG{n}{r}\PYG{p}{),} \PYG{n}{Circle}\PYG{p}{(}\PYG{n}{p}\PYG{p}{,} \PYG{n}{r}\PYG{p}{),} \PYG{n}{t1}\PYG{p}{,} \PYG{n}{t2}\PYG{p}{,} \PYG{n}{ans}\PYG{p}{);}
    \PYG{k}{return} \PYG{n}{ans}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{c+c1}{//半径为r 与a b两直线相切的圆心}
\PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{Point}\PYG{o}{\PYGZgt{}} \PYG{n}{CircleTangentToLinesGivenRadius}\PYG{p}{(}\PYG{n}{Line} \PYG{n}{a}\PYG{p}{,} \PYG{n}{Line} \PYG{n}{b}\PYG{p}{,} \PYG{k+kt}{double} \PYG{n}{r}\PYG{p}{)\PYGZob{}}
    \PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{Point}\PYG{o}{\PYGZgt{}} \PYG{n}{ans}\PYG{p}{;}
    \PYG{n}{Line} \PYG{n}{L1} \PYG{o}{=} \PYG{n}{a}\PYG{p}{.}\PYG{n}{move}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n}{r}\PYG{p}{),} \PYG{n}{L2} \PYG{o}{=} \PYG{n}{a}\PYG{p}{.}\PYG{n}{move}\PYG{p}{(}\PYG{n}{r}\PYG{p}{);}
    \PYG{n}{Line} \PYG{n}{L3} \PYG{o}{=} \PYG{n}{b}\PYG{p}{.}\PYG{n}{move}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n}{r}\PYG{p}{),} \PYG{n}{L4} \PYG{o}{=} \PYG{n}{b}\PYG{p}{.}\PYG{n}{move}\PYG{p}{(}\PYG{n}{r}\PYG{p}{);}
    \PYG{n}{ans}\PYG{p}{.}\PYG{n}{push\PYGZus{}back}\PYG{p}{(}\PYG{n}{GetLineIntersection}\PYG{p}{(}\PYG{n}{L1}\PYG{p}{,} \PYG{n}{L3}\PYG{p}{));}
    \PYG{n}{ans}\PYG{p}{.}\PYG{n}{push\PYGZus{}back}\PYG{p}{(}\PYG{n}{GetLineIntersection}\PYG{p}{(}\PYG{n}{L1}\PYG{p}{,} \PYG{n}{L4}\PYG{p}{));}
    \PYG{n}{ans}\PYG{p}{.}\PYG{n}{push\PYGZus{}back}\PYG{p}{(}\PYG{n}{GetLineIntersection}\PYG{p}{(}\PYG{n}{L2}\PYG{p}{,} \PYG{n}{L3}\PYG{p}{));}
    \PYG{n}{ans}\PYG{p}{.}\PYG{n}{push\PYGZus{}back}\PYG{p}{(}\PYG{n}{GetLineIntersection}\PYG{p}{(}\PYG{n}{L2}\PYG{p}{,} \PYG{n}{L4}\PYG{p}{));}
    \PYG{k}{return} \PYG{n}{ans}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{c+c1}{//与两圆相切 半径为r的所有圆心}
\PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{Point}\PYG{o}{\PYGZgt{}} \PYG{n}{CircleTangentToTwoDisjointCirclesWithRadius}\PYG{p}{(}\PYG{n}{Circle} \PYG{n}{c1}\PYG{p}{,} \PYG{n}{Circle} \PYG{n}{c2}\PYG{p}{,} \PYG{k+kt}{double} \PYG{n}{r}\PYG{p}{)\PYGZob{}}
    \PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{Point}\PYG{o}{\PYGZgt{}} \PYG{n}{ans}\PYG{p}{;}
    \PYG{n}{Vector} \PYG{n}{v} \PYG{o}{=} \PYG{n}{c2}\PYG{p}{.}\PYG{n}{c} \PYG{o}{\PYGZhy{}} \PYG{n}{c1}\PYG{p}{.}\PYG{n}{c}\PYG{p}{;}
    \PYG{k+kt}{double} \PYG{n}{dist} \PYG{o}{=} \PYG{n}{Length}\PYG{p}{(}\PYG{n}{v}\PYG{p}{);}
    \PYG{k+kt}{int} \PYG{n}{d} \PYG{o}{=} \PYG{n}{dcmp}\PYG{p}{(}\PYG{n}{dist} \PYG{o}{\PYGZhy{}} \PYG{n}{c1}\PYG{p}{.}\PYG{n}{r} \PYG{o}{\PYGZhy{}}\PYG{n}{c2}\PYG{p}{.}\PYG{n}{r} \PYG{o}{\PYGZhy{}} \PYG{n}{r}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{);}
    \PYG{k}{if}\PYG{p}{(}\PYG{n}{d} \PYG{o}{\PYGZgt{}} \PYG{l+m+mi}{0}\PYG{p}{)} \PYG{k}{return} \PYG{n}{ans}\PYG{p}{;}
    \PYG{n}{getCircleCircleIntersection}\PYG{p}{(}\PYG{n}{Circle}\PYG{p}{(}\PYG{n}{c1}\PYG{p}{.}\PYG{n}{c}\PYG{p}{,} \PYG{n}{c1}\PYG{p}{.}\PYG{n}{r}\PYG{o}{+}\PYG{n}{r}\PYG{p}{),} \PYG{n}{Circle}\PYG{p}{(}\PYG{n}{c2}\PYG{p}{.}\PYG{n}{c}\PYG{p}{,} \PYG{n}{c2}\PYG{p}{.}\PYG{n}{r}\PYG{o}{+}\PYG{n}{r}\PYG{p}{),} \PYG{n}{ans}\PYG{p}{);}
    \PYG{k}{return} \PYG{n}{ans}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{c+c1}{//多边形与圆相交面积}
\PYG{n}{Point} \PYG{n}{GetIntersection}\PYG{p}{(}\PYG{n}{Line} \PYG{n}{a}\PYG{p}{,} \PYG{n}{Line} \PYG{n}{b}\PYG{p}{)} \PYG{p}{\PYGZob{}}\PYG{c+c1}{//线段交点}
    \PYG{n}{Vector} \PYG{n}{u} \PYG{o}{=} \PYG{n}{a}\PYG{p}{.}\PYG{n}{p}\PYG{o}{\PYGZhy{}}\PYG{n}{b}\PYG{p}{.}\PYG{n}{p}\PYG{p}{;}
    \PYG{k+kt}{double} \PYG{n}{t} \PYG{o}{=} \PYG{n}{Cross}\PYG{p}{(}\PYG{n}{b}\PYG{p}{.}\PYG{n}{v}\PYG{p}{,} \PYG{n}{u}\PYG{p}{)} \PYG{o}{/} \PYG{n}{Cross}\PYG{p}{(}\PYG{n}{a}\PYG{p}{.}\PYG{n}{v}\PYG{p}{,} \PYG{n}{b}\PYG{p}{.}\PYG{n}{v}\PYG{p}{);}
    \PYG{k}{return} \PYG{n}{a}\PYG{p}{.}\PYG{n}{p} \PYG{o}{+} \PYG{n}{a}\PYG{p}{.}\PYG{n}{v}\PYG{o}{*}\PYG{n}{t}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{k+kr}{inline} \PYG{k+kt}{bool} \PYG{n}{InCircle}\PYG{p}{(}\PYG{n}{Point} \PYG{n}{x}\PYG{p}{,} \PYG{n}{Circle} \PYG{n}{c}\PYG{p}{)\PYGZob{}}
    \PYG{k}{return} \PYG{n}{dcmp}\PYG{p}{(}\PYG{n}{c}\PYG{p}{.}\PYG{n}{r} \PYG{o}{\PYGZhy{}} \PYG{n}{Length}\PYG{p}{(}\PYG{n}{c}\PYG{p}{.}\PYG{n}{c} \PYG{o}{\PYGZhy{}} \PYG{n}{x}\PYG{p}{))} \PYG{o}{\PYGZgt{}=} \PYG{l+m+mi}{0}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{k+kr}{inline} \PYG{k+kt}{bool} \PYG{n}{OnCircle}\PYG{p}{(}\PYG{n}{Point} \PYG{n}{x}\PYG{p}{,} \PYG{n}{Circle} \PYG{n}{c}\PYG{p}{)\PYGZob{}}
    \PYG{k}{return} \PYG{n}{dcmp}\PYG{p}{(}\PYG{n}{c}\PYG{p}{.}\PYG{n}{r} \PYG{o}{\PYGZhy{}} \PYG{n}{Length}\PYG{p}{(}\PYG{n}{c}\PYG{p}{.}\PYG{n}{c} \PYG{o}{\PYGZhy{}} \PYG{n}{x}\PYG{p}{))} \PYG{o}{==} \PYG{l+m+mi}{0}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{c+c1}{//线段与圆的交点}
\PYG{k+kt}{int} \PYG{n}{getSegCircleIntersection}\PYG{p}{(}\PYG{n}{Line} \PYG{n}{L}\PYG{p}{,} \PYG{n}{Circle} \PYG{n}{C}\PYG{p}{,} \PYG{n}{Point}\PYG{o}{*} \PYG{n}{sol}\PYG{p}{)\PYGZob{}}
    \PYG{n}{Vector} \PYG{n}{nor} \PYG{o}{=} \PYG{n}{Normal}\PYG{p}{(}\PYG{n}{L}\PYG{p}{.}\PYG{n}{v}\PYG{p}{);}
    \PYG{n}{Line} \PYG{n}{pl} \PYG{o}{=} \PYG{n}{Line}\PYG{p}{(}\PYG{n}{C}\PYG{p}{.}\PYG{n}{c}\PYG{p}{,} \PYG{n}{nor}\PYG{p}{);}
    \PYG{n}{Point} \PYG{n}{ip} \PYG{o}{=} \PYG{n}{GetIntersection}\PYG{p}{(}\PYG{n}{pl}\PYG{p}{,} \PYG{n}{L}\PYG{p}{);}
    \PYG{k+kt}{double} \PYG{n}{dis} \PYG{o}{=} \PYG{n}{Length}\PYG{p}{(}\PYG{n}{ip} \PYG{o}{\PYGZhy{}} \PYG{n}{C}\PYG{p}{.}\PYG{n}{c}\PYG{p}{);}
    \PYG{k}{if} \PYG{p}{(}\PYG{n}{dcmp}\PYG{p}{(}\PYG{n}{dis} \PYG{o}{\PYGZhy{}} \PYG{n}{C}\PYG{p}{.}\PYG{n}{r}\PYG{p}{)} \PYG{o}{\PYGZgt{}} \PYG{l+m+mi}{0}\PYG{p}{)} \PYG{k}{return} \PYG{l+m+mi}{0}\PYG{p}{;}
    \PYG{n}{Point} \PYG{n}{dxy} \PYG{o}{=} \PYG{n}{Unit}\PYG{p}{(}\PYG{n}{L}\PYG{p}{.}\PYG{n}{v}\PYG{p}{)} \PYG{o}{*} \PYG{n}{sqrt}\PYG{p}{(}\PYG{n}{sqrt}\PYG{p}{(}\PYG{n}{C}\PYG{p}{.}\PYG{n}{r}\PYG{p}{)} \PYG{o}{\PYGZhy{}} \PYG{n}{sqrt}\PYG{p}{(}\PYG{n}{dis}\PYG{p}{));}
    \PYG{k+kt}{int} \PYG{n}{ret} \PYG{o}{=} \PYG{l+m+mi}{0}\PYG{p}{;}
    \PYG{n}{sol}\PYG{p}{[}\PYG{n}{ret}\PYG{p}{]} \PYG{o}{=} \PYG{n}{ip} \PYG{o}{+} \PYG{n}{dxy}\PYG{p}{;}
    \PYG{k}{if} \PYG{p}{(}\PYG{n}{OnSegment}\PYG{p}{(}\PYG{n}{sol}\PYG{p}{[}\PYG{n}{ret}\PYG{p}{],} \PYG{n}{L}\PYG{p}{.}\PYG{n}{p}\PYG{p}{,} \PYG{n}{L}\PYG{p}{.}\PYG{n}{point}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)))} \PYG{n}{ret}\PYG{o}{++}\PYG{p}{;}
    \PYG{n}{sol}\PYG{p}{[}\PYG{n}{ret}\PYG{p}{]} \PYG{o}{=} \PYG{n}{ip} \PYG{o}{\PYGZhy{}} \PYG{n}{dxy}\PYG{p}{;}
    \PYG{k}{if} \PYG{p}{(}\PYG{n}{OnSegment}\PYG{p}{(}\PYG{n}{sol}\PYG{p}{[}\PYG{n}{ret}\PYG{p}{],} \PYG{n}{L}\PYG{p}{.}\PYG{n}{p}\PYG{p}{,} \PYG{n}{L}\PYG{p}{.}\PYG{n}{point}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)))} \PYG{n}{ret}\PYG{o}{++}\PYG{p}{;}
    \PYG{k}{return} \PYG{n}{ret}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{c+c1}{//线段切割圆}
\PYG{k+kt}{double} \PYG{n}{SegCircleArea}\PYG{p}{(}\PYG{n}{Circle} \PYG{n}{C}\PYG{p}{,} \PYG{n}{Point} \PYG{n}{a}\PYG{p}{,} \PYG{n}{Point} \PYG{n}{b}\PYG{p}{)\PYGZob{}}
    \PYG{k+kt}{double} \PYG{n}{a1} \PYG{o}{=} \PYG{n}{angle}\PYG{p}{(}\PYG{n}{a} \PYG{o}{\PYGZhy{}} \PYG{n}{C}\PYG{p}{.}\PYG{n}{c}\PYG{p}{);}
    \PYG{k+kt}{double} \PYG{n}{a2} \PYG{o}{=} \PYG{n}{angle}\PYG{p}{(}\PYG{n}{b} \PYG{o}{\PYGZhy{}} \PYG{n}{C}\PYG{p}{.}\PYG{n}{c}\PYG{p}{);}
    \PYG{k+kt}{double} \PYG{n}{da} \PYG{o}{=} \PYG{n}{fabs}\PYG{p}{(}\PYG{n}{a1} \PYG{o}{\PYGZhy{}} \PYG{n}{a2}\PYG{p}{);}
    \PYG{k}{if} \PYG{p}{(}\PYG{n}{da} \PYG{o}{\PYGZgt{}} \PYG{n}{PI}\PYG{p}{)} \PYG{n}{da} \PYG{o}{=} \PYG{n}{PI} \PYG{o}{*} \PYG{l+m+mf}{2.0} \PYG{o}{\PYGZhy{}} \PYG{n}{da}\PYG{p}{;}
    \PYG{k}{return} \PYG{n+nf}{dcmp}\PYG{p}{(}\PYG{n}{Cross}\PYG{p}{(}\PYG{n}{b} \PYG{o}{\PYGZhy{}} \PYG{n}{C}\PYG{p}{.}\PYG{n}{c}\PYG{p}{,} \PYG{n}{a} \PYG{o}{\PYGZhy{}} \PYG{n}{C}\PYG{p}{.}\PYG{n}{c}\PYG{p}{))} \PYG{o}{*} \PYG{n}{da} \PYG{o}{*} \PYG{n}{sqrt}\PYG{p}{(}\PYG{n}{C}\PYG{p}{.}\PYG{n}{r}\PYG{p}{)} \PYG{o}{/} \PYG{l+m+mf}{2.0}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{c+c1}{//多边形与圆相交面积}
\PYG{k+kt}{double} \PYG{n}{PolyCiclrArea}\PYG{p}{(}\PYG{n}{Circle} \PYG{n}{C}\PYG{p}{,} \PYG{n}{Point} \PYG{o}{*}\PYG{n}{p}\PYG{p}{,} \PYG{k+kt}{int} \PYG{n}{n}\PYG{p}{)\PYGZob{}}
    \PYG{k+kt}{double} \PYG{n}{ret} \PYG{o}{=} \PYG{l+m+mf}{0.0}\PYG{p}{;}
    \PYG{n}{Point} \PYG{n}{sol}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{];}
    \PYG{n}{p}\PYG{p}{[}\PYG{n}{n}\PYG{p}{]} \PYG{o}{=} \PYG{n}{p}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{];}
    \PYG{k}{for}\PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{i}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{;}\PYG{n}{i}\PYG{o}{\PYGZlt{}=}\PYG{n}{n}\PYG{p}{;}\PYG{n}{i}\PYG{o}{++}\PYG{p}{)\PYGZob{}}
        \PYG{k+kt}{int} \PYG{n}{cnt} \PYG{o}{=} \PYG{n}{getSegCircleIntersection}\PYG{p}{(}\PYG{n}{Line}\PYG{p}{(}\PYG{n}{p}\PYG{p}{[}\PYG{n}{i}\PYG{p}{],} \PYG{n}{p}\PYG{p}{[}\PYG{n}{i}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{n}{p}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]),} \PYG{n}{C}\PYG{p}{,} \PYG{n}{sol}\PYG{p}{);}
        \PYG{k}{if} \PYG{p}{(}\PYG{n}{cnt} \PYG{o}{==} \PYG{l+m+mi}{0}\PYG{p}{)\PYGZob{}}
            \PYG{k}{if} \PYG{p}{(}\PYG{o}{!}\PYG{n}{InCircle}\PYG{p}{(}\PYG{n}{p}\PYG{p}{[}\PYG{n}{i}\PYG{p}{],} \PYG{n}{C}\PYG{p}{)} \PYG{o}{||} \PYG{o}{!}\PYG{n}{InCircle}\PYG{p}{(}\PYG{n}{p}\PYG{p}{[}\PYG{n}{i}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{],} \PYG{n}{C}\PYG{p}{))} \PYG{n}{ret} \PYG{o}{+=} \PYG{n}{SegCircleArea}\PYG{p}{(}\PYG{n}{C}\PYG{p}{,} \PYG{n}{p}\PYG{p}{[}\PYG{n}{i}\PYG{p}{],} \PYG{n}{p}\PYG{p}{[}\PYG{n}{i}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{]);}
            \PYG{k}{else} \PYG{n}{ret} \PYG{o}{+=} \PYG{n}{Cross}\PYG{p}{(}\PYG{n}{p}\PYG{p}{[}\PYG{n}{i}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{]} \PYG{o}{\PYGZhy{}} \PYG{n}{C}\PYG{p}{.}\PYG{n}{c}\PYG{p}{,} \PYG{n}{p}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]} \PYG{o}{\PYGZhy{}} \PYG{n}{C}\PYG{p}{.}\PYG{n}{c}\PYG{p}{)} \PYG{o}{/} \PYG{l+m+mf}{2.0}\PYG{p}{;}
        \PYG{p}{\PYGZcb{}}
        \PYG{k}{if} \PYG{p}{(}\PYG{n}{cnt} \PYG{o}{==} \PYG{l+m+mi}{1}\PYG{p}{)\PYGZob{}}
            \PYG{k}{if} \PYG{p}{(}\PYG{n}{InCircle}\PYG{p}{(}\PYG{n}{p}\PYG{p}{[}\PYG{n}{i}\PYG{p}{],} \PYG{n}{C}\PYG{p}{)} \PYG{o}{\PYGZam{}\PYGZam{}} \PYG{o}{!}\PYG{n}{InCircle}\PYG{p}{(}\PYG{n}{p}\PYG{p}{[}\PYG{n}{i}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{],} \PYG{n}{C}\PYG{p}{))\PYGZob{}}
                \PYG{n}{ret}\PYG{o}{+=}\PYG{n}{Cross}\PYG{p}{(}\PYG{n}{sol}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{n}{C}\PYG{p}{.}\PYG{n}{c}\PYG{p}{,}\PYG{n}{p}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{n}{C}\PYG{p}{.}\PYG{n}{c}\PYG{p}{)}\PYG{o}{/}\PYG{l+m+mf}{2.0}\PYG{p}{,} \PYG{n}{ret}\PYG{o}{+=}\PYG{n}{SegCircleArea}\PYG{p}{(}\PYG{n}{C}\PYG{p}{,}\PYG{n}{sol}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{],}\PYG{n}{p}\PYG{p}{[}\PYG{n}{i}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{]);}
            \PYG{p}{\PYGZcb{}}\PYG{k}{else}\PYG{p}{\PYGZob{}}
                \PYG{n}{ret}\PYG{o}{+=}\PYG{n}{SegCircleArea}\PYG{p}{(}\PYG{n}{C}\PYG{p}{,}\PYG{n}{p}\PYG{p}{[}\PYG{n}{i}\PYG{p}{],}\PYG{n}{sol}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]),} \PYG{n}{ret}\PYG{o}{+=}\PYG{n}{Cross}\PYG{p}{(}\PYG{n}{p}\PYG{p}{[}\PYG{n}{i}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{n}{C}\PYG{p}{.}\PYG{n}{c}\PYG{p}{,}\PYG{n}{sol}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{n}{C}\PYG{p}{.}\PYG{n}{c}\PYG{p}{)}\PYG{o}{/}\PYG{l+m+mf}{2.0}\PYG{p}{;}
            \PYG{p}{\PYGZcb{}}
        \PYG{p}{\PYGZcb{}}
        \PYG{k}{if} \PYG{p}{(}\PYG{n}{cnt} \PYG{o}{==} \PYG{l+m+mi}{2}\PYG{p}{)\PYGZob{}}
            \PYG{k}{if} \PYG{p}{((}\PYG{n}{p}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]} \PYG{o}{\PYGZlt{}} \PYG{n}{p}\PYG{p}{[}\PYG{n}{i} \PYG{o}{+} \PYG{l+m+mi}{1}\PYG{p}{])} \PYG{o}{\PYGZca{}} \PYG{p}{(}\PYG{n}{sol}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]} \PYG{o}{\PYGZlt{}} \PYG{n}{sol}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]))} \PYG{n}{swap}\PYG{p}{(}\PYG{n}{sol}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{],} \PYG{n}{sol}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]);}
            \PYG{n}{ret} \PYG{o}{+=} \PYG{n}{SegCircleArea}\PYG{p}{(}\PYG{n}{C}\PYG{p}{,} \PYG{n}{p}\PYG{p}{[}\PYG{n}{i}\PYG{p}{],} \PYG{n}{sol}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]);}
            \PYG{n}{ret} \PYG{o}{+=} \PYG{n}{Cross}\PYG{p}{(}\PYG{n}{sol}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]} \PYG{o}{\PYGZhy{}} \PYG{n}{C}\PYG{p}{.}\PYG{n}{c}\PYG{p}{,} \PYG{n}{sol}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]} \PYG{o}{\PYGZhy{}} \PYG{n}{C}\PYG{p}{.}\PYG{n}{c}\PYG{p}{)} \PYG{o}{/} \PYG{l+m+mf}{2.0}\PYG{p}{;}
            \PYG{n}{ret} \PYG{o}{+=} \PYG{n}{SegCircleArea}\PYG{p}{(}\PYG{n}{C}\PYG{p}{,} \PYG{n}{sol}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{],} \PYG{n}{p}\PYG{p}{[}\PYG{n}{i}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{]);}
        \PYG{p}{\PYGZcb{}}
    \PYG{p}{\PYGZcb{}}
    \PYG{k}{return} \PYG{n}{fabs}\PYG{p}{(}\PYG{n}{ret}\PYG{p}{);}
\PYG{p}{\PYGZcb{}}
\PYG{k+kt}{double} \PYG{n}{area}\PYG{p}{(}\PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{Point}\PYG{o}{\PYGZgt{}}\PYG{n}{p}\PYG{p}{)} \PYG{p}{\PYGZob{}}\PYG{c+c1}{//计算凸包的面积}
    \PYG{k+kt}{double} \PYG{n}{ans} \PYG{o}{=} \PYG{l+m+mi}{0}\PYG{p}{;}
    \PYG{k+kt}{int} \PYG{n}{sz} \PYG{o}{=} \PYG{n}{p}\PYG{p}{.}\PYG{n}{size}\PYG{p}{();}
    \PYG{k}{for} \PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{i} \PYG{o}{=} \PYG{l+m+mi}{1}\PYG{p}{;} \PYG{n}{i} \PYG{o}{\PYGZlt{}} \PYG{n}{sz} \PYG{o}{\PYGZhy{}} \PYG{l+m+mi}{1}\PYG{p}{;} \PYG{n}{i}\PYG{o}{++}\PYG{p}{)}
        \PYG{n}{ans} \PYG{o}{+=} \PYG{n}{Cross}\PYG{p}{(}\PYG{n}{p}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]} \PYG{o}{\PYGZhy{}} \PYG{n}{p}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{],} \PYG{n}{p}\PYG{p}{[}\PYG{n}{i} \PYG{o}{+} \PYG{l+m+mi}{1}\PYG{p}{]} \PYG{o}{\PYGZhy{}} \PYG{n}{p}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]);}
    \PYG{k}{return} \PYG{n}{ans} \PYG{o}{/} \PYG{l+m+mf}{2.0}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}

\PYG{k+kt}{double} \PYG{n}{seg}\PYG{p}{(}\PYG{n}{Point} \PYG{n}{o}\PYG{p}{,} \PYG{n}{Point} \PYG{n}{a}\PYG{p}{,} \PYG{n}{Point} \PYG{n}{b}\PYG{p}{)\PYGZob{}}
    \PYG{k}{if} \PYG{p}{(}\PYG{n}{dcmp}\PYG{p}{(}\PYG{n}{b}\PYG{p}{.}\PYG{n}{x} \PYG{o}{\PYGZhy{}} \PYG{n}{a}\PYG{p}{.}\PYG{n}{x}\PYG{p}{)} \PYG{o}{==} \PYG{l+m+mi}{0}\PYG{p}{)} \PYG{k}{return} \PYG{p}{(}\PYG{n}{o}\PYG{p}{.}\PYG{n}{y} \PYG{o}{\PYGZhy{}} \PYG{n}{a}\PYG{p}{.}\PYG{n}{y}\PYG{p}{)} \PYG{o}{/} \PYG{p}{(}\PYG{n}{b}\PYG{p}{.}\PYG{n}{y} \PYG{o}{\PYGZhy{}} \PYG{n}{a}\PYG{p}{.}\PYG{n}{y}\PYG{p}{);}
    \PYG{k}{return} \PYG{p}{(}\PYG{n}{o}\PYG{p}{.}\PYG{n}{x} \PYG{o}{\PYGZhy{}} \PYG{n}{a}\PYG{p}{.}\PYG{n}{x}\PYG{p}{)} \PYG{o}{/} \PYG{p}{(}\PYG{n}{b}\PYG{p}{.}\PYG{n}{x} \PYG{o}{\PYGZhy{}} \PYG{n}{a}\PYG{p}{.}\PYG{n}{x}\PYG{p}{);}
\PYG{p}{\PYGZcb{}}
\PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{Point}\PYG{o}{\PYGZgt{}} \PYG{n}{pp}\PYG{p}{[}\PYG{l+m+mi}{110}\PYG{p}{];}
\PYG{n}{pair}\PYG{o}{\PYGZlt{}}\PYG{k+kt}{double}\PYG{p}{,} \PYG{k+kt}{int}\PYG{o}{\PYGZgt{}} \PYG{n}{s}\PYG{p}{[}\PYG{l+m+mi}{2000200}\PYG{p}{];}
\PYG{k+kt}{double} \PYG{n+nf}{polyunion}\PYG{p}{(}\PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{Point}\PYG{o}{\PYGZgt{}*}\PYG{n}{p}\PYG{p}{,} \PYG{k+kt}{int} \PYG{n}{n}\PYG{p}{)\PYGZob{}}\PYG{c+c1}{//求n个多凸包的面积交}
    \PYG{k+kt}{double} \PYG{n}{ret} \PYG{o}{=} \PYG{l+m+mi}{0}\PYG{p}{;}
    \PYG{k}{for} \PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{i} \PYG{o}{=} \PYG{l+m+mi}{0}\PYG{p}{;} \PYG{n}{i} \PYG{o}{\PYGZlt{}} \PYG{n}{n}\PYG{p}{;} \PYG{n}{i}\PYG{o}{++}\PYG{p}{)\PYGZob{}}
        \PYG{k+kt}{int} \PYG{n}{sz} \PYG{o}{=} \PYG{n}{p}\PYG{p}{[}\PYG{n}{i}\PYG{p}{].}\PYG{n}{size}\PYG{p}{();}
        \PYG{k}{for} \PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{j} \PYG{o}{=} \PYG{l+m+mi}{0}\PYG{p}{;} \PYG{n}{j} \PYG{o}{\PYGZlt{}} \PYG{n}{sz}\PYG{p}{;} \PYG{n}{j}\PYG{o}{++}\PYG{p}{)\PYGZob{}}
            \PYG{k+kt}{int} \PYG{n}{m} \PYG{o}{=} \PYG{l+m+mi}{0}\PYG{p}{;}
            \PYG{n}{s}\PYG{p}{[}\PYG{n}{m}\PYG{o}{++}\PYG{p}{]} \PYG{o}{=} \PYG{n}{mp}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{);}
            \PYG{n}{s}\PYG{p}{[}\PYG{n}{m}\PYG{o}{++}\PYG{p}{]} \PYG{o}{=} \PYG{n}{mp}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{);}
            \PYG{n}{Point} \PYG{n}{a} \PYG{o}{=} \PYG{n}{p}\PYG{p}{[}\PYG{n}{i}\PYG{p}{][}\PYG{n}{j}\PYG{p}{],} \PYG{n}{b} \PYG{o}{=} \PYG{n}{p}\PYG{p}{[}\PYG{n}{i}\PYG{p}{][(}\PYG{n}{j} \PYG{o}{+} \PYG{l+m+mi}{1}\PYG{p}{)} \PYG{o}{\PYGZpc{}} \PYG{n}{sz}\PYG{p}{];}
            \PYG{k}{for} \PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{k} \PYG{o}{=} \PYG{l+m+mi}{0}\PYG{p}{;} \PYG{n}{k} \PYG{o}{\PYGZlt{}} \PYG{n}{n}\PYG{p}{;} \PYG{n}{k}\PYG{o}{++}\PYG{p}{)\PYGZob{}}
                \PYG{k}{if} \PYG{p}{(}\PYG{n}{i} \PYG{o}{!=} \PYG{n}{k}\PYG{p}{)\PYGZob{}}
                    \PYG{k+kt}{int} \PYG{n}{siz} \PYG{o}{=} \PYG{n}{p}\PYG{p}{[}\PYG{n}{k}\PYG{p}{].}\PYG{n}{size}\PYG{p}{();}
                    \PYG{k}{for} \PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{ii} \PYG{o}{=} \PYG{l+m+mi}{0}\PYG{p}{;} \PYG{n}{ii} \PYG{o}{\PYGZlt{}} \PYG{n}{siz}\PYG{p}{;} \PYG{n}{ii}\PYG{o}{++}\PYG{p}{)\PYGZob{}}
                        \PYG{n}{Point} \PYG{n}{c} \PYG{o}{=} \PYG{n}{p}\PYG{p}{[}\PYG{n}{k}\PYG{p}{][}\PYG{n}{ii}\PYG{p}{],} \PYG{n}{d} \PYG{o}{=} \PYG{n}{p}\PYG{p}{[}\PYG{n}{k}\PYG{p}{][(}\PYG{n}{ii} \PYG{o}{+} \PYG{l+m+mi}{1}\PYG{p}{)} \PYG{o}{\PYGZpc{}} \PYG{n}{siz}\PYG{p}{];}
                        \PYG{k+kt}{int} \PYG{n}{c1} \PYG{o}{=} \PYG{n}{dcmp}\PYG{p}{(}\PYG{n}{Cross}\PYG{p}{(}\PYG{n}{b} \PYG{o}{\PYGZhy{}} \PYG{n}{a}\PYG{p}{,} \PYG{n}{c} \PYG{o}{\PYGZhy{}} \PYG{n}{a}\PYG{p}{));}
                        \PYG{k+kt}{int} \PYG{n}{c2} \PYG{o}{=} \PYG{n}{dcmp}\PYG{p}{(}\PYG{n}{Cross}\PYG{p}{(}\PYG{n}{b} \PYG{o}{\PYGZhy{}} \PYG{n}{a}\PYG{p}{,} \PYG{n}{d} \PYG{o}{\PYGZhy{}} \PYG{n}{a}\PYG{p}{));}
                        \PYG{k}{if} \PYG{p}{(}\PYG{n}{c1} \PYG{o}{==} \PYG{l+m+mi}{0} \PYG{o}{\PYGZam{}\PYGZam{}} \PYG{n}{c2} \PYG{o}{==} \PYG{l+m+mi}{0}\PYG{p}{)\PYGZob{}}
                            \PYG{k}{if} \PYG{p}{(}\PYG{n}{dcmp}\PYG{p}{(}\PYG{n}{Dot}\PYG{p}{(}\PYG{n}{b} \PYG{o}{\PYGZhy{}} \PYG{n}{a}\PYG{p}{,} \PYG{n}{d} \PYG{o}{\PYGZhy{}} \PYG{n}{c}\PYG{p}{))} \PYG{o}{\PYGZgt{}} \PYG{l+m+mi}{0} \PYG{o}{\PYGZam{}\PYGZam{}} \PYG{n}{i} \PYG{o}{\PYGZgt{}} \PYG{n}{k}\PYG{p}{)\PYGZob{}}
                                \PYG{n}{s}\PYG{p}{[}\PYG{n}{m}\PYG{o}{++}\PYG{p}{]} \PYG{o}{=} \PYG{n}{mp}\PYG{p}{(}\PYG{n}{seg}\PYG{p}{(}\PYG{n}{c}\PYG{p}{,} \PYG{n}{a}\PYG{p}{,} \PYG{n}{b}\PYG{p}{),} \PYG{l+m+mi}{1}\PYG{p}{);}
                                \PYG{n}{s}\PYG{p}{[}\PYG{n}{m}\PYG{o}{++}\PYG{p}{]} \PYG{o}{=} \PYG{n}{mp}\PYG{p}{(}\PYG{n}{seg}\PYG{p}{(}\PYG{n}{d}\PYG{p}{,} \PYG{n}{a}\PYG{p}{,} \PYG{n}{b}\PYG{p}{),} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{);}
                            \PYG{p}{\PYGZcb{}}
                        \PYG{p}{\PYGZcb{}}\PYG{k}{else}\PYG{p}{\PYGZob{}}
                            \PYG{k+kt}{double} \PYG{n}{s1} \PYG{o}{=} \PYG{n}{Cross}\PYG{p}{(}\PYG{n}{d} \PYG{o}{\PYGZhy{}} \PYG{n}{c}\PYG{p}{,} \PYG{n}{a} \PYG{o}{\PYGZhy{}} \PYG{n}{c}\PYG{p}{);}
                            \PYG{k+kt}{double} \PYG{n}{s2} \PYG{o}{=} \PYG{n}{Cross}\PYG{p}{(}\PYG{n}{d} \PYG{o}{\PYGZhy{}} \PYG{n}{c}\PYG{p}{,} \PYG{n}{b} \PYG{o}{\PYGZhy{}} \PYG{n}{c}\PYG{p}{);}
                            \PYG{k}{if} \PYG{p}{(}\PYG{n}{c1} \PYG{o}{\PYGZgt{}=} \PYG{l+m+mi}{0} \PYG{o}{\PYGZam{}\PYGZam{}} \PYG{n}{c2} \PYG{o}{\PYGZlt{}} \PYG{l+m+mi}{0}\PYG{p}{)} \PYG{n}{s}\PYG{p}{[}\PYG{n}{m}\PYG{o}{++}\PYG{p}{]} \PYG{o}{=} \PYG{n}{mp}\PYG{p}{(}\PYG{n}{s1} \PYG{o}{/} \PYG{p}{(}\PYG{n}{s1} \PYG{o}{\PYGZhy{}} \PYG{n}{s2}\PYG{p}{),} \PYG{l+m+mi}{1}\PYG{p}{);}
                            \PYG{k}{else} \PYG{k}{if} \PYG{p}{(}\PYG{n}{c1} \PYG{o}{\PYGZlt{}} \PYG{l+m+mi}{0} \PYG{o}{\PYGZam{}\PYGZam{}} \PYG{n}{c2} \PYG{o}{\PYGZgt{}=} \PYG{l+m+mi}{0}\PYG{p}{)} \PYG{n}{s}\PYG{p}{[}\PYG{n}{m}\PYG{o}{++}\PYG{p}{]} \PYG{o}{=} \PYG{n}{mp}\PYG{p}{(}\PYG{n}{s1} \PYG{o}{/} \PYG{p}{(}\PYG{n}{s1} \PYG{o}{\PYGZhy{}} \PYG{n}{s2}\PYG{p}{),} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{);}
                        \PYG{p}{\PYGZcb{}}
                    \PYG{p}{\PYGZcb{}}
                \PYG{p}{\PYGZcb{}}
            \PYG{p}{\PYGZcb{}}
            \PYG{n}{sort}\PYG{p}{(}\PYG{n}{s}\PYG{p}{,} \PYG{n}{s} \PYG{o}{+} \PYG{n}{m}\PYG{p}{);}
            \PYG{k+kt}{double} \PYG{n}{pre} \PYG{o}{=} \PYG{n}{min}\PYG{p}{(}\PYG{n}{max}\PYG{p}{(}\PYG{n}{s}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{].}\PYG{n}{first}\PYG{p}{,} \PYG{l+m+mf}{0.0}\PYG{p}{),} \PYG{l+m+mf}{1.0}\PYG{p}{),} \PYG{n}{now}\PYG{p}{;}
            \PYG{k+kt}{double} \PYG{n}{sum} \PYG{o}{=} \PYG{l+m+mi}{0}\PYG{p}{;}
            \PYG{k+kt}{int} \PYG{n}{cov} \PYG{o}{=} \PYG{n}{s}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{].}\PYG{n}{second}\PYG{p}{;}
            \PYG{k}{for} \PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{j} \PYG{o}{=} \PYG{l+m+mi}{1}\PYG{p}{;} \PYG{n}{j} \PYG{o}{\PYGZlt{}} \PYG{n}{m}\PYG{p}{;} \PYG{n}{j}\PYG{o}{++}\PYG{p}{)\PYGZob{}}
                \PYG{n}{now} \PYG{o}{=} \PYG{n}{min}\PYG{p}{(}\PYG{n}{max}\PYG{p}{(}\PYG{n}{s}\PYG{p}{[}\PYG{n}{j}\PYG{p}{].}\PYG{n}{first}\PYG{p}{,} \PYG{l+m+mf}{0.0}\PYG{p}{),} \PYG{l+m+mf}{1.0}\PYG{p}{);}
                \PYG{k}{if} \PYG{p}{(}\PYG{o}{!}\PYG{n}{cov}\PYG{p}{)} \PYG{n}{sum} \PYG{o}{+=} \PYG{n}{now} \PYG{o}{\PYGZhy{}} \PYG{n}{pre}\PYG{p}{;}
                \PYG{n}{cov} \PYG{o}{+=} \PYG{n}{s}\PYG{p}{[}\PYG{n}{j}\PYG{p}{].}\PYG{n}{second}\PYG{p}{;}
                \PYG{n}{pre} \PYG{o}{=} \PYG{n}{now}\PYG{p}{;}
            \PYG{p}{\PYGZcb{}}
            \PYG{n}{ret} \PYG{o}{+=} \PYG{n}{Cross}\PYG{p}{(}\PYG{n}{a}\PYG{p}{,} \PYG{n}{b}\PYG{p}{)}\PYG{o}{*}\PYG{n}{sum}\PYG{p}{;}
        \PYG{p}{\PYGZcb{}}
    \PYG{p}{\PYGZcb{}}
    \PYG{k}{return} \PYG{n}{ret} \PYG{o}{/} \PYG{l+m+mi}{2}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\PYG{k+kt}{int} \PYG{n+nf}{Main}\PYG{p}{()\PYGZob{}}
    \PYG{k+kt}{int} \PYG{n}{n}\PYG{p}{,} \PYG{n}{m}\PYG{p}{,} \PYG{n}{kcase} \PYG{o}{=} \PYG{l+m+mi}{1}\PYG{p}{;}
    \PYG{k+kt}{double} \PYG{n}{x1}\PYG{p}{,}\PYG{n}{x2}\PYG{p}{,}\PYG{n}{x3}\PYG{p}{,}\PYG{n}{x4}\PYG{p}{,}\PYG{n}{y1}\PYG{p}{,}\PYG{n}{y2}\PYG{p}{,}\PYG{n}{y3}\PYG{p}{,}\PYG{n}{y4}\PYG{p}{;}
    \PYG{k}{while} \PYG{p}{(}\PYG{o}{\PYGZti{}}\PYG{n}{scanf}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}\PYGZpc{}lf\PYGZpc{}lf\PYGZpc{}lf\PYGZpc{}lf\PYGZdq{}}\PYG{p}{,}\PYG{o}{\PYGZam{}}\PYG{n}{x1}\PYG{p}{,}\PYG{o}{\PYGZam{}}\PYG{n}{y1}\PYG{p}{,}\PYG{o}{\PYGZam{}}\PYG{n}{x2}\PYG{p}{,}\PYG{o}{\PYGZam{}}\PYG{n}{y2}\PYG{p}{))\PYGZob{}}
        \PYG{n}{scanf}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}\PYGZpc{}lf\PYGZpc{}lf\PYGZpc{}lf\PYGZpc{}lf\PYGZdq{}}\PYG{p}{,}\PYG{o}{\PYGZam{}}\PYG{n}{x3}\PYG{p}{,}\PYG{o}{\PYGZam{}}\PYG{n}{y3}\PYG{p}{,}\PYG{o}{\PYGZam{}}\PYG{n}{x4}\PYG{p}{,}\PYG{o}{\PYGZam{}}\PYG{n}{y4}\PYG{p}{);}

        \PYG{n}{pp}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{].}\PYG{n}{clear}\PYG{p}{();}
        \PYG{n}{pp}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{].}\PYG{n}{clear}\PYG{p}{();}

        \PYG{n}{pp}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{].}\PYG{n}{pb}\PYG{p}{(}\PYG{n}{Point}\PYG{p}{(}\PYG{n}{x1}\PYG{p}{,}\PYG{n}{y1}\PYG{p}{));}
        \PYG{n}{pp}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{].}\PYG{n}{pb}\PYG{p}{(}\PYG{n}{Point}\PYG{p}{(}\PYG{n}{x1}\PYG{p}{,}\PYG{n}{y2}\PYG{p}{));}
        \PYG{n}{pp}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{].}\PYG{n}{pb}\PYG{p}{(}\PYG{n}{Point}\PYG{p}{(}\PYG{n}{x2}\PYG{p}{,}\PYG{n}{y1}\PYG{p}{));}
        \PYG{n}{pp}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{=}\PYG{n}{ConvexHull}\PYG{p}{(}\PYG{n}{pp}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]);}
\PYG{c+c1}{//        for(int i=0;i\PYGZlt{}pp[0].size();i++)\PYGZob{}}
\PYG{c+c1}{//            printf(\PYGZdq{}\PYGZpc{}lf  \PYGZpc{}lf\PYGZbs{}n\PYGZdq{},pp[0][i].x,pp[0][i].y);}
\PYG{c+c1}{//        \PYGZcb{}puts(\PYGZdq{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZdq{});}
        \PYG{n}{pp}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{].}\PYG{n}{pb}\PYG{p}{(}\PYG{n}{Point}\PYG{p}{(}\PYG{n}{x3}\PYG{p}{,}\PYG{n}{y3}\PYG{p}{));}
        \PYG{n}{pp}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{].}\PYG{n}{pb}\PYG{p}{(}\PYG{n}{Point}\PYG{p}{(}\PYG{n}{x3}\PYG{p}{,}\PYG{n}{y4}\PYG{p}{));}
        \PYG{n}{pp}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{].}\PYG{n}{pb}\PYG{p}{(}\PYG{n}{Point}\PYG{p}{(}\PYG{n}{x4}\PYG{p}{,}\PYG{n}{y3}\PYG{p}{));}
        \PYG{n}{pp}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{].}\PYG{n}{pb}\PYG{p}{(}\PYG{n}{Point}\PYG{p}{(}\PYG{n}{x4}\PYG{p}{,}\PYG{n}{y4}\PYG{p}{));}
        \PYG{n}{pp}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{=}\PYG{n}{ConvexHull}\PYG{p}{(}\PYG{n}{pp}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]);}
\PYG{c+c1}{//        for(int i=0;i\PYGZlt{}pp[1].size();i++)\PYGZob{}}
\PYG{c+c1}{//            printf(\PYGZdq{}\PYGZpc{}lf  \PYGZpc{}lf\PYGZbs{}n\PYGZdq{},pp[1][i].x,pp[1][i].y);}
\PYG{c+c1}{//        \PYGZcb{}puts(\PYGZdq{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZdq{});}

        \PYG{k+kt}{double} \PYG{n}{t1} \PYG{o}{=} \PYG{n}{area}\PYG{p}{(}\PYG{n}{pp}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{])} \PYG{o}{+} \PYG{n}{area}\PYG{p}{(}\PYG{n}{pp}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]);}
        \PYG{k+kt}{double} \PYG{n}{t2} \PYG{o}{=} \PYG{n}{polyunion}\PYG{p}{(}\PYG{n}{pp}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{);}
        \PYG{n}{printf}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}\PYGZpc{}.10lf}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{n}{t1}\PYG{o}{\PYGZhy{}}\PYG{n}{t2}\PYG{p}{);}
    \PYG{p}{\PYGZcb{}}
    \PYG{k}{return} \PYG{l+m+mi}{0}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}

\PYG{k+kt}{int} \PYG{n+nf}{main}\PYG{p}{()\PYGZob{}}
\PYG{c+cp}{\PYGZsh{}ifndef ONLINE\PYGZus{}JUDGE}
    \PYG{n}{freopen}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}asdf.in\PYGZdq{}} \PYG{p}{,}\PYG{l+s}{\PYGZdq{}r\PYGZdq{}}\PYG{p}{,}\PYG{n}{stdin} \PYG{p}{);}
    \PYG{n}{freopen}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}asdf.out\PYGZdq{}}\PYG{p}{,}\PYG{l+s}{\PYGZdq{}w\PYGZdq{}}\PYG{p}{,}\PYG{n}{stdout}\PYG{p}{);}
    \PYG{k+kt}{double} \PYG{n}{\PYGZus{}time\PYGZus{}tabris}\PYG{o}{=}\PYG{n}{clock}\PYG{p}{();}
\PYG{c+cp}{\PYGZsh{}endif }\PYG{c+c1}{// ONLINE\PYGZus{}JUDGE}
    \PYG{n}{Main}\PYG{p}{();}
\PYG{c+cp}{\PYGZsh{}ifndef ONLINE\PYGZus{}JUDGE}
	\PYG{n}{printf}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}time: \PYGZpc{}lf}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{n}{clock}\PYG{p}{()}\PYG{o}{\PYGZhy{}}\PYG{n}{\PYGZus{}time\PYGZus{}tabris}\PYG{p}{);}
\PYG{c+cp}{\PYGZsh{}endif }\PYG{c+c1}{//ONLINE\PYGZus{}JUDGE}
    \PYG{k}{return} \PYG{l+m+mi}{0}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\end{Verbatim}
